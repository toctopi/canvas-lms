define(["i18n!user_name","jquery","jquery.ajaxJSON","jquery.instructure_forms","jqueryui/dialog","jquery.templateData"],function(a,b){b(document).ready(function(){b("#name_and_email").delegate(".edit_user_link","click",function(a){a.preventDefault(),b("#edit_student_dialog").dialog("close").dialog({autoOpen:!1,width:450}).dialog("open"),b("#edit_student_form :text:visible:first").focus().select()}),b("#edit_student_form").formSubmit({beforeSubmit:function(c){b(this).find("button").attr("disabled",!0).filter(".submit_button").text(a.t("messages.updating_user_details","Updating User Details..."))},success:function(c){b(this).find("button").attr("disabled",!1).filter(".submit_button").text(a.t("buttons.update_user","Update User")),b("#name_and_email .user_details").fillTemplateData({data:c}),b("#edit_student_dialog").dialog("close")},error:function(c){b(this).find("button").attr("disabled",!1).filter(".submit_button").text(a.t("errors.updating_user_details_failed","Updating user details failed, please try again"))}}),b("#edit_student_dialog .cancel_button").click(function(){b("#edit_student_dialog").dialog("close")}),b(".remove_avatar_picture_link").click(function(c){c.preventDefault();var d=b(this),e=confirm(a.t("confirms.remove_profile_picture","Are you sure you want to remove this user's profile picture?"));if(!e)return;d.text(a.t("messages.removing_image","Removing image...")),b.ajaxJSON(d.attr("href"),"PUT",{"avatar[state]":"none"},function(a){d.parents("tr").find(".avatar_image").remove(),d.remove()},function(b){d.text(a.t("errors.failed_to_remove_image","Failed to remove the image, please try again"))})}),b(".report_avatar_picture_link").click(function(c){c.preventDefault(),c.preventDefault();var d=b(this);d.text(a.t("messages.reporting_image","Reporting image...")),b.ajaxJSON(d.attr("href"),"POST",{},function(b){d.after(a.t("notices.image_reported","This image has been reported")),d.remove()},function(b){d.text(a.t("errors.failed_to_report_image","Failed to report the image, please try again"))})})})})