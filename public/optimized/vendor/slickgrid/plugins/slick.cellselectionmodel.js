(function(a){function b(b){function c(c){p=a.extend(!0,{},q,b),k=c,l=k.getCanvasNode(),k.onActiveCellChanged.subscribe(j),c.registerPlugin(o),o.onCellRangeSelected.subscribe(i),o.onBeforeCellRangeSelected.subscribe(h)}function d(){k.onActiveCellChanged.unsubscribe(j),o.onCellRangeSelected.unsubscribe(i),o.onBeforeCellRangeSelected.unsubscribe(h),k.unregisterPlugin(o)}function e(a){var b=[];for(var c=0;c<a.length;c++){var d=a[c];k.canCellBeSelected(d.fromRow,d.fromCell)&&k.canCellBeSelected(d.toRow,d.toCell)&&b.push(d)}return b}function f(a){m=e(a),n.onSelectedRangesChanged.notify(m)}function g(){return m}function h(a,b){if(k.getEditorLock().isActive())return a.stopPropagation(),!1}function i(a,b){f([b.range])}function j(a,b){p.selectActiveCell&&f([new Slick.Range(b.row,b.cell)])}var k,l,m=[],n=this,o=new Slick.CellRangeSelector({selectionCss:{border:"2px solid black"}}),p,q={selectActiveCell:!0};a.extend(this,{getSelectedRanges:g,setSelectedRanges:f,init:c,destroy:d,onSelectedRangesChanged:new Slick.Event})}a.extend(!0,window,{Slick:{CellSelectionModel:b}})})(jQuery)