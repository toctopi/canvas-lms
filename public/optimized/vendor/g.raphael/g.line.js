/*!
 * g.Raphael 0.5 - Charting library, based on RaphaÃ«l
 *
 * Copyright (c) 2009 Dmitry Baranovskiy (http://g.raphaeljs.com)
 * Licensed under the MIT (http://www.opensource.org/licenses/mit-license.php) license.
 */
(function(){function a(a,b){var c=a.length/b,d=0,e=c,f=0,g=[];while(d<a.length)e--,e<0?(f+=a[d]*(1+e),g.push(f/c),f=a[d++]*-e,e+=c):f+=a[d++];return g}function b(a,b,c,d,e,f){var g=(c-a)/2,h=(e-c)/2,i=Math.atan((c-a)/Math.abs(d-b)),j=Math.atan((e-c)/Math.abs(d-f));i=b<d?Math.PI-i:i,j=f<d?Math.PI-j:j;var k=Math.PI/2-(i+j)%(Math.PI*2)/2,l=g*Math.sin(k+i),m=g*Math.cos(k+i),n=h*Math.sin(k+j),o=h*Math.cos(k+j);return{x1:c-l,y1:d+m,x2:c+n,y2:d+o}}function c(c,d,e,f,g,h,i,j){function k(a){var b=[];for(var j=0,k=h.length;j<k;j++)b=b.concat(h[j]);b.sort();var l=[],m=[];for(j=0,k=b.length;j<k;j++)b[j]!=b[j-1]&&l.push(b[j])&&m.push(d+n+(b[j]-B)*G);b=l,k=b.length;var o=a||c.set();for(j=0;j<k;j++){var p=m[j]-(m[j]-(m[j-1]||d))/2,q=((m[j+1]||d+f)-m[j])/2+(m[j]-(m[j-1]||d))/2,s;a?s={}:o.push(s=c.rect(p-1,e,Math.max(q+1,1),g).attr({stroke:"none",fill:"#000",opacity:0})),s.values=[],s.symbols=c.set(),s.y=[],s.x=m[j],s.axis=b[j];for(var u=0,v=i.length;u<v;u++){l=h[u]||h[0];for(var w=0,x=l.length;w<x;w++)l[w]==b[j]&&(s.values.push(i[u][w]),s.y.push(e+g-n-(i[u][w]-E)*H),s.symbols.push(t.symbols[u][w]))}a&&a.call(s)}!a&&(r=o)}function l(a){var b=a||c.set(),f;for(var j=0,k=i.length;j<k;j++)for(var l=0,m=i[j].length;l<m;l++){var o=d+n+((h[j]||h[0])[l]-B)*G,p=d+n+((h[j]||h[0])[l?l-1:1]-B)*G,q=e+g-n-(i[j][l]-E)*H;a?f={}:b.push(f=c.circle(o,q,Math.abs(p-o)/2).attr({stroke:"none",fill:"#000",opacity:0})),f.x=o,f.y=q,f.value=i[j][l],f.line=t.lines[j],f.shade=t.shades[j],f.symbol=t.symbols[j][l],f.symbols=t.symbols[j],f.axis=(h[j]||h[0])[l],a&&a.call(f)}!a&&(s=b)}var m=this;j=j||{},c.raphael.is(h[0],"array")||(h=[h]),c.raphael.is(i[0],"array")||(i=[i]);var n=j.gutter||10,o=Math.max(h[0].length,i[0].length),p=j.symbol||"",q=j.colors||m.colors,r=null,s=null,t=c.set(),u=[];for(var v=0,w=i.length;v<w;v++)o=Math.max(o,i[v].length);var x=c.set();for(v=0,w=i.length;v<w;v++)j.shade&&x.push(c.path().attr({stroke:"none",fill:q[v],opacity:j.nostroke?1:.3})),i[v].length>f-2*n&&(i[v]=a(i[v],f-2*n),o=f-2*n),h[v]&&h[v].length>f-2*n&&(h[v]=a(h[v],f-2*n));var y=Array.prototype.concat.apply([],h),z=Array.prototype.concat.apply([],i),A=m.snapEnds(Math.min.apply(Math,y),Math.max.apply(Math,y),h[0].length-1),B=A.from,C=A.to,D=m.snapEnds(Math.min.apply(Math,z),Math.max.apply(Math,z),i[0].length-1),E=D.from,F=D.to,G=(f-n*2)/(C-B||1),H=(g-n*2)/(F-E||1),I=c.set();if(j.axis){var J=(j.axis+"").split(/[,\s]+/);+J[0]&&I.push(m.axis(d+n,e+n,f-2*n,B,C,j.axisxstep||Math.floor((f-2*n)/20),2,c)),+J[1]&&I.push(m.axis(d+f-n,e+g-n,g-2*n,E,F,j.axisystep||Math.floor((g-2*n)/20),3,c)),+J[2]&&I.push(m.axis(d+n,e+g-n,f-2*n,B,C,j.axisxstep||Math.floor((f-2*n)/20),0,c)),+J[3]&&I.push(m.axis(d+n,e+g-n,g-2*n,E,F,j.axisystep||Math.floor((g-2*n)/20),1,c))}var K=c.set(),L=c.set(),M;for(v=0,w=i.length;v<w;v++){j.nostroke||K.push(M=c.path().attr({stroke:q[v],"stroke-width":j.width||2,"stroke-linejoin":"round","stroke-linecap":"round","stroke-dasharray":j.dash||""}));var N=Raphael.is(p,"array")?p[v]:p,O=c.set();u=[];for(var P=0,Q=i[v].length;P<Q;P++){var R=d+n+((h[v]||h[0])[P]-B)*G,S=e+g-n-(i[v][P]-E)*H;(Raphael.is(N,"array")?N[P]:N)&&O.push(c[Raphael.is(N,"array")?N[P]:N](R,S,(j.width||2)*3).attr({fill:q[v],stroke:"none"}));if(j.smooth){if(P&&P!=Q-1){var T=d+n+((h[v]||h[0])[P-1]-B)*G,U=e+g-n-(i[v][P-1]-E)*H,V=d+n+((h[v]||h[0])[P+1]-B)*G,W=e+g-n-(i[v][P+1]-E)*H,X=b(T,U,R,S,V,W);u=u.concat([X.x1,X.y1,R,S,X.x2,X.y2])}P||(u=["M",R,S,"C",R,S])}else u=u.concat([P?"L":"M",R,S])}j.smooth&&(u=u.concat([R,S,R,S])),L.push(O),j.shade&&x[v].attr({path:u.concat(["L",R,e+g-n,"L",d+n+((h[v]||h[0])[0]-B)*G,e+g-n,"z"]).join(",")}),!j.nostroke&&M.attr({path:u.join(",")})}return t.push(K,x,L,I,r,s),t.lines=K,t.shades=x,t.symbols=L,t.axis=I,t.hoverColumn=function(a,b){return!r&&k(),r.mouseover(a).mouseout(b),this},t.clickColumn=function(a){return!r&&k(),r.click(a),this},t.hrefColumn=function(a){var b=c.raphael.is(arguments[0],"array")?arguments[0]:arguments;if(!(arguments.length-1)&&typeof a=="object")for(var d in a)for(var e=0,f=r.length;e<f;e++)r[e].axis==d&&r[e].attr("href",a[d]);!r&&k();for(e=0,f=b.length;e<f;e++)r[e]&&r[e].attr("href",b[e]);return this},t.hover=function(a,b){return!s&&l(),s.mouseover(a).mouseout(b),this},t.click=function(a){return!s&&l(),s.click(a),this},t.each=function(a){return l(a),this},t.eachColumn=function(a){return k(a),this},t}var d=function(){};d.prototype=Raphael.g,c.prototype=new d,Raphael.fn.linechart=function(a,b,d,e,f,g,h){return new c(this,a,b,d,e,f,g,h)}})()