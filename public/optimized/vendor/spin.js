define(function(){function a(a,b){var c=document.createElement(a||"div"),d;for(d in b)c[d]=b[d];return c}function b(a){for(var b=1,c=arguments.length;b<c;b++)a.appendChild(arguments[b]);return a}function c(a,b,c,d){var e=["opacity",b,~~(a*100),c,d].join("-"),f=.01+c/d*100,g=Math.max(1-(1-a)/b*(100-f),a),h=j.substring(0,j.indexOf("Animation")).toLowerCase(),l=h&&"-"+h+"-"||"";return i[e]||(k.insertRule("@"+l+"keyframes "+e+"{"+"0%{opacity:"+g+"}"+f+"%{opacity:"+a+"}"+(f+.01)+"%{opacity:1}"+(f+b)%100+"%{opacity:"+a+"}"+"100%{opacity:"+g+"}"+"}",0),i[e]=1),e}function d(a,b){var c=a.style,d,e;if(c[b]!==undefined)return b;b=b.charAt(0).toUpperCase()+b.slice(1);for(e=0;e<h.length;e++){d=h[e]+b;if(c[d]!==undefined)return d}}function e(a,b){for(var c in b)a.style[d(a,c)||c]=b[c];return a}function f(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)a[d]===undefined&&(a[d]=c[d])}return a}function g(a){var b={x:a.offsetLeft,y:a.offsetTop};while(a=a.offsetParent)b.x+=a.offsetLeft,b.y+=a.offsetTop;return b}var h=["webkit","Moz","ms","O"],i={},j,k=function(){var c=a("style");return b(document.getElementsByTagName("head")[0],c),c.sheet||c.styleSheet}(),l={lines:12,length:7,width:5,radius:10,rotate:0,color:"#000",speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto"},m=function n(a){if(!this.spin)return new n(a);this.opts=f(a||{},n.defaults,l)};return m.defaults={},f(m.prototype,{spin:function(b){this.stop();var c=this,d=c.opts,f=c.el=e(a(0,{className:d.className}),{position:"relative",zIndex:d.zIndex}),h=d.radius+d.length+d.width,i,k;b&&(b.insertBefore(f,b.firstChild||null),k=g(b),i=g(f),e(f,{left:(d.left=="auto"?k.x-i.x+(b.offsetWidth>>1):d.left+h)+"px",top:(d.top=="auto"?k.y-i.y+(b.offsetHeight>>1):d.top+h)+"px"})),f.setAttribute("aria-role","progressbar"),c.lines(f,c.opts);if(!j){var l=0,m=d.fps,n=m/d.speed,o=(1-d.opacity)/(n*d.trail/100),p=n/d.lines;!function q(){l++;for(var a=d.lines;a;a--){var b=Math.max(1-(l+a*p)%n*o,d.opacity);c.opacity(f,d.lines-a,b,d)}c.timeout=c.el&&setTimeout(q,~~(1e3/m))}()}return c},stop:function(){var a=this.el;return a&&(clearTimeout(this.timeout),a.parentNode&&a.parentNode.removeChild(a),this.el=undefined),this},lines:function(d,f){function g(b,c){return e(a(),{position:"absolute",width:f.length+f.width+"px",height:f.width+"px",background:b,boxShadow:c,transformOrigin:"left",transform:"rotate("+~~(360/f.lines*h+f.rotate)+"deg) translate("+f.radius+"px"+",0)",borderRadius:(f.width>>1)+"px"})}var h=0,i;for(;h<f.lines;h++)i=e(a(),{position:"absolute",top:1+~(f.width/2)+"px",transform:f.hwaccel?"translate3d(0,0,0)":"",opacity:f.opacity,animation:j&&c(f.opacity,f.trail,h,f.lines)+" "+1/f.speed+"s linear infinite"}),f.shadow&&b(i,e(g("#000","0 0 4px #000"),{top:"2px"})),b(d,b(i,g(f.color,"0 0 1px rgba(0,0,0,.1)")));return d},opacity:function(a,b,c){b<a.childNodes.length&&(a.childNodes[b].style.opacity=c)}}),!function(){function c(b,c){return a("<"+b+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',c)}var f=e(a("group"),{behavior:"url(#default#VML)"});!d(f,"transform")&&f.adj?(k.addRule(".spin-vml","behavior:url(#default#VML)"),m.prototype.lines=function(a,d){function f(){return e(c("group",{coordsize:i+" "+i,coordorigin:-h+" "+ -h}),{width:i,height:i})}function g(a,g,i){b(k,b(e(f(),{rotation:360/d.lines*a+"deg",left:~~g}),b(e(c("roundrect",{arcsize:1}),{width:h,height:d.width,left:d.radius,top:-d.width>>1,filter:i}),c("fill",{color:d.color,opacity:d.opacity}),c("stroke",{opacity:0}))))}var h=d.length+d.width,i=2*h,j=-(d.width+d.length)*2+"px",k=e(f(),{position:"absolute",top:j,left:j}),l;if(d.shadow)for(l=1;l<=d.lines;l++)g(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=d.lines;l++)g(l);return b(a,k)},m.prototype.opacity=function(a,b,c,d){var e=a.firstChild;d=d.shadow&&d.lines||0,e&&b+d<e.childNodes.length&&(e=e.childNodes[b+d],e=e&&e.firstChild,e=e&&e.firstChild,e&&(e.opacity=c))}):j=d(f,"animation")}(),window.Spinner=m,m})