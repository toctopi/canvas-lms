define(["jquery"],function(a){var b=!1,c=!b,d=".pageless",e="scroll"+d,f="resize"+d,g=null,h=function(g){var h,i=b,j,k={container:window,currentPage:1,distance:100,pagination:".pagination",params:{},url:location.href,loaderImage:"/images/load.gif",animate:!0},l,m,n=function(b){a.isFunction(b)?b.call():p(b)},o=function(){return k.loaderHtml||'<div id="pageless-loader" style="display:none;text-align:center;width:100%;">  <div class="msg" style="color:#e9e9e9;font-size:2em"></div>  <img src="'+k.loaderImage+'" alt="loading more results" style="margin:10px auto" /></div>'},p=function(b){b&&a.extend(k,b),l=k.container,m=a(l),k.pagination&&a(k.pagination).remove(),u()},q=function(b,c){var d=a(c.loader,b);h=b,c.loader&&d.length?j=d:(j=a(o()),b.append(j),c.loaderHtml||a("#pageless-loader .msg").html(c.loaderMsg)),r(i)},r=function(a){i=a;if(!j)return;i?j.parents().first().is(":visible")&&k.animate?j.fadeIn("normal"):j.show():j.parents().first().is(":visible")&&k.animate?j.fadeOut("normal"):j.hide()},s=function(){return l===window?a(document).height()-m.scrollTop()-m.height():m[0].scrollHeight-m.scrollTop()-m.height()},t=function(){m.unbind(d)},u=function(){m.bind(e+" "+f,v).trigger(e)},v=function(){if(k.totalPages>k.currentPage)!i&&s()<k.distance&&(r(c),k.currentPage++,a.extend(k.params,{page:k.currentPage}),a.get(k.url,k.params,function(c,d,e){var c=a.isFunction(k.scrape)?k.scrape(c,e):c;j?j.before(c):h.append(c),r(b),k.complete&&k.complete.call()},"html"));else{t(),k.end&&k.end.call();return}};return{activate:n,applyContext:q}};a.pageless=function(a){return g===null&&(g=h(a),g.activate(a)),g},a.fn.pageless=function(b){return this.hasOwnProperty("pagelessInstance")||(this.pagelessInstance=h(b),this.pagelessInstance.activate(b)),this.pagelessInstance.applyContext(a(this),b),this}})