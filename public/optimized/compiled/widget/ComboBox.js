(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define(["jquery","underscore","Backbone","jst/ComboBox","str/htmlEscape","vendor/ui.selectmenu"],function(b,c,d,e,f){var g;return g=function(){function g(f,g){var h,i=this;this.items=f,g==null&&(g={}),this._formatOption=a(this._formatOption,this),this._buildOption=a(this._buildOption,this),this._next=a(this._next,this),this._previous=a(this._previous,this),g.value!=null&&(this._value=g.value),g.label!=null&&(this._label=g.label),this.$el=b(e()),this.$container=b(".ui-combobox-container",this.$el),this.$prev=b(".ui-combobox-prev",this.$el),this.$next=b(".ui-combobox-next",this.$el),this.$menu=b("select",this.$container),(h=this.$menu).append.apply(h,c.map(this.items,this._buildOption)),this.$menu.selectmenu({style:"dropdown",width:"230px",format:this._formatOption}),this.$selectmenu=this.$menu.data("selectmenu").list,g.selected!=null&&this.select(g.selected),c.extend(this,d.Events),this.$menu.change(function(){return i.trigger("change",i.selected())}),this.$prev.bind("click",this._previous),this.$next.bind("click",this._next)}return g.name="ComboBox",g.prototype.select=function(a){var b;return b=this._index(),this.$menu.selectmenu("value",a),this._index()!==b&&this.$menu.change(),this},g.prototype.selected=function(){return this.items[this._index()]},g.prototype._index=function(){return this.$menu[0].selectedIndex},g.prototype._previous=function(a){var b;return a.preventDefault(),a.stopPropagation(),b=(this._index()+this.items.length-1)%this.items.length,this.select(this._value(this.items[b]))},g.prototype._next=function(a){var b;return a.preventDefault(),a.stopPropagation(),b=(this._index()+1)%this.items.length,this.select(this._value(this.items[b]))},g.prototype._value=function(a){return a.value},g.prototype._label=function(a){return a.label},g.prototype._buildOption=function(a){return"<option value='"+this._value(a)+"'>"+f(this._label(a))+"</option>"},g.prototype._formatOption=function(a){return"<span class='ui-selectmenu-item'>"+a+"</span>"},g}()})}).call(this)