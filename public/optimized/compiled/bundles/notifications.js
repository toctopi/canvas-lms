define("translations/profile",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{es:{profile:{alerts:{profile_picture_locked:"Su foto de perfil ha sido bloqueada por un administrador, y no puede cambiarse."},buttons:{add_file:"Agregar Archivo",adding_file:"Agregando Archivo...",generate_token:"Generar un Componente Léxico",generating_token:"Generando Componente Léxico...",regenerate_token:"Regenerar Componente Léxico",regenerating_token:"Regenerando Componenete Léxico...",select_image:"Seleccionar Imagen",selecting_image:"Seleccionando Imagen..."},communication:{buttons:{problem_saving_preferences:"Problema Guardando las Preferencias",save_preferences:"Guardar Preferencias",saved_preferences:"¡Preferencias Guardadas!",saving_preferences:"Guardando Preferencias..."},errors:{saving_preferences_failed:"¡Oops! Algo falló. Intente guardar otra vez"},notices:{communication_preferences_updated:"Preferencias de Comunicación Actualizadas"}},confirms:{delete_access_key:"¿Seguro que quiere borrar esta clave de acceso?",delete_login:"¿Seguro que quiere borrar este inicio de sesión?",regenerate_token:"¿Seguro que quiere regenerar este componente léxico? Cualquier cosa usando este componente léxico tendrá que actualizarse.",unregister_service:"¿Seguro que quiere cancelar el registro de este servicio?"},errors:{adding_file_failed:"Falló la adición del archivo",generating_token_failed:"Falló la generación del Componente léxico",loading_images_failed:"Falló la carga de imagenes, intente de nuevo",regenerating_token_failed:"Falló la Regeneración del Componente léxico",registration_failed:"Falló la inscripción. Revise el nombre de usuario y la contraseña, e intente de nuevo.",selecting_image_failed:"Selección de la Imagen Falló, intente de nuevo"},headers:{loading_images:"Cargando Imagenes..."},please_select_an_option:"Por favor seleccione una opción",titles:{select_profile_pic:"Seleccionar una Foto de Perfil"},token_never_expires:"nunca"}}}})}),require(["i18n!profile","jquery","jquery.ajaxJSON","jquery.instructure_forms","jquery.instructure_misc_plugins","jquery.loadingImg","jquery.rails_flash_notifications","jquery.templateData"],function(a,b){b(document).ready(function(){b(".notification_preferences .frequency").click(function(a){a.preventDefault(),b(this).hasClass("selected")||(b(this).parents("tr").find(".frequency").removeClass("selected").removeClass("selected_pending"),b(this).addClass("selected_pending"))}),b(".notification_preferences .add_notification_link").click(function(a){a.preventDefault();var c=b(this).parents("tr").prev(),d=c.clone(!0);d.find(".delete_preference_link").show(),d.find(".frequency.selected").removeClass("selected").addClass("selected_pending"),c.after(d);var c=d.prev(".preference");while(c.length>0)c.find(".delete_preference_link").show(),c=c.prev(".preference");d.find(".contact_type_select").change()}),b(".delete_preference_link").bind("click",function(a,c){a.preventDefault();var d=b(this).parents(".preference");while(d.prev(".preference").length>0)d=d.prev(".preference");var e=1,f=d;while(f.next(".preference").length>0)f=f.next(".preference"),e++;var g=c?0:"normal";b(this).parents(".preference").fadeOut(g,function(){if(e<3){d.find(".delete_preference_link").hide();while(d.next(".preference").length>0)d=d.next(".preference"),d.find(".delete_preference_link").hide()}b(this).remove()})}),b(".sms_select").change(function(a){b(this).val()=="new"&&b(".add_contact_link").click()}),b(".email_select").change(function(a){b(this).val()=="new"&&b(".add_email_link").click()}),b(".contact_type_select").change(function(a){var c=b(this).parents("tr.preference"),d=b(this).val();if(c.find(".contact_select").hasClass(d))return;var e=b("#select_templates ."+d).clone(!0);e[0].selectedIndex=0,c.find(".contact_select").after(e).remove(),c.find(".at").showIf(d=="email_select"||d=="sms_select")}).each(function(){b(this).change()}),b(".save_preferences_button").click(function(c){c.preventDefault();var d=b(this);b(".notification_preferences").loadingImage();var e=b(".notification_preferences").getFormData();b(".notification_preferences tr.preference").each(function(){var a=b(this).getTemplateData({textValues:["category_slug","channel_id"]}),c="immediately";a.channel_id=b(this).getFormData().channel_id;var d=b(this).find(".frequency.selected,.frequency.selected_pending");d.hasClass("never")?c="never":d.hasClass("daily")?c="daily":d.hasClass("weekly")&&(c="weekly"),a.category_slug&&a.channel_id&&(e["category_"+a.category_slug+"[channel_"+a.channel_id+"]"]=c)});var f=b("#contact_urls .update_communication_url").filter(":last").attr("href");d.text(a.t("communication.buttons.saving_preferences","Saving Preferences...")).attr("disabled",!0),b.ajaxJSON(f,"POST",e,function(c){d.text(a.t("communication.buttons.saved_preferences","Saved Preferences!")).attr("disabled",!1),setTimeout(function(){d.text(a.t("communication.buttons.save_preferences","Save Preferences"))},2500),b.flashMessage(a.t("communication.notices.communication_preferences_updated","Communication Preferences updated")),b(".notification_preferences").loadingImage("remove"),b("tr.preference .frequency.selected_pending").removeClass("selected_pending").addClass("selected");var e={};b("tr.preference").each(function(){var a=b(this).getTemplateData({textValues:["category_slug"]}).category_slug;e[a]&&b(this).find(".delete_preference_link").triggerHandler("click",!0),e[a]=!0}),e={};for(var f in c){var g=c[f].notification_policy;e[g.notification_id]&&b(".add_notification_"+g.notification_id).click(),e[g.notification_id]=!0;var h=b(".preference_"+g.notification_id+":last"),i="email_select";b(".channel_option_"+g.communication_channel_id).parents("select").hasClass("sms_select")?i="sms_select":b(".channel_option_"+g.communication_channel_id).parents("select").hasClass("facebook_select")?i="facebook_select":b(".channel_option_"+g.communication_channel_id).parents("select").hasClass("twitter_select")&&(i="twitter_select"),h.find(".contact_type_select").val(i).change(),h.find(".contact_select").val(g.communication_channel_id),h.find(".frequency."+g.frequency).click()}b("tr.preference .frequency.selected_pending").removeClass("selected_pending").addClass("selected")},function(c){d.text(a.t("communication.buttons.problem_saving_preferences","Problem Saving Preferences")).attr("disabled",!1),b(".notification_preferences").loadingImage("remove"),b.flashError(a.t("communication.errors.saving_preferences_failed","Oops! Something broke.  Try saving again"))})}),b(".sms_select, .email_select").change(function(){b(this).parents("tr.preference").length>0&&b(this).parents("tr.preference td.frequency.selected").removeClass("selected").addClass("selected_pending")})})}),define("notification_preferences",function(){}),require(["i18n!profile","jquery","jquery.ajaxJSON","jquery.instructure_forms","jqueryui/dialog","jquery.instructure_misc_helpers","jquery.instructure_misc_plugins","jquery.loadingImg","jquery.rails_flash_notifications","jquery.templateData","jqueryui/tabs"],function(a,b){b(document).ready(function(){b("#communication_channels").tabs(),b("#communication_channels").bind("tabsshow",function(a){if(b(this).css("display")!="none"){var c=b(this).data("selected.tabs");c==0?b("#register_email_address").find(":text:first").focus().select():b("#register_sms_number").find(":text:first").focus().select()}}),b(".channel_list tr").hover(function(){if(b(this).hasClass("unconfirmed")){var c=a.t("titles.contact_not_confirmed","This contact has not been confirmed.  Click the address for more details");b(this).closest(".email_channels").length>0&&(c=a.t("titles.email_not_confirmed","This email has not been confirmed.  Click the address for more details")),b(this).attr("title",c),b(this).find("a.path").parent().attr("title",c)}},function(){b(this).attr("title",""),b(this).find("a.path").parent().attr("title",b(this).find("a.path").text())}),b(".add_email_link,.add_contact_link").click(function(c){c.preventDefault();var d="email";b("#communication_channels").show().dialog("close").dialog({title:a.t("titles.register_communication","Register Communication"),width:430,resizable:!1,modal:!0,open:function(){b("#communication_channels").triggerHandler("tabsshow")}}).dialog("open"),b(this).hasClass("add_contact_link")?(b("#communication_channels").tabs("select","#register_sms_number"),d="sms"):b("#communication_channels").tabs("select","#register_email_address")}),b("#register_sms_number .user_selected").bind("change blur keyup focus",function(){var a=b(this).parents("#register_sms_number"),c=a.find(".sms_number").val().replace(/[^\d]/g,"");a.find(".should_be_10_digits").showIf(c&&c.length!=10);var d=a.find(".carrier").val();a.find(".sms_email").attr("disabled",d!="other");if(d=="other")return;d=d.replace("#",c),a.find(".sms_email").val(d)}),b("#register_sms_number,#register_email_address").formSubmit({beforeSubmit:function(c){var d=b(".email_channels"),c=b(this).getFormData({object_name:"communication_channel"});b(this).attr("id")=="register_sms_number"&&(d=b(".other_channels"));var e=b(this).getFormData({object_name:"communication_channel"}).address;b(this).data("email",e),d.find(".channel .path").each(function(){b(this).text()==e&&(e="")}),d.removeClass("single");var f=null;return e&&(f=d.find(".channel.blank").clone(!0).removeClass("blank"),f.find(".path").attr("title",a.t("titles.unconfirmed_click_to_confirm","Unconfirmed.  Click to confirm")),f.fillTemplateData({data:{path:e}}),d.find(".channel.blank").before(f.show())),e?(b("#communication_channels").dialog("close"),f.loadingImage({image_size:"small"}),f):!1},success:function(a,c){b("#communication_channels").dialog("close"),c.loadingImage("remove"),a.channel_id=a.id;var d="email_select";b(this).attr("id")=="register_sms_number"&&(d="sms_select");var e=b("#select_templates ."+d),f=b(document.createElement("option"));f.val(a.id).text(a.address),e.find("option:last").before(f),e.find("option.blank_option").remove(),b("."+d).each(function(){var c=b(this).val();c=="new"&&(c=a.id),b(this).after(e.clone(!0).val(c)).remove()}),c.fillTemplateData({data:a,id:"channel_"+a.id,hrefValues:["user_id","pseudonym_id","channel_id"]}),c.find(".path").triggerHandler("click")},error:function(a,b){b.loadingImage("remove"),b.remove()}}),b("a.email_address_taken_learn_more").live("click",function(a){a.preventDefault()}),b(".channel_list .channel .delete_channel_link").click(function(a){a.preventDefault(),b(this).parents(".channel").confirmDelete({url:b(this).attr("href"),success:function(a){var c=b(this).parents(".channel_list");b(this).remove(),c.toggleClass("single",c.find(".channel:visible").length<=1)}})}),b("#confirm_communication_channel .cancel_button").click(function(a){b("#confirm_communication_channel").dialog("close")}),b(".email_channels .channel .path,.other_channels .channel .path").click(function(c){c.preventDefault();var d=b(this).parents(".channel");if(d.hasClass("unconfirmed")){var e="email address",f=a.t("titles.confirm_email_address","Confirm Email Address");b(this).parents(".channel_list").hasClass("other_channels")&&(e="sms number",f=a.t("titles.confirm_sms_number","Confirm SMS Number"));var g=b("#confirm_communication_channel");d.parents(".email_channels").length>0&&(g=b("#confirm_email_channel"));var h=d.getTemplateData({textValues:["user_id","pseudonym_id","channel_id"]}),i=b(this).text();e=="sms number"&&(i=i.split("@")[0]),h.code="",g.fillTemplateData({data:{path:i,path_type:e,user_id:h.user_id,channel_id:h.channel_id}}),g.find(".status_message").css("visibility","hidden");var j=b(".re_send_confirmation_url").attr("href");j=b.replaceTags(j,"id",h.channel_id),j=b.replaceTags(j,"pseudonym_id",h.pseudonym_id),j=b.replaceTags(j,"user_id",h.user_id),g.find(".re_send_confirmation_link").attr("href",j).text(a.t("links.resend_confirmation","Re-Send Confirmation")),g.fillFormData(h),g.show().dialog("close").dialog({autoOpen:!1,title:f,width:350,open:function(){b(this).find(":text:first").focus().select()}}).dialog("open")}}),b("#confirm_communication_channel").formSubmit({formErrors:!1,processData:function(a){var c=b(this).find(".register_channel_link").attr("href");c=b.replaceTags(c,"id",a.channel_id),c=b.replaceTags(c,"code",a.code),b(this).attr("action",c)},beforeSubmit:function(c){b(this).find(".status_message").text(a.t("confirming_contact","Confirming...")).css("visibility","visible")},success:function(c){b(this).find(".status_message").css("visibility","hidden");var d=c.communication_channel.pseudonym_id;b("#channel_"+c.communication_channel.id).removeClass("unconfirmed"),b(".channel.pseudonym_"+d).removeClass("unconfirmed"),b("#confirm_communication_channel").dialog("close"),b.flashMessage(a.t("notices.contact_confirmed","Contact successfully confirmed!"))},error:function(c){b(this).find(".status_message").text(a.t("errors.confirmation_failed","Confirmation failed.  Please try again."))}}),b(".channel_list .channel .default_link").click(function(a){a.preventDefault();var c=b(this).parents(".channel").getTemplateData({textValues:["channel_id"]}).channel_id,d={default_email_id:c};b.ajaxJSON(b(this).attr("href"),"PUT",d,function(a){var c=a.user.communication_channel.id;b(".channel.default").removeClass("default"),b(".channel#channel_"+c).addClass("default"),b(".default_email.display_data").text(a.user.pseudonym.unique_id)})}),b(".dialog .re_send_confirmation_link").click(function(c){c.preventDefault();var d=b(this);d.text(a.t("links.resending_confirmation","Re-Sending...")),b.ajaxJSON(d.attr("href"),"POST",{},function(b){d.text(a.t("links.resent_confirmation","Done! Message may take a few minutes."))},function(b){d.text(a.t("links.resend_confirmation_failed","Request failed. Try again."))})}),b("#communication_channels .cancel_button").click(function(a){b("#communication_channels").dialog("close")}),b("#confirm_email_channel .cancel_button").click(function(){b("#confirm_email_channel").dialog("close")})})}),define("communication_channels",function(){}),function(){require(["notification_preferences","communication_channels"])}.call(this),define("compiled/bundles/notifications",function(){})