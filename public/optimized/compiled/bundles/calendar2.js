/*!
 * jQuery UI @VERSION
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
/*!
 * jQuery UI Widget @VERSION
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
/*!
 * jQuery UI @VERSION
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
/*!
 * jQuery UI Widget @VERSION
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
define("translations/calendar",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),function(){define("compiled/util/hsvToRgb",[],function(){var a;return a=function(a,b,c){var d,e,f,g,h,i,j,k,l;b/=100,c/=100,g=Math.floor(a/60%6),e=a/60-g,h=c*(1-b),i=c*(1-e*b),l=c*(1-(1-e)*b),k=[];switch(g){case 0:k=[c,l,h];break;case 1:k=[i,c,h];break;case 2:k=[h,c,l];break;case 3:k=[h,i,c];break;case 4:k=[l,h,c];break;case 5:k=[c,h,i]}return j=Math.min(255,Math.round(k[0]*256)),f=Math.min(255,Math.round(k[1]*256)),d=Math.min(255,Math.round(k[2]*256)),[j,f,d]}})}.call(this),define("translations/calendar.calendar_app",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),function(){define("compiled/str/splitAssetString",["str/pluralize"],function(a){return function(b){var c;if(c=b.match(/(.*)_(\d+)$/))return[a(c[1]),parseInt(c[2])]}})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/util/Popover",[],function(){var b,c,d;return d=0,c=[],b=function(){function b(b,c){var d=this;this.content=c,this.position=a(this.position,this),this.outsideClickHandler=a(this.outsideClickHandler,this),this.trigger=$(b.currentTarget),this.el=$(this.content).addClass("carat-bottom").attr("role","dialog").data("popover",this).keyup(function(a){if(a.keyCode===$.ui.keyCode.ESCAPE)return d.hide()}),this.el.delegate(".popover_close","click",function(a){return a.preventDefault(),d.hide()}),this.show(b)}return b.name="Popover",b.prototype.show=function(a){var b,e,f,g,h;while(h=c.pop())h.hide();return c.push(this),g="popover-"+d++,this.trigger.attr({"aria-haspopup":!0,"aria-owns":g}),this.el.attr({id:g,"aria-hidden":!1,"aria-expanded":!0}).appendTo(document.body).show(),this.el.find(":tabbable").not(".popover_close").first().focus(1),this.position(),this.el.find(".ui-menu-carat").remove(),f=this.trigger.offset().left-this.el.offset().left,b=a.pageX-this.trigger.offset().left,e=Math.min(Math.max(20,b),this.trigger.width()-20)+f,$('<span class="ui-menu-carat"><span /></span>').css("left",e).prependTo(this.el),this.positionInterval=setInterval(this.position,200),$(window).click(this.outsideClickHandler)},b.prototype.hide=function(){var a,b,d,e;for(a=d=0,e=c.length;d<e;a=++d)b=c[a],this===b&&c.splice(a,1);return this.el.detach(),clearInterval(this.positionInterval),$(window).unbind("click",this.outsideClickHandler)},b.prototype.ignoreOutsideClickSelector=".ui-dialog",b.prototype.outsideClickHandler=function(a){if(!$(a.target).closest(this.el.add(this.trigger).add(this.ignoreOutsideClickSelector)).length)return this.hide()},b.prototype.position=function(){return this.el.position({my:"center bottom",at:"center top",of:this.trigger,offset:"0 -10px",within:"#main",collision:"fit fit"})},b}()})}.call(this),define("translations/calendar.event_details",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/calendar.delete_item",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/calendar.reservation_over_limit_dialog",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/calendar.message_participants",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),function(){define("compiled/calendar/TimeBlockListManager",["jquery"],function(a){var b;return b=function(){function a(a){var b,c,d,e,f,g;this.blocks=[];if(a)for(e=0,f=a.length;e<f;e++)g=a[e],d=g[0],b=g[1],c=g[2],this.add(d,b,c)}return a.name="TimeBlockListManager",a.prototype.add=function(a,b,c){return this.blocks.push({start:a,end:b,locked:c})},a.prototype.consolidate=function(){var a,b,c,d,e,f;this.sort(),b=[],b.last=function(){return this[this.length-1]},f=this.blocks;for(d=0,e=f.length;d<e;d++){a=f[d];if(!b.last()){b.push(a);continue}c=b.last(),c.end.getTime()===a.start.getTime()&&!c.locked&&!a.locked?c.end=a.end:b.push(a)}return this.blocks=b},a.prototype.split=function(a){var b,c,d,e,f,g,h;this.consolidate(),e=a*60*1e3,h=this.blocks;for(f=0,g=h.length;f<g;f++){b=h[f];if(b.locked)continue;while(b.end-b.start>a*60*1e3)d=b.start,c=new Date(b.start.getTime()+e),b.start=new Date(b.start.getTime()+e),this.add(d,c)}return this.sort()},a.prototype.sort=function(){return this.blocks=this.blocks.sort(function(a,b){return a.end>b.start?1:-1})},a.prototype["delete"]=function(a){if(a!=null&&this.blocks.length>a&&!this.blocks[a].locked)return this.blocks.splice(a,1)},a.prototype.reset=function(){return this.blocks=[]},a}()})}.call(this),define("translations/calendar.time_block_row",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/calendar.edit_calendar_event",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{es:{buttons:{submit:"Enviar"}}}})}),define("translations/calendar.edit_assignment",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{es:{buttons:{submit:"Enviar"}}}})}),define("translations/appt_calendar_event_dialog",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/calendar.edit_appt_calendar_event",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/EditAppointmentGroupDetails",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/calendar.edit_appointment_group",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/calendar.context_selector",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/calendar.edit_event",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/calendar.appointment_group_list",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/calendar.scheduler_right_side_admin_section",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("vendor/fullcalendar",["jquery"],function(a,b){function c(b){a.extend(!0,br,b)}function d(c,d,j){function k(a){bb?(y(),x(),G(),t(a)):l()}function l(){bc=d.theme?"ui":"fc",c.addClass("fc"),d.isRTL&&c.addClass("fc-rtl"),d.theme&&c.addClass("ui-widget"),bb=a("<div class='fc-content' style='position:relative'/>").prependTo(c),_=new e(X,d),ba=_.render(),ba&&c.prepend(ba),s(d.defaultView),a(window).resize(A),r()||n()}function n(){setTimeout(function(){!bd.start&&r()&&t()},0)}function o(){a(window).unbind("resize",A),_.destroy(),bb.remove(),c.removeClass("fc fc-rtl ui-widget")}function p(){return $.offsetWidth!==0}function r(){return a("body")[0].offsetWidth!==0}function s(b){if(!bd||b!=bd.name){bj++,I();var c=bd,d;c?((c.beforeHide||O)(),N(bb,bb.height()),c.element.hide()):N(bb,1),bb.css("overflow","hidden"),bd=be[b],bd?bd.element.show():bd=be[b]=new bu[b](d=bh=a("<div class='fc-view fc-view-"+b+"' style='position:absolute'/>").appendTo(bb),X),c&&_.deactivateButton(c.name),_.activateButton(b),t(),bb.css("overflow",""),c&&N(bb,1),d||(bd.afterShow||O)(),bj--}}function t(a){if(p()){bj++,I(),bg===b&&y();var d=!1;!bd.start||a||bk<bd.start||bk>=bd.end?(bd.render(bk,a||0),z(!0),d=!0):bd.sizeDirty?(bd.clearEvents(),z(),d=!0):bd.eventsDirty&&(bd.clearEvents(),d=!0),bd.sizeDirty=!1,bd.eventsDirty=!1,B(d),bf=c.outerWidth(),_.updateTitle(bd.title);var e=new Date;e>=bd.start&&e<bd.end?_.disableButton("today"):_.enableButton("today"),bj--,bd.trigger("viewDisplay",$)}}function w(){x(),p()&&(y(),z(),I(),bd.clearEvents(),bd.renderEvents(bl),bd.sizeDirty=!1)}function x(){a.each(be,function(a,b){b.sizeDirty=!0})}function y(){d.contentHeight?bg=d.contentHeight:d.height?bg=d.height-(ba?ba.height():0)-J(bb):bg=Math.round(bb.width()/Math.max(d.aspectRatio,.5))}function z(a){bj++,bd.setHeight(bg,a),bh&&(bh.css("position","relative"),bh=null),bd.setWidth(bb.width(),a),bj--}function A(){if(!bj)if(bd.start){var a=++bi;setTimeout(function(){a==bi&&!bj&&p()&&bf!=(bf=c.outerWidth())&&(bj++,w(),bd.trigger("windowResize",$),bj--)},200)}else n()}function B(a){!d.lazyFetching||Y(bd.visStart,bd.visEnd)?C():a&&F()}function C(){Z(bd.visStart,bd.visEnd)}function D(a){bl=a,F()}function E(a){F(a)}function F(a){G(),p()&&(bd.clearEvents(),bd.renderEvents(bl,a),bd.eventsDirty=!1)}function G(){a.each(be,function(a,b){b.eventsDirty=!0})}function H(a,c,d){bd.select(a,c,d===b?!0:d)}function I(){bd&&bd.unselect()}function K(){t(-1)}function L(){t(1)}function M(){g(bk,-1),t()}function P(){g(bk,1),t()}function Q(){bk=new Date,t()}function R(a,b,c){a instanceof Date?bk=m(a):q(bk,a,b,c),t()}function S(a,c,d){a!==b&&g(bk,a),c!==b&&h(bk,c),d!==b&&i(bk,d),t()}function T(){return m(bk)}function U(){return bd}function V(a,c){if(c===b)return d[a];if(a=="height"||a=="contentHeight"||a=="aspectRatio")d[a]=c,w()}function W(a,b){if(d[a])return d[a].apply(b||$,Array.prototype.slice.call(arguments,2))}var X=this;X.options=d,X.render=k,X.destroy=o,X.refetchEvents=C,X.reportEvents=D,X.reportEventChange=E,X.rerenderEvents=F,X.changeView=s,X.select=H,X.unselect=I,X.prev=K,X.next=L,X.prevYear=M,X.nextYear=P,X.today=Q,X.gotoDate=R,X.incrementDate=S,X.formatDate=function(a,b){return u(a,b,d)},X.formatDates=function(a,b,c){return v(a,b,c,d)},X.getDate=T,X.getView=U,X.option=V,X.trigger=W,f.call(X,d,j);var Y=X.isFetchNeeded,Z=X.fetchEvents,$=c[0],_,ba,bb,bc,bd,be={},bf,bg,bh,bi=0,bj=0,bk=new Date,bl=[],bm;q(bk,d.year,d.month,d.date),d.droppable&&a(document).bind("dragstart",function(b,c){var e=b.target,f=a(e);if(!f.parents(".fc").length){var g=d.dropAccept;if(a.isFunction(g)?g.call(e,f):f.is(g))bm=e,bd.dragStart(bm,b,c)}}).bind("dragstop",function(a,b){bm&&(bd.dragStop(bm,a,b),bm=null)})}function e(b,c){function d(){n=c.theme?"ui":"fc";var b=c.header;if(b)return m=a("<table class='fc-header' style='width:100%'/>").append(a("<tr/>").append(f("left")).append(f("center")).append(f("right"))),m}function e(){m.remove()}function f(d){var e=a("<td class='fc-header-"+d+"'/>"),f=c.header[d];return f&&a.each(f.split(" "),function(d){d>0&&e.append("<span class='fc-header-space'/>");var f;a.each(this.split(","),function(d,g){if(g=="title")e.append("<span class='fc-header-title'><h2>&nbsp;</h2></span>"),f&&f.addClass(n+"-corner-right"),f=null;else{var h;b[g]?h=b[g]:bu[g]&&(h=function(){k.removeClass(n+"-state-hover"),b.changeView(g)});if(h){var i=c.theme?S(c.buttonIcons,g):null,j=S(c.buttonText,g),k=a("<span class='fc-button fc-button-"+g+" "+n+"-state-default'>"+"<span class='fc-button-inner'>"+"<span class='fc-button-content'>"+(i?"<span class='fc-icon-wrap'><span class='ui-icon ui-icon-"+i+"'/>"+"</span>":j)+"</span>"+"<span class='fc-button-effect'><span></span></span>"+"</span>"+"</span>");k&&(k.click(function(){k.hasClass(n+"-state-disabled")||h()}).mousedown(function(){k.not("."+n+"-state-active").not("."+n+"-state-disabled").addClass(n+"-state-down")}).mouseup(function(){k.removeClass(n+"-state-down")}).hover(function(){k.not("."+n+"-state-active").not("."+n+"-state-disabled").addClass(n+"-state-hover")},function(){k.removeClass(n+"-state-hover").removeClass(n+"-state-down")}).appendTo(e),f||k.addClass(n+"-corner-left"),f=k)}}}),f&&f.addClass(n+"-corner-right")}),e}function g(a){m.find("h2").html(a)}function h(a){m.find("span.fc-button-"+a).addClass(n+"-state-active")}function i(a){m.find("span.fc-button-"+a).removeClass(n+"-state-active")}function j(a){m.find("span.fc-button-"+a).addClass(n+"-state-disabled")}function k(a){m.find("span.fc-button-"+a).removeClass(n+"-state-disabled")}var l=this;l.render=d,l.destroy=e,l.updateTitle=g,l.activateButton=h,l.deactivateButton=i,l.disableButton=j,l.enableButton=k;var m=a([]),n}function f(c,d){function e(a,b){return!D||a<D||b>E}function f(a,b){D=a,E=b,I=[];var c=++F,d=C.length;G=d;for(var e=0;e<d;e++)g(C[e],c)}function g(a,b){h(a,function(c){if(b==F){if(c){for(var d=0;d<c.length;d++)c[d].source=a,t(c[d]);I=I.concat(c)}G--,G||A(I)}})}function h(b,d){var e,f=bt.sourceFetchers,g;for(e=0;e<f.length;e++){g=f[e](b,D,E,d);if(g===!0)return;if(typeof g=="object"){h(g,d);return}}var i=b.events;if(i)a.isFunction(i)?(q(),i(m(D),m(E),function(a){d(a),s()})):a.isArray(i)?d(i):d();else{var j=b.url;if(j){var k=b.success,l=b.error,n=b.complete,o=a.extend({},b.data||{}),p=$(b.startParam,c.startParam),r=$(b.endParam,c.endParam);p&&(o[p]=Math.round(+D/1e3)),r&&(o[r]=Math.round(+E/1e3)),q(),a.ajax(a.extend({},bv,b,{data:o,success:function(b){b=b||[];var c=Z(k,this,arguments);a.isArray(c)&&(b=c),d(b)},error:function(){Z(l,this,arguments),d()},complete:function(){Z(n,this,arguments),s()}}))}else d()}}function i(a){a=j(a),a&&(G++,g(a,F))}function j(b){a.isFunction(b)||a.isArray(b)?b={events:b}:typeof b=="string"&&(b={url:b});if(typeof b=="object")return u(b),C.push(b),b}function k(b){C=a.grep(C,function(a){return!v(a,b)}),I=a.grep(I,function(a){return!v(a.source,b)}),A(I)}function l(a){var b,c=I.length,d,e=z().defaultEventEnd,f=a.start-a._start,g=a.end?a.end-(a._end||e(a)):0;for(b=0;b<c;b++)d=I[b],d._id==a._id&&d!=a&&(d.start=new Date(+d.start+f),a.end?d.end?d.end=new Date(+d.end+g):d.end=new Date(+e(d)+g):d.end=null,d.title=a.title,d.url=a.url,d.allDay=a.allDay,d.className=a.className,d.editable=a.editable,d.color=a.color,d.backgroudColor=a.backgroudColor,d.borderColor=a.borderColor,d.textColor=a.textColor,t(d));t(a),A(I)}function n(a,b){t(a),a.source||(b&&(B.events.push(a),a.source=B),I.push(a)),A(I)}function o(b){if(!b){I=[];for(var c=0;c<C.length;c++)a.isArray(C[c].events)&&(C[c].events=[])}else{if(!a.isFunction(b)){var d=b+"";b=function(a){return a._id==d}}I=a.grep(I,b,!0);for(var c=0;c<C.length;c++)a.isArray(C[c].events)&&(C[c].events=a.grep(C[c].events,b,!0))}A(I)}function p(b){return a.isFunction(b)?a.grep(I,b):b?(b+="",a.grep(I,function(a){return a._id==b})):I}function q(){H++||y("loading",null,!0)}function s(){--H||y("loading",null,!1)}function t(a){var d=a.source||{},e=$(d.ignoreTimezone,c.ignoreTimezone);a._id=a._id||(a.id===b?"_fc"+bw++:a.id+""),a.date&&(a.start||(a.start=a.date),delete a.date),a._start=m(a.start=r(a.start,e)),a.end=r(a.end,e),a.end&&a.end<=a.start&&(a.end=null),a._end=a.end?m(a.end):null,a.allDay===b&&(a.allDay=$(d.allDayDefault,c.allDayDefault)),a.className?typeof a.className=="string"&&(a.className=a.className.split(/\s+/)):a.className=[]}function u(a){a.className?typeof a.className=="string"&&(a.className=a.className.split(/\s+/)):a.className=[];var b=bt.sourceNormalizers;for(var c=0;c<b.length;c++)b[c](a)}function v(a,b){return a&&b&&w(a)==w(b)}function w(a){return(typeof a=="object"?a.events||a.url:"")||a}var x=this;x.isFetchNeeded=e,x.fetchEvents=f,x.addEventSource=i,x.removeEventSource=k,x.updateEvent=l,x.renderEvent=n,x.removeEvents=o,x.clientEvents=p,x.normalizeEvent=t;var y=x.trigger,z=x.getView,A=x.reportEvents,B={events:[]},C=[B],D,E,F=0,G=0,H=0,I=[];for(var J=0;J<d.length;J++)j(d[J])}function g(a,b,c){return a.setFullYear(a.getFullYear()+b),c||l(a),a}function h(a,b,c){if(+a){var d=a.getMonth()+b,e=m(a);e.setDate(1),e.setMonth(d),a.setMonth(d),c||l(a);while(a.getMonth()!=e.getMonth())a.setDate(a.getDate()+(a<e?1:-1))}return a}function i(a,b,c){if(+a){var d=a.getDate()+b,e=m(a);e.setHours(9),e.setDate(d),a.setDate(d),c||l(a),j(a,e)}return a}function j(a,b){if(+a)while(a.getDate()!=b.getDate())a.setTime(+a+(a<b?1:-1)*bz)}function k(a,b){return a.setMinutes(a.getMinutes()+b),a}function l(a){return a.setHours(0),a.setMinutes(0),a.setSeconds(0),a.setMilliseconds(0),a}function m(a,b){return b?l(new Date(+a)):new Date(+a)}function n(){var a=0,b;do b=new Date(1970,a++,1);while(b.getHours());return b}function o(a,b,c){b=b||1;while(!a.getDay()||c&&a.getDay()==1||!c&&a.getDay()==6)i(a,b);return a}function p(a,b){return Math.round((m(a,!0)-m(b,!0))/by)}function q(a,c,d,e){c!==b&&c!=a.getFullYear()&&(a.setDate(1),a.setMonth(0),a.setFullYear(c)),d!==b&&d!=a.getMonth()&&(a.setDate(1),a.setMonth(d)),e!==b&&a.setDate(e)}function r(a,c){return typeof a=="object"?a:typeof a=="number"?new Date(a*1e3):typeof a=="string"?a.match(/^\d+(\.\d+)?$/)?new Date(parseFloat(a)*1e3):(c===b&&(c=!0),s(a,c)||(a?new Date(a):null)):null}function s(a,b){var c=a.match(/^([0-9]{4})(-([0-9]{2})(-([0-9]{2})([T ]([0-9]{2}):([0-9]{2})(:([0-9]{2})(\.([0-9]+))?)?(Z|(([-+])([0-9]{2})(:?([0-9]{2}))?))?)?)?)?$/);if(!c)return null;var d=new Date(c[1],0,1);if(b||!c[13]){var e=new Date(c[1],0,1,9,0);c[3]&&(d.setMonth(c[3]-1),e.setMonth(c[3]-1)),c[5]&&(d.setDate(c[5]),e.setDate(c[5])),j(d,e),c[7]&&d.setHours(c[7]),c[8]&&d.setMinutes(c[8]),c[10]&&d.setSeconds(c[10]),c[12]&&d.setMilliseconds(Number("0."+c[12])*1e3),j(d,e)}else{d.setUTCFullYear(c[1],c[3]?c[3]-1:0,c[5]||1),d.setUTCHours(c[7]||0,c[8]||0,c[10]||0,c[12]?Number("0."+c[12])*1e3:0);if(c[14]){var f=Number(c[16])*60+(c[18]?Number(c[18]):0);f*=c[15]=="-"?1:-1,d=new Date(+d+f*60*1e3)}}return d}function t(a){if(typeof a=="number")return a*60;if(typeof a=="object")return a.getHours()*60+a.getMinutes();var b=a.match(/(\d+)(?::(\d+))?\s*(\w+)?/);if(b){var c=parseInt(b[1],10);return b[3]&&(c%=12,b[3].toLowerCase().charAt(0)=="p"&&(c+=12)),c*60+(b[2]?parseInt(b[2],10):0)}}function u(a,b,c){return v(a,null,b,c)}function v(a,b,c,d){d=d||br;var e=a,f=b,g,h=c.length,i,j,k,l="";for(g=0;g<h;g++){i=c.charAt(g);if(i=="'"){for(j=g+1;j<h;j++)if(c.charAt(j)=="'"){e&&(j==g+1?l+="'":l+=c.substring(g+1,j),g=j);break}}else if(i=="("){for(j=g+1;j<h;j++)if(c.charAt(j)==")"){var m=u(e,c.substring(g+1,j),d);parseInt(m.replace(/\D/,""),10)&&(l+=m),g=j;break}}else if(i=="["){for(j=g+1;j<h;j++)if(c.charAt(j)=="]"){var n=c.substring(g+1,j),m=u(e,n,d);m!=u(f,n,d)&&(l+=m),g=j;break}}else if(i=="{")e=b,f=a;else if(i=="}")e=a,f=b;else{for(j=h;j>g;j--)if(k=bB[c.substring(g,j)]){e&&(l+=k(e,d)),g=j-1;break}j==g&&e&&(l+=i)}}return l}function w(a){return a.end?x(a.end,a.allDay):i(m(a.start),1)}function x(a,b){return a=m(a),b||a.getHours()||a.getMinutes()?i(a,1):l(a)}function y(a,b){return(b.msLength-a.msLength)*100+(a.event.start-b.event.start)}function z(a,b){return a.end>b.start&&a.start<b.end}function A(a,b,c,d){var e=[],f,g=a.length,h,i,j,k,l,n,o;for(f=0;f<g;f++)h=a[f],i=h.start,j=b[f],j>c&&i<d&&(i<c?(k=m(c),n=!1):(k=i,n=!0),j>d?(l=m(d),o=!1):(l=j,o=!0),e.push({event:h,start:k,end:l,isStart:n,isEnd:o,msLength:l-k}));return e.sort(y)}function B(a){var b=[],c,d=a.length,e,f,g,h;for(c=0;c<d;c++){e=a[c],f=0;for(;;){g=!1;if(b[f])for(h=0;h<b[f].length;h++)if(z(b[f][h],e)){g=!0;break}if(g)f++;else break}b[f]?b[f].push(e):b[f]=[e]}return b}function C(c,d,e){c.unbind("mouseover").mouseover(function(c){var f=c.target,g,h,i;while(f!=this)g=f,f=f.parentNode;(h=g._fci)!==b&&(g._fci=b,i=d[h],e(i.event,i.element,i),a(c.target).trigger(c)),c.stopPropagation()})}function D(b,c,d){for(var e=0,f;e<b.length;e++)f=a(b[e]),f.width(Math.max(0,c-F(f,d)))}function E(b,c,d){for(var e=0,f;e<b.length;e++)f=a(b[e]),f.height(Math.max(0,c-J(f,d)))}function F(a,b){return G(a)+I(a)+(b?H(a):0)}function G(b){return(parseFloat(a.curCSS(b[0],"paddingLeft",!0))||0)+(parseFloat(a.curCSS(b[0],"paddingRight",!0))||0)}function H(b){return(parseFloat(a.curCSS(b[0],"marginLeft",!0))||0)+(parseFloat(a.curCSS(b[0],"marginRight",!0))||0)}function I(b){return(parseFloat(a.curCSS(b[0],"borderLeftWidth",!0))||0)+(parseFloat(a.curCSS(b[0],"borderRightWidth",!0))||0)}function J(a,b){return K(a)+M(a)+(b?L(a):0)}function K(b){return(parseFloat(a.curCSS(b[0],"paddingTop",!0))||0)+(parseFloat(a.curCSS(b[0],"paddingBottom",!0))||0)}function L(b){return(parseFloat(a.curCSS(b[0],"marginTop",!0))||0)+(parseFloat(a.curCSS(b[0],"marginBottom",!0))||0)}function M(b){return(parseFloat(a.curCSS(b[0],"borderTopWidth",!0))||0)+(parseFloat(a.curCSS(b[0],"borderBottomWidth",!0))||0)}function N(a,b){b=typeof b=="number"?b+"px":b,a.each(function(a,c){c.style.cssText+=";min-height:"+b+";_height:"+b})}function O(){}function P(a,b){return a-b}function Q(a){return Math.max.apply(Math,a)}function R(a){return(a<10?"0":"")+a}function S(a,c){if(a[c]!==b)return a[c];var d=c.split(/(?=[A-Z])/),e=d.length-1,f;for(;e>=0;e--){f=a[d[e].toLowerCase()];if(f!==b)return f}return a[""]}function T(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&#039;").replace(/"/g,"&quot;").replace(/\n/g,"<br />")}function U(a){return a.id+"/"+a.className+"/"+a.style.cssText.replace(/(^|;)\s*(top|left|width|height)\s*:[^;]*/ig,"")}function V(a){a.attr("unselectable","on").css("MozUserSelect","none").bind("selectstart.ui",function(){return!1})}function W(a){a.children().removeClass("fc-first fc-last").filter(":first-child").addClass("fc-first").end().filter(":last-child").addClass("fc-last")}function X(a,b){a.each(function(a,c){c.className=c.className.replace(/^fc-\w*/,"fc-"+bx[b.getDay()])})}function Y(a,b){var c=a.source||{},d=a.color,e=c.color,f=b("eventColor"),g=a.backgroundColor||d||c.backgroundColor||e||b("eventBackgroundColor")||f,h=a.borderColor||d||c.borderColor||e||b("eventBorderColor")||f,i=a.textColor||c.textColor||b("eventTextColor"),j=[];return g&&j.push("background-color:"+g),h&&j.push("border-color:"+h),i&&j.push("color:"+i),j.join(";")}function Z(b,c,d){a.isFunction(b)&&(b=[b]);if(b){var e,f;for(e=0;e<b.length;e++)f=b[e].apply(c,d)||f;return f}}function $(){for(var a=0;a<arguments.length;a++)if(arguments[a]!==b)return arguments[a]}function _(a,b){function c(a,b){b&&(h(a,b),a.setDate(1));var c=m(a,!0);c.setDate(1);var j=h(m(c),1),k=m(c),l=m(j),n=e("firstDay"),p=e("weekends")?0:1;p&&(o(k),o(l,-1,!0)),i(k,-((k.getDay()-Math.max(n,p)+7)%7)),i(l,(7-l.getDay()+Math.max(n,p))%7);var q=Math.round((l-k)/(by*7));e("weekMode")=="fixed"&&(i(l,(6-q)*7),q=6),d.title=g(c,e("titleFormat")),d.start=c,d.end=j,d.visStart=k,d.visEnd=l,f(6,q,p?5:7,!0)}var d=this;d.render=c,bc.call(d,a,b,"month");var e=d.opt,f=d.renderBasic,g=b.formatDate}function ba(a,b){function c(a,b){b&&i(a,b*7);var c=i(m(a),-((a.getDay()-e("firstDay")+7)%7)),h=i(m(c),7),j=m(c),k=m(h),l=e("weekends");l||(o(j),o(k,-1,!0)),d.title=g(j,i(m(k),-1),e("titleFormat")),d.start=c,d.end=h,d.visStart=j,d.visEnd=k,f(1,1,l?7:5,!1)}var d=this;d.render=c,bc.call(d,a,b,"basicWeek");var e=d.opt,f=d.renderBasic,g=b.formatDates}function bb(a,b){function c(a,b){b&&(i(a,b),e("weekends")||o(a,b<0?-1:1)),d.title=g(a,e("titleFormat")),d.start=d.visStart=m(a,!0),d.end=d.visEnd=i(m(d.start),1),f(1,1,1,!1)}var d=this;d.render=c,bc.call(d,a,b,"basicDay");var e=d.opt,f=d.renderBasic,g=b.formatDate}function bc(b,c,d){function e(a,b,c,d){bg=b,bh=c,f();var e=!Y;e?g(a,d):O(),h(e)}function f(){br=L("isRTL"),br?(bs=-1,bt=bh-1):(bs=1,bt=0),bu=L("firstDay"),bv=L("weekends")?0:1,bw=L("theme")?"ui":"fc",bx=L("columnFormat")}function g(c,d){var e,f=bw+"-widget-header",g=bw+"-widget-content",h,i,j;e="<table class='fc-border-separate' style='width:100%' cellspacing='0'><thead><tr>";for(h=0;h<bh;h++)e+="<th class='fc- "+f+"'/>";e+="</tr></thead><tbody>";for(h=0;h<c;h++){e+="<tr class='fc-week"+h+"'>";for(i=0;i<bh;i++)e+="<td class='fc- "+g+" fc-day"+(h*bh+i)+"'>"+"<div>"+(d?"<div class='fc-day-number'/>":"")+"<div class='fc-day-content'>"+"<div style='position:relative'>&nbsp;</div>"+"</div>"+"</div>"+"</td>";e+="</tr>"}e+="</tbody></table>",j=a(e).appendTo(b),T=j.find("thead"),U=T.find("th"),Y=j.find("tbody"),Z=Y.find("tr"),$=Y.find("td"),_=$.filter(":first-child"),ba=Z.eq(0).find("div.fc-day-content div"),W(T.add(T.find("tr"))),W(Z),Z.eq(0).addClass("fc-first"),n($),bb=a("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(b)}function h(b){var c=b||bg==1,d=K.start.getMonth(),e=l(new Date),f,g,h;c&&U.each(function(b,c){f=a(c),g=F(b),f.html(S(g,bx)),X(f,g)}),$.each(function(b,h){f=a(h),g=F(b),g.getMonth()==d?f.removeClass("fc-other-month"):f.addClass("fc-other-month"),+g==+e?f.addClass(bw+"-state-highlight fc-today"):f.removeClass(bw+"-state-highlight fc-today"),f.find("div.fc-day-number").text(g.getDate()),c&&X(f,g)}),Z.each(function(b,c){h=a(c),b<bg?(h.show(),b==bg-1?h.addClass("fc-last"):h.removeClass("fc-last")):h.hide()})}function j(b){be=b;var c=be-T.height(),d,e,f;L("weekMode")=="variable"?d=e=Math.floor(c/(bg==1?2:6)):(d=Math.floor(c/bg),e=c-d*(bg-1)),_.each(function(b,c){b<bg&&(f=a(c),N(f.find("> div"),(b==bg-1?e:d)-J(f)))})}function k(a){bc=a,bp.clear(),bf=Math.floor(bc/bh),D(U.slice(0,-1),bf)}function n(a){a.click(o).mousedown(R)}function o(a){if(!L("selectable")){var b=parseInt(this.className.match(/fc\-day(\d+)/)[1]),c=F(b);M("dayClick",this,c,!0,a)}}function q(a,b,c){c&&bi.build();var d=m(K.visStart),e=i(m(d),bh);for(var f=0;f<bg;f++){var g=new Date(Math.max(d,a)),h=new Date(Math.min(e,b));if(g<h){var j,k;br?(j=p(h,d)*bs+bt+1,k=p(g,d)*bs+bt+1):(j=p(g,d),k=p(h,d)),n(r(f,j,f,k-1))}i(d,7),i(e,7)}}function r(a,c,d,e){var f=bi.rect(a,c,d,e,b);return P(f,b)}function s(a,b){return m(a)}function t(a,b,c){q(a,i(m(b),1),!0)}function u(){Q()}function v(a,b,c){var d=B(a),e=$[d.row*bh+d.col];M("dayClick",e,a,b,c)}function w(a,b,c){bk.start(function(a){Q(),a&&r(a.row,a.col,a.row,a.col)},b)}function x(a,b,c){var d=bk.stop();Q();if(d){var e=C(d);M("drop",a,e,!0,b,c)}}function y(a){return m(a.start)}function z(a){return bp.left(a)}function A(a){return bp.right(a)}function B(a){return{row:Math.floor(p(a,K.visStart)/7),col:G(a.getDay())}}function C(a){return E(a.row,a.col)}function E(a,b){return i(m(K.visStart),a*7+b*bs+bt)}function F(a){return E(Math.floor(a/bh),a%bh)}function G(a){return(a-Math.max(bu,bv)+bh)%bh*bs+bt}function H(a){return Z.eq(a)}function I(a){return{left:0,right:bc}}var K=this;K.renderBasic=e,K.setHeight=j,K.setWidth=k,K.renderDayOverlay=q,K.defaultSelectionEnd=s,K.renderSelection=t,K.clearSelection=u,K.reportDayClick=v,K.dragStart=w,K.dragStop=x,K.defaultEventEnd=y,K.getHoverListener=function(){return bk},K.colContentLeft=z,K.colContentRight=A,K.dayOfWeekCol=G,K.dateCell=B,K.cellDate=C,K.cellIsAllDay=function(){return!0},K.allDayRow=H,K.allDayBounds=I,K.getRowCnt=function(){return bg},K.getColCnt=function(){return bh},K.getColWidth=function(){return bf},K.getDaySegmentContainer=function(){return bb},bj.call(K,b,c,d),bm.call(K),bl.call(K),bd.call(K);var L=K.opt,M=K.trigger,O=K.clearEvents,P=K.renderOverlay,Q=K.clearOverlays,R=K.daySelectionMousedown,S=c.formatDate,T,U,Y,Z,$,_,ba,bb,bc,be,bf,bg,bh,bi,bk,bp,br,bs,bt,bu,bv,bw,bx;V(b.addClass("fc-grid")),bi=new bn(function(b,c){var d,e,f;U.each(function(b,g){d=a(g),e=d.offset().left,b&&(f[1]=e),f=[e],c[b]=f}),f[1]=e+d.outerWidth(),Z.each(function(c,g){c<bg&&(d=a(g),e=d.offset().top,c&&(f[1]=e),f=[e],b[c]=f)}),f[1]=e+d.outerHeight()}),bk=new bo(bi),bp=new bq(function(a){return ba.eq(a)})}function bd(){function b(a,b){n(a),C(d(a),b)}function c(){o(),t().empty()}function d(b){var c=y(),d=z(),e=m(g.visStart),f=i(m(e),d),h=a.map(b,w),j,k,l,n,o,p,q=[];for(j=0;j<c;j++){k=B(A(b,h,e,f));for(l=0;l<k.length;l++){n=k[l];for(o=0;o<n.length;o++)p=n[o],p.row=j,p.level=l,q.push(p)}i(e,7),i(f,7)}return q}function e(a,b,c){k(a)&&f(a,b),c.isEnd&&l(a)&&D(a,b,c),p(a,b)}function f(a,b){var c=u(),d;b.draggable({zIndex:9,delay:50,opacity:h("dragOpacity"),revertDuration:h("dragRevertDuration"),start:function(e,f){j("eventDragStart",b,a,e,f),r(a,b),c.start(function(c,e,f,g){b.draggable("option","revert",!c||!f&&!g),x(),c?(d=f*7+g*(h("isRTL")?-1:1),v(i(m(a.start),d),i(w(a),d))):d=0},e,"drag")},stop:function(e,f){c.stop(),x(),j("eventDragStop",b,a,e,f),d?s(this,a,d,0,a.allDay,e,f):(b.css("filter",""),q(a,b))}})}var g=this;g.renderEvents=b,g.compileDaySegs=d,g.clearEvents=c,g.bindDaySeg=e,bk.call(g);var h=g.opt,j=g.trigger,k=g.isEventDraggable,l=g.isEventResizable,n=g.reportEvents,o=g.reportEventClear,p=g.eventElementHandlers,q=g.showEvents,r=g.hideEvents,s=g.eventDrop,t=g.getDaySegmentContainer,u=g.getHoverListener,v=g.renderDayOverlay,x=g.clearOverlays,y=g.getRowCnt,z=g.getColCnt,C=g.renderDaySegs,D=g.resizableDayEvent}function be(a,b){function c(a,b){b&&i(a,b*7);var c=i(m(a),-((a.getDay()-e("firstDay")+7)%7)),h=i(m(c),7),j=m(c),k=m(h),l=e("weekends");l||(o(j),o(k,-1,!0)),d.title=g(j,i(m(k),-1),e("titleFormat")),d.start=c,d.end=h,d.visStart=j,d.visEnd=k,f(l?7:5)}var d=this;d.render=c,bg.call(d,a,b,"agendaWeek");var e=d.opt,f=d.renderAgenda,g=b.formatDates}function bf(a,b){function c(a,b){b&&(i(a,b),e("weekends")||o(a,b<0?-1:1));var c=m(a,!0),h=i(m(c),1);d.title=g(a,e("titleFormat")),d.start=d.visStart=c,d.end=d.visEnd=h,f(1)}var d=this;d.render=c,bg.call(d,a,b,"agendaDay");var e=d.opt,f=d.renderAgenda,g=b.formatDate}function bg(c,d,e){function f(a){bS=a,g(),br?bc():h(),j()}function g(){bY=ba("theme")?"ui":"fc",b$=ba("weekends")?0:1,bZ=ba("firstDay"),(b_=ba("isRTL"))?(ca=-1,cb=bS-1):(ca=1,cb=0),cc=t(ba("minTime")),cd=t(ba("maxTime")),ce=ba("columnFormat")}function h(){var b=bY+"-widget-header",d=bY+"-widget-content",e,f,g,h,i,j=ba("slotMinutes")%15==0;e="<table style='width:100%' class='fc-agenda-days fc-border-separate' cellspacing='0'><thead><tr><th class='fc-agenda-axis "+b+"'>&nbsp;</th>";for(f=0;f<bS;f++)e+="<th class='fc- fc-col"+f+" "+b+"'/>";e+="<th class='fc-agenda-gutter "+b+"'>&nbsp;</th>"+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+"<th class='fc-agenda-axis "+b+"'>&nbsp;</th>";for(f=0;f<bS;f++)e+="<td class='fc- fc-col"+f+" "+d+"'>"+"<div>"+"<div class='fc-day-content'>"+"<div style='position:relative'>&nbsp;</div>"+"</div>"+"</div>"+"</td>";e+="<td class='fc-agenda-gutter "+d+"'>&nbsp;</td>"+"</tr>"+"</tbody>"+"</table>",br=a(e).appendTo(c),bs=br.find("thead"),bt=bs.find("th").slice(1,-1),bu=br.find("tbody"),bv=bu.find("td").slice(0,-1),bw=bv.find("div.fc-day-content div"),bx=bv.eq(0),by=bx.find("> div"),W(bs.add(bs.find("tr"))),W(bu.add(bu.find("tr"))),bI=bs.find("th:first"),bJ=br.find(".fc-agenda-gutter"),bz=a("<div style='position:absolute;z-index:2;left:0;width:100%'/>").appendTo(c),ba("allDaySlot")?(bA=a("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(bz),e="<table style='width:100%' class='fc-agenda-allday' cellspacing='0'><tr><th class='"+b+" fc-agenda-axis'>"+ba("allDayText")+"</th>"+"<td>"+"<div class='fc-day-content'><div style='position:relative'/></div>"+"</td>"+"<th class='"+b+" fc-agenda-gutter'>&nbsp;</th>"+"</tr>"+"</table>",bB=a(e).appendTo(bz),bC=bB.find("tr"),v(bC.find("td")),bI=bI.add(bB.find("th:first")),bJ=bJ.add(bB.find("th.fc-agenda-gutter")),bz.append("<div class='fc-agenda-divider "+b+"'>"+"<div class='fc-agenda-divider-inner'/>"+"</div>")):bA=a([]),bD=a("<div style='position:absolute;width:100%;overflow-x:hidden;overflow-y:auto'/>").appendTo(bz),bE=a("<div style='position:relative;width:100%;overflow:hidden'/>").appendTo(bD),bF=a("<div style='position:absolute;z-index:8;top:0;left:0'/>").appendTo(bE),e="<table class='fc-agenda-slots' style='width:100%' cellspacing='0'><tbody>",g=n(),h=k(m(g),cd),k(g,cc),bT=0;for(f=0;g<h;f++)i=g.getMinutes(),e+="<tr class='fc-slot"+f+" "+(i?"fc-minor":"")+"'>"+"<th class='fc-agenda-axis "+b+"'>"+(!j||!i?bp(g,ba("axisFormat")):"&nbsp;")+"</th>"+"<td class='"+d+"'>"+"<div style='position:relative'>&nbsp;</div>"+"</td>"+"</tr>",k(g,ba("slotMinutes")),bT++;e+="</tbody></table>",bG=a(e).appendTo(bE),bH=bG.find("div:first"),w(bG.find("td")),bI=bI.add(bG.find("th:first"))}function j(){var a,b,c,d,e=l(new Date);for(a=0;a<bS;a++)d=H(a),b=bt.eq(a),b.html(bp(d,ce)),c=bv.eq(a),+d==+e?c.addClass(bY+"-state-highlight fc-today"):c.removeClass(bY+"-state-highlight fc-today"),X(b.add(c),d)}function o(a,c){a===b&&(a=bM),bM=a,bX={};var d=bu.position().top,e=bD.position().top,f=Math.min(a-d,bG.height()+e+1);by.height(f-J(bx)),bz.css("top",d),bD.height(f-e-1),bQ=bH.height()+1,c&&r()}function q(b){bL=b,bW.clear(),bN=0,D(bI.width("").each(function(b,c){bN=Math.max(bN,a(c).outerWidth())}),bN);var c=bD[0].clientWidth;bP=bD.width()-c,bP?(D(bJ,bP),bJ.show().prev().removeClass("fc-last")):bJ.hide().prev().addClass("fc-last"),bO=Math.floor((c-bN)/bS),D(bt.slice(0,-1),bO)}function r(){function a(){bD.scrollTop(d)}var b=n(),c=m(b);c.setHours(ba("firstHour"));var d=L(b,c)+1;a(),setTimeout(a,0)}function s(){bR=bD.scrollTop()}function u(){bD.scrollTop(bR)}function v(a){a.click(x).mousedown(bi)}function w(a){a.click(x).mousedown(U)}function x(a){if(!ba("selectable")){var b=Math.min(bS-1,Math.floor((a.pageX-br.offset().left-bN)/bO)),c=H(b),d=this.parentNode.className.match(/fc-slot(\d+)/);if(d){var e=parseInt(d[1])*ba("slotMinutes"),f=Math.floor(e/60);c.setHours(f),c.setMinutes(e%60+cc),bb("dayClick",bv[b],c,!1,a)}else bb("dayClick",bv[b],c,!0,a)}}function y(a,b,c){c&&bU.build();var d=m(_.visStart),e,f;b_?(e=p(b,d)*ca+cb+1,f=p(a,d)*ca+cb+1):(e=p(a,d),f=p(b,d)),e=Math.max(0,e),f=Math.min(bS,f),e<f&&v(z(0,e,0,f-1))}function z(a,b,c,d){var e=bU.rect(a,b,c,d,bz);return bd(e,bz)}function A(a,b){var c=m(_.visStart),d=i(m(c),1);for(var e=0;e<bS;e++){var f=new Date(Math.max(c,a)),g=new Date(Math.min(d,b));if(f<g){var h=e*ca+cb,j=bU.rect(0,h,0,h,bE),k=L(c,f),l=L(c,g);j.top=k,j.height=l-k,w(bd(j,bE))}i(c,1),i(d,1)}}function B(a){return bW.left(a)}function C(a){return bW.right(a)}function F(a){return{row:Math.floor(p(a,_.visStart)/7),col:K(a.getDay())}}function G(a){var b=H(a.col),c=a.row;return ba("allDaySlot")&&c--,c>=0&&k(b,cc+c*ba("slotMinutes")),b}function H(a){return i(m(_.visStart),a*ca+cb)}function I(a){return ba("allDaySlot")&&!a.row}function K(a){return(a-Math.max(bZ,b$)+bS)%bS*ca+cb}function L(a,c){a=m(a,!0);if(c<k(m(a),cc))return 0;if(c<k(m(a),cd)){var d=ba("slotMinutes"),e=c.getHours()*60+c.getMinutes()-cc,f=Math.floor(e/d),g=bX[f];return g===b&&(g=bX[f]=bG.find("tr:eq("+f+") td div")[0].offsetTop),Math.max(0,Math.round(g-1+bQ*(e%d/d)))}return bG.height()}function M(){return{left:bN,right:bL-bP}}function N(a){return bC}function O(a){var b=m(a.start);return a.allDay?b:k(b,ba("defaultEventMinutes"))}function Q(a,b){return b?m(a):k(m(a),ba("slotMinutes"))}function R(a,b,c){c?ba("allDaySlot")&&y(a,i(m(b),1),!0):S(a,b)}function S(b,c){var d=ba("selectHelper");bU.build();if(d){var e=p(b,_.visStart)*ca+cb;if(e>=0&&e<bS){var f=bU.rect(0,e,0,e,bE),g=L(b,b),h=L(b,c);if(h>g){f.top=g,f.height=h-g,f.left+=2,f.width-=5;if(a.isFunction(d)){var i=d(b,c);i&&(f.position="absolute",f.zIndex=8,bK=a(i).css(f).appendTo(bE))}else f.isStart=!0,f.isEnd=!0,bK=a(bk({title:"",start:b,end:c,className:["fc-select-helper"],editable:!1},f)),bK.css("opacity",ba("dragOpacity"));bK&&(w(bK),bE.append(bK),D(bK,f.width,!0),E(bK,f.height,!0))}}}else A(b,c)}function T(){be(),bK&&(bK.remove(),bK=null)}function U(b){if(b.which==1&&ba("selectable")){bg(b);var c;bV.start(function(a,b){T();if(a&&a.col==b.col&&!I(a)){var d=G(b),e=G(a);c=[d,k(m(d),ba("slotMinutes")),e,k(m(e),ba("slotMinutes"))].sort(P),S(c[0],c[3])}else c=null},b),a(document).one("mouseup",function(a){bV.stop(),c&&(+c[0]==+c[1]&&Y(c[0],!1,a),bf(c[0],c[3],!1,a))})}}function Y(a,b,c){bb("dayClick",bv[K(a.getDay())],a,b,c)}function Z(a,b,c){bV.start(function(a){be();if(a)if(I(a))z(a.row,a.col,a.row,a.col);else{var b=G(a),c=k(m(b),ba("defaultEventMinutes"));A(b,c)}},b)}function $(a,b,c){var d=bV.stop();be(),d&&bb("drop",a,G(d),I(d),b,c)}var _=this;_.renderAgenda=f,_.setWidth=q,_.setHeight=o,_.beforeHide=s,_.afterShow=u,_.defaultEventEnd=O,_.timePosition=L,_.dayOfWeekCol=K,_.dateCell=F,_.cellDate=G,_.cellIsAllDay=I,_.allDayRow=N,_.allDayBounds=M,_.getHoverListener=function(){return bV},_.colContentLeft=B,_.colContentRight=C,_.getDaySegmentContainer=function(){return bA},_.getSlotSegmentContainer=function(){return bF},_.getMinMinute=function(){return cc},_.getMaxMinute=function(){return cd},_.getBodyContent=function(){return bE},_.getRowCnt=function(){return 1},_.getColCnt=function(){return bS},_.getColWidth=function(){return bO},_.getSlotHeight=function(){return bQ},_.defaultSelectionEnd=Q,_.renderDayOverlay=y,_.renderSelection=R,_.clearSelection=T,_.reportDayClick=Y,_.dragStart=Z,_.dragStop=$,bj.call(_,c,d,e),bm.call(_),bl.call(_),bh.call(_);var ba=_.opt,bb=_.trigger,bc=_.clearEvents,bd=_.renderOverlay,be=_.clearOverlays,bf=_.reportSelection,bg=_.unselect,bi=_.daySelectionMousedown,bk=_.slotSegHtml,bp=d.formatDate,br,bs,bt,bu,bv,bw,bx,by,bz,bA,bB,bC,bD,bE,bF,bG,bH,bI,bJ,bK,bL,bM,bN,bO,bP,bQ,bR,bS,bT,bU,bV,bW,bX={},bY,bZ,b$,b_,ca,cb,cc,cd,ce;V(c.addClass("fc-agenda")),bU=new bn(function(b,c){function d(a){return Math.max(i,Math.min(j,a))}var e,f,g;bt.each(function(b,d){e=a(d),f=e.offset().left,b&&(g[1]=f),g=[f],c[b]=g}),g[1]=f+e.outerWidth(),ba("allDaySlot")&&(e=bC,f=e.offset().top,b[0]=[f,f+e.outerHeight()]);var h=bE.offset().top,i=bD.offset().top,j=i+bD.outerHeight();for(var k=0;k<bT;k++)b.push([d(h+bQ*k),d(h+bQ*(k+1))])}),bV=new bo(bU),bW=new bq(function(a){return bw.eq(a)})}function bh(){function c(a,b){y(a);var c,d=a.length,g=[],i=[];for(c=0;c<d;c++)a[c].allDay?g.push(a[c]):i.push(a[c]);s("allDaySlot")&&(Q(e(g),b),G()),h(f(i),b)}function d(){z(),H().empty(),I().empty()}function e(b){var c=B(A(b,a.map(b,w),r.visStart,r.visEnd)),d,e=c.length,f,g,h,i=[];for(d=0;d<e;d++){f=c[d];for(g=0;g<f.length;g++)h=f[g],h.row=0,h.level=d,i.push(h)}return i}function f(b){var c=S(),d=M(),e=L(),f=k(m(r.visStart),d),h=a.map(b,g),j,l,n,o,p,q,s=[];for(j=0;j<c;j++){l=B(A(b,h,f,k(m(f),e-d))),bi(l);for(n=0;n<l.length;n++){o=l[n];for(p=0;p<o.length;p++)q=o[p],q.col=j,q.level=n,s.push(q)}i(f,1,!0)}return s}function g(a){return a.end?m(a.end):k(m(a.start),s("defaultEventMinutes"))}function h(c,d){var e,f=c.length,g,h,i,k,l,m,o,p,q,r,u,v,w="",x,y,z,A={},B={},D,E,G,H,K=I(),L,M,Q,R=S();(L=s("isRTL"))?(M=-1,Q=R-1):(M=1,Q=0);for(e=0;e<f;e++)g=c[e],h=g.event,k=N(g.start,g.start),l=N(g.start,g.end),m=g.col,o=g.level,p=g.forward||0,q=O(m*M+Q),r=P(m*M+Q)-q,r=Math.min(r-6,r*.95),o?u=r/(o+p+1):p?u=(r/(p+1)-6)*2:u=r,v=q+r/(o+p+1)*o*M+(L?r-u:0),g.top=k,g.left=v,g.outerWidth=u,g.outerHeight=l-k,w+=j(h,g);K[0].innerHTML=w,x=K.children();for(e=0;e<f;e++)g=c[e],h=g.event,y=a(x[e]),z=t("eventRender",h,h,y),z===!1?y.remove():(z&&z!==!0&&(y.remove(),y=a(z).css({position:"absolute",top:g.top,left:g.left}).appendTo(K)),g.element=y,h._id===d?n(h,y,g):y[0]._fci=e,Z(h,y));C(K,c,n);for(e=0;e<f;e++){g=c[e];if(y=g.element)E=A[D=g.key=U(y[0])],g.vsides=E===b?A[D]=J(y,!0):E,E=B[D],g.hsides=E===b?B[D]=F(y,!0):E,G=y.find("div.fc-event-content"),G.length&&(g.contentTop=G[0].offsetTop)}for(e=0;e<f;e++){g=c[e];if(y=g.element)y[0].style.width=Math.max(0,g.outerWidth-g.hsides)+"px",H=Math.max(0,g.outerHeight-g.vsides),y[0].style.height=H+"px",h=g.event,g.contentTop!==b&&H-g.contentTop<10&&(y.find("div.fc-event-time").text(bf(h.start,s("timeFormat"))+" - "+h.title),y.find("div.fc-event-title").remove()),t("eventAfterRender",h,h,y)}}function j(a,b){var c="<",d=a.url,e=Y(a,s),f=e?" style='"+e+"'":"",g=["fc-event","fc-event-skin","fc-event-vert"];return u(a)&&g.push("fc-event-draggable"),b.isStart&&g.push("fc-corner-top"),b.isEnd&&g.push("fc-corner-bottom"),g=g.concat(a.className),a.source&&(g=g.concat(a.source.className||[])),d?c+="a href='"+T(a.url)+"'":c+="div",c+=" class='"+g.join(" ")+"'"+" style='position:absolute;z-index:8;top:"+b.top+"px;left:"+b.left+"px;"+e+"'"+">"+"<div class='fc-event-inner fc-event-skin'"+f+">"+"<div class='fc-event-head fc-event-skin'"+f+">"+"<div class='fc-event-time'>"+T(bg(a.start,a.end,s("timeFormat")))+"</div>"+"</div>"+"<div class='fc-event-content'>"+"<div class='fc-event-title'>"+T(a.title)+"</div>"+"</div>"+"<div class='fc-event-bg'></div>"+"</div>",b.isEnd&&v(a)&&(c+="<div class='ui-resizable-handle ui-resizable-s'>=</div>"),c+="</"+(d?"a":"div")+">",c}function l(a,b,c){u(a)&&o(a,b,c.isStart),c.isEnd&&v(a)&&R(a,b,c),D(a,b)}function n(a,b,c){var d=b.find("div.fc-event-time");u(a)&&p(a,b,d),c.isEnd&&v(a)&&q(a,b,d),D(a,b)}function o(a,b,c){function d(){g||(b.width(e).height("").draggable("option","grid",null),g=!0)}var e,f,g=!0,h,j=s("isRTL")?-1:1,k=K(),l=V(),n=W(),o=M();b.draggable({zIndex:9,opacity:s("dragOpacity","month"),revertDuration:s("dragRevertDuration"),start:function(o,p){t("eventDragStart",b,a,o,p),_(a,b),e=b.width(),k.start(function(e,k,o,p){bd(),e?(f=!1,h=p*j,e.row?c?g&&(b.width(l-10),E(b,n*Math.round((a.end?(a.end-a.start)/bA:s("defaultEventMinutes"))/s("slotMinutes"))),b.draggable("option","grid",[l,1]),g=!1):f=!0:(bc(i(m(a.start),h),i(w(a),h)),d()),f=f||g&&!h):(d(),f=!0),b.draggable("option","revert",f)},o,"drag")},stop:function(c,e){k.stop(),bd(),t("eventDragStop",b,a,c,e);if(f)d(),b.css("filter",""),$(a,b);else{var i=0;g||(i=Math.round((b.offset().top-X().offset().top)/n)*s("slotMinutes")+o-(a.start.getHours()*60+a.start.getMinutes())),ba(this,a,h,i,g,c,e)}}})}function p(a,b,c){function d(b){var d=k(m(a.start),b),e;a.end&&(e=k(m(a.end),b)),c.text(bg(d,e,s("timeFormat")))}function e(){g&&(c.css("display",""),b.draggable("option","grid",[q,r]),g=!1)}var f,g=!1,h,j,l,n=s("isRTL")?-1:1,o=K(),p=S(),q=V(),r=W();b.draggable({zIndex:9,scroll:!1,grid:[q,r],axis:p==1?"y":!1,opacity:s("dragOpacity"),revertDuration:s("dragRevertDuration"),start:function(d,k){t("eventDragStart",b,a,d,k),_(a,b),f=b.position(),j=l=0,o.start(function(d,f,j,k){b.draggable("option","revert",!d),bd(),d&&(h=k*n,s("allDaySlot")&&!d.row?(g||(g=!0,c.hide(),b.draggable("option","grid",null)),bc(i(m(a.start),h),i(w(a),h))):e())},d,"drag")},drag:function(a,b){j=Math.round((b.position.top-f.top)/r)*s("slotMinutes"),j!=l&&(g||d(j),l=j)},stop:function(c,i){var k=o.stop();bd(),t("eventDragStop",b,a,c,i),k&&(h||j||g)?ba(this,a,h,g?0:j,g,c,i):(e(),b.css("filter",""),b.css(f),d(0),$(a,b))}})}function q(a,b,c){var d,e,f=W();b.resizable({handles:{s:"div.ui-resizable-s"},grid:f,start:function(c,f){d=e=0,_(a,b),b.css("z-index",9),t("eventResizeStart",this,a,c,f)},resize:function(g,h){d=Math.round((Math.max(f,b.height())-h.originalSize.height)/f),d!=e&&(c.text(bg(a.start,!d&&!a.end?null:k(x(a),s("slotMinutes")*d),s("timeFormat"))),e=d)},stop:function(c,e){t("eventResizeStop",this,a,c,e),d?bb(this,a,0,s("slotMinutes")*d,c,e):(b.css("z-index",8),$(a,b))}})}var r=this;r.renderEvents=c,r.compileDaySegs=e,r.clearEvents=d,r.slotSegHtml=j,r.bindDaySeg=l,bk.call(r);var s=r.opt,t=r.trigger,u=r.isEventDraggable,v=r.isEventResizable,x=r.eventEnd,y=r.reportEvents,z=r.reportEventClear,D=r.eventElementHandlers,G=r.setHeight,H=r.getDaySegmentContainer,I=r.getSlotSegmentContainer,K=r.getHoverListener,L=r.getMaxMinute,M=r.getMinMinute,N=r.timePosition,O=r.colContentLeft,P=r.colContentRight,Q=r.renderDaySegs,R=r.resizableDayEvent,S=r.getColCnt,V=r.getColWidth,W=r.getSlotHeight,X=r.getBodyContent,Z=r.reportEventElement,$=r.showEvents,_=r.hideEvents,ba=r.eventDrop,bb=r.eventResize,bc=r.renderDayOverlay,bd=r.clearOverlays,be=r.calendar,bf=be.formatDate,bg=be.formatDates}function bi(a){var b,c,d,e,f,g;for(b=a.length-1;b>0;b--){e=a[b];for(c=0;c<e.length;c++){f=e[c];for(d=0;d<a[b-1].length;d++)g=a[b-1][d],z(f,g)&&(g.forward=Math.max(g.forward||0,(f.forward||0)+1))}}}function bj(a,c,d){function e(a,b){var c=F[a];return typeof c=="object"?S(c,b||d):c}function f(a,b){return c.trigger.apply(c,[a,b||y].concat(Array.prototype.slice.call(arguments,2),[y]))}function g(a){return j(a)&&!e("disableDragging")}function h(a){return j(a)&&!e("disableResizing")}function j(a){return $(a.editable,(a.source||{}).editable,e("editable"))}function l(a){C={};var b,c=a.length,d;for(b=0;b<c;b++)d=a[b],C[d._id]?C[d._id].push(d):C[d._id]=[d]}function n(a){return a.end?m(a.end):z(a)}function o(a,b){D.push(b),E[a._id]?E[a._id].push(b):E[a._id]=[b]}function p(){D=[],E={}}function q(a,b){b.click(function(c){if(!b.hasClass("ui-draggable-dragging")&&!b.hasClass("ui-resizable-resizing"))return f("eventClick",this,a,c)}).hover(function(b){f("eventMouseover",this,a,b)},function(b){f("eventMouseout",this,a,b)})}function r(a,b){t(a,b,"show")}function s(a,b){t(a,b,"hide")}function t(a,b,c){var d=E[a._id],e,f=d.length;for(e=0;e<f;e++)(!b||d[e][0]!=b[0])&&d[e][c]()}function u(a,b,c,d,e,g,h){var i=b.allDay,j=b._id;w(C[j],c,d,e),f("eventDrop",a,b,c,d,e,function(){w(C[j],-c,-d,i),B(j)},g,h),B(j)}function v(a,b,c,d,e,g){var h=b._id;x(C[h],c,d),f("eventResize",a,b,c,d,function(){x(C[h],-c,-d),B(h)},e,g),B(h)}function w(a,c,d,e){d=d||0;for(var f,g=a.length,h=0;h<g;h++)f=a[h],e!==b&&(f.allDay=e),k(i(f.start,c,!0),d),f.end&&(f.end=k(i(f.end,c,!0),d)),A(f,F)}function x(a,b,c){c=c||0;for(var d,e=a.length,f=0;f<e;f++)d=a[f],d.end=k(i(n(d),b,!0),c),A(d,F)}var y=this;y.element=a,y.calendar=c,y.name=d,y.opt=e,y.trigger=f,y.isEventDraggable=g,y.isEventResizable=h,y.reportEvents=l,y.eventEnd=n,y.reportEventElement=o,y.reportEventClear=p,y.eventElementHandlers=q,y.showEvents=r,y.hideEvents=s,y.eventDrop=u,y.eventResize=v;var z=y.defaultEventEnd,A=c.normalizeEvent,B=c.reportEventChange,C={},D=[],E={},F=c.options}function bk(){function c(a,b){var c=O(),d,i=B(),m=D(),q=0,r,s,t,u,v=a.length,w,x,y;c[0].innerHTML=e(a),f(a,c.children()),g(a),h(a,c,b),j(a),k(a),l(a),d=n();for(r=0;r<i;r++){s=0,t=[];for(u=0;u<m;u++)t[u]=0;while(q<v&&(w=a[q]).row==r){x=Q(t.slice(w.startCol,w.endCol)),w.top=x,x+=w.outerHeight;for(y=w.startCol;y<w.endCol;y++)t[y]=x;q++}d[r].height(Q(t))}p(a,o(d))}function d(b,c,d){var g=a("<div/>"),h,i=O(),m,q=b.length,r;g[0].innerHTML=e(b),h=g.children(),i.append(h),f(b,h),j(b),k(b),l(b),p(b,o(n())),h=[];for(m=0;m<q;m++)r=b[m].element,r&&(b[m].row===c&&r.css("top",d),h.push(r[0]));return a(h)}function e(a){var b=s("isRTL"),c,d=a.length,e,f,g,h,i=H(),j=i.left,k=i.right,l,m,n,o,p,q="";for(c=0;c<d;c++)e=a[c],f=e.event,h=["fc-event","fc-event-skin","fc-event-hori"],u(f)&&h.push("fc-event-draggable"),b?(e.isStart&&h.push("fc-corner-right"),e.isEnd&&h.push("fc-corner-left"),l=K(e.end.getDay()-1),m=K(e.start.getDay()),n=e.isEnd?I(l):j,o=e.isStart?J(m):k):(e.isStart&&h.push("fc-corner-left"),e.isEnd&&h.push("fc-corner-right"),l=K(e.start.getDay()),m=K(e.end.getDay()-1),n=e.isStart?I(l):j,o=e.isEnd?J(m):k),h=h.concat(f.className),f.source&&(h=h.concat(f.source.className||[])),g=f.url,p=Y(f,s),g?q+="<a href='"+T(g)+"'":q+="<div",q+=" class='"+h.join(" ")+"'"+" style='position:absolute;z-index:8;left:"+n+"px;"+p+"'"+">"+"<div"+" class='fc-event-inner fc-event-skin'"+(p?" style='"+p+"'":"")+">",!f.allDay&&e.isStart&&(q+="<span class='fc-event-time'>"+T(R(f.start,f.end,s("timeFormat")))+"</span>"),q+="<span class='fc-event-title'>"+T(f.title)+"</span>"+"</div>",e.isEnd&&v(f)&&(q+="<div class='ui-resizable-handle ui-resizable-"+(b?"w":"e")+"'>"+"&nbsp;&nbsp;&nbsp;"+"</div>"),q+="</"+(g?"a":"div")+">",e.left=n,e.outerWidth=o-n,e.startCol=l,e.endCol=m+1;return q}function f(b,c){var d,e=b.length,f,g,h,i;for(d=0;d<e;d++)f=b[d],g=f.event,h=a(c[d]),i=t("eventRender",g,g,h),i===!1?h.remove():(i&&i!==!0&&(i=a(i).css({position:"absolute",left:f.left}),h.replaceWith(i),h=i),f.element=h)}function g(a){var b,c=a.length,d,e;for(b=0;b<c;b++)d=a[b],e=d.element,e&&x(d.event,e)}function h(a,b,c){var d,e=a.length,f,g,h;for(d=0;d<e;d++)f=a[d],g=f.element,g&&(h=f.event,h._id===c?P(h,g,f):g[0]._fci=d);C(b,a,P)}function j(a){var c,d=a.length,e,f,g,h,i={};for(c=0;c<d;c++)e=a[c],f=e.element,f&&(g=e.key=U(f[0]),h=i[g],h===b&&(h=i[g]=F(f,!0)),e.hsides=h)}function k(a){var b,c=a.length,d,e;for(b=0;b<c;b++)d=a[b],e=d.element,e&&(e[0].style.width=Math.max(0,d.outerWidth-d.hsides)+"px")}function l(a){var c,d=a.length,e,f,g,h,i={};for(c=0;c<d;c++)e=a[c],f=e.element,f&&(g=e.key,h=i[g],h===b&&(h=i[g]=L(f)),e.outerHeight=f[0].offsetHeight+h)}function n(){var a,b=B(),c=[];for(a=0;a<b;a++)c[a]=G(a).find("td:first div.fc-day-content > div");return c}function o(a){var b,c=a.length,d=[];for(b=0;b<c;b++)d[b]=a[b][0].offsetTop;return d}function p(a,b){var c,d=a.length,e,f,g;for(c=0;c<d;c++)e=a[c],f=e.element,f&&(f[0].style.top=b[e.row]+(e.top||0)+"px",g=e.event,t("eventAfterRender",g,g,f))}function q(b,c,e){var f=s("isRTL"),g=f?"w":"e",h=c.find("div.ui-resizable-"+g),j=!1;V(c),c.mousedown(function(a){a.preventDefault()}).click(function(a){j&&(a.preventDefault(),a.stopImmediatePropagation())}),h.mousedown(function(h){function k(c){t("eventResizeStop",this,b,c),a("body").css("cursor",""),l.stop(),W(),u&&A(this,b,u,0,c),setTimeout(function(){j=!1},0)}if(h.which!=1)return;j=!0;var l=r.getHoverListener(),n=B(),o=D(),p=f?-1:1,q=f?o-1:0,s=c.css("top"),u,v,x=a.extend({},b),C=M(b.start);X(),a("body").css("cursor",g+"-resize").one("mouseup",k),t("eventResizeStart",this,b,h),l.start(function(a,c){if(a){var h=Math.max(C.row,a.row),j=a.col;n==1&&(h=0),h==C.row&&(f?j=Math.min(C.col,j):j=Math.max(C.col,j)),u=h*7+j*p+q-(c.row*7+c.col*p+q);var k=i(w(b),u,!0);if(u){x.end=k;var l=v;v=d(N([x]),e.row,s),v.find("*").css("cursor",g+"-resize"),l&&l.remove(),z(b)}else v&&(y(b),v.remove(),v=null);W(),S(b.start,i(m(k),1))}},h)})}var r=this;r.renderDaySegs=c,r.resizableDayEvent=q;var s=r.opt,t=r.trigger,u=r.isEventDraggable,v=r.isEventResizable,w=r.eventEnd,x=r.reportEventElement,y=r.showEvents,z=r.hideEvents,A=r.eventResize,B=r.getRowCnt,D=r.getColCnt,E=r.getColWidth,G=r.allDayRow,H=r.allDayBounds,I=r.colContentLeft,J=r.colContentRight,K=r.dayOfWeekCol,M=r.dateCell,N=r.compileDaySegs,O=r.getDaySegmentContainer,P=r.bindDaySeg,R=r.calendar.formatDates,S=r.renderDayOverlay,W=r.clearOverlays,X=r.clearSelection}function bl(){function b(a,b,e){c(),b||(b=i(a,e)),j(a,b,e),d(a,b,e)}function c(a){l&&(l=!1,k(),h("unselect",null,a))}function d(a,b,c,d){l=!0,h("select",null,a,b,c,d)}function e(b){var e=f.cellDate,h=f.cellIsAllDay,i=f.getHoverListener(),l=f.reportDayClick;if(b.which==1&&g("selectable")){c(b);var m=this,n;i.start(function(a,b){k(),a&&h(a)?(n=[e(b),e(a)].sort(P),j(n[0],n[1],!0)):n=null},b),a(document).one("mouseup",function(a){i.stop(),n&&(+n[0]==+n[1]&&l(n[0],!0,a),d(n[0],n[1],!0,a))})}}var f=this;f.select=b,f.unselect=c,f.reportSelection=d,f.daySelectionMousedown=e;var g=f.opt,h=f.trigger,i=f.defaultSelectionEnd,j=f.renderSelection,k=f.clearSelection,l=!1;g("selectable")&&g("unselectAuto")&&a(document).mousedown(function(b){var d=g("unselectCancel");if(d&&a(b.target).parents(d).length)return;c(b)})}function bm(){function b(b,c){var d=f.shift();return d||(d=a("<div class='fc-cell-overlay' style='position:absolute;z-index:3'/>")),d[0].parentNode!=c[0]&&d.appendTo(c),e.push(d.css(b).show()),d}function c(){var a;while(a=e.shift())f.push(a.hide().unbind())}var d=this;d.renderOverlay=b,d.clearOverlays=c;var e=[],f=[]}function bn(a){var b=this,c,d;b.build=function(){c=[],d=[],a(c,d)},b.cell=function(a,b){var e=c.length,f=d.length,g,h=-1,i=-1;for(g=0;g<e;g++)if(b>=c[g][0]&&b<c[g][1]){h=g;break}for(g=0;g<f;g++)if(a>=d[g][0]&&a<d[g][1]){i=g;break}return h<0||i<0?null:{row:h,col:i}},b.rect=function(a,b,e,f,g){var h=g.offset();return{top:c[a][0]-h.top,left:d[b][0]-h.left,width:d[f][1]-d[b][0],height:c[e][1]-c[a][0]}}}function bo(b){function c(a){bp(a);var c=b.cell(a.pageX,a.pageY);if(!c!=!h||c&&(c.row!=h.row||c.col!=h.col))c?(g||(g=c),f(c,g,c.row-g.row,c.col-g.col)):f(c,g),h=c}var d=this,e,f,g,h;d.start=function(d,i,j){f=d,g=h=null,b.build(),c(i),e=j||"mousemove",a(document).bind(e,c)},d.stop=function(){return a(document).unbind(e,c),h}}function bp(a){a.pageX===b&&(a.pageX=a.originalEvent.pageX,a.pageY=a.originalEvent.pageY)}function bq(a){function c(b){return e[b]=e[b]||a(b)}var d=this,e={},f={},g={};d.left=function(a){return f[a]=f[a]===b?c(a).position().left:f[a]},d.right=function(a){return g[a]=g[a]===b?d.left(a)+c(a).width():g[a]},d.clear=function(){e={},f={},g={}}}var br={defaultView:"month",aspectRatio:1.35,header:{left:"title",center:"",right:"today prev,next"},weekends:!0,allDayDefault:!0,ignoreTimezone:!0,lazyFetching:!0,startParam:"start",endParam:"end",titleFormat:{month:"MMMM yyyy",week:"MMM d[ yyyy]{ '&#8212;'[ MMM] d yyyy}",day:"dddd, MMM d, yyyy"},columnFormat:{month:"ddd",week:"ddd M/d",day:"dddd M/d"},timeFormat:{"":"h(:mm)t"},isRTL:!1,firstDay:0,monthNames:["January","February","March","April","May","June","July","August","September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],buttonText:{prev:"&nbsp;&#9668;&nbsp;",next:"&nbsp;&#9658;&nbsp;",prevYear:"&nbsp;&lt;&lt;&nbsp;",nextYear:"&nbsp;&gt;&gt;&nbsp;",today:"today",month:"month",week:"week",day:"day"},theme:!1,buttonIcons:{prev:"circle-triangle-w",next:"circle-triangle-e"},unselectAuto:!0,dropAccept:"*"},bs={header:{left:"next,prev today",center:"",right:"title"},buttonText:{prev:"&nbsp;&#9658;&nbsp;",next:"&nbsp;&#9668;&nbsp;",prevYear:"&nbsp;&gt;&gt;&nbsp;",nextYear:"&nbsp;&lt;&lt;&nbsp;"},buttonIcons:{prev:"circle-triangle-e",next:"circle-triangle-w"}},bt=a.fullCalendar={version:"1.5.2"},bu=bt.views={};a.fn.fullCalendar=function(c){if(typeof c=="string"){var e=Array.prototype.slice.call(arguments,1),f;return this.each(function(){var d=a.data(this,"fullCalendar");if(d&&a.isFunction(d[c])){var g=d[c].apply(d,e);f===b&&(f=g),c=="destroy"&&a.removeData(this,"fullCalendar")}}),f!==b?f:this}var g=c.eventSources||[];return delete c.eventSources,c.events&&(g.push(c.events),delete c.events),c=a.extend(!0,{},br,c.isRTL||c.isRTL===b&&br.isRTL?bs:{},c),this.each(function(b,e){var f=a(e),h=new d(f,c,g);f.data("fullCalendar",h),h.render()}),this},bt.sourceNormalizers=[],bt.sourceFetchers=[];var bv={dataType:"json",cache:!1},bw=1;bt.addDays=i,bt.cloneDate=m,bt.parseDate=r,bt.parseISO8601=s,bt.parseTime=t,bt.formatDate=u,bt.formatDates=v;var bx=["sun","mon","tue","wed","thu","fri","sat"],by=864e5,bz=36e5,bA=6e4,bB={s:function(a){return a.getSeconds()},ss:function(a){return R(a.getSeconds())},m:function(a){return a.getMinutes()},mm:function(a){return R(a.getMinutes())},h:function(a){return a.getHours()%12||12},hh:function(a){return R(a.getHours()%12||12)},H:function(a){return a.getHours()},HH:function(a){return R(a.getHours())},d:function(a){return a.getDate()},dd:function(a){return R(a.getDate())},ddd:function(a,b){return b.dayNamesShort[a.getDay()]},dddd:function(a,b){return b.dayNames[a.getDay()]},M:function(a){return a.getMonth()+1},MM:function(a){return R(a.getMonth()+1)},MMM:function(a,b){return b.monthNamesShort[a.getMonth()]},MMMM:function(a,b){return b.monthNames[a.getMonth()]},yy:function(a){return(a.getFullYear()+"").substring(2)},yyyy:function(a){return a.getFullYear()},t:function(a){return a.getHours()<12?"a":"p"},tt:function(a){return a.getHours()<12?"am":"pm"},T:function(a){return a.getHours()<12?"A":"P"},TT:function(a){return a.getHours()<12?"AM":"PM"},u:function(a){return u(a,"yyyy-MM-dd'T'HH:mm:ss'Z'")},S:function(a){var b=a.getDate();return b>10&&b<20?"th":["st","nd","rd"][b%10-1]||"th"}};bt.applyAll=Z,bu.month=_,bu.basicWeek=ba,bu.basicDay=bb,c({weekMode:"fixed"}),bu.agendaWeek=be,bu.agendaDay=bf,c({allDaySlot:!0,allDayText:"all-day",firstHour:6,slotMinutes:30,defaultEventMinutes:120,axisFormat:"h(:mm)tt",timeFormat:{agenda:"h:mm{ - h:mm}"},dragOpacity:{agenda:.5},minTime:0,maxTime:24})}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/calendar/MiniCalendar",["jquery","i18n!calendar","vendor/jquery.ba-tinypubsub"],function(b,c){var d;return d=function(){function d(c,d){this.mainCalendar=d,this.refetchEvents=a(this.refetchEvents,this),this.visibleContextListChanged=a(this.visibleContextListChanged,this),this.eventRender=a(this.eventRender,this),this.dayClick=a(this.dayClick,this),this.getEvents=a(this.getEvents,this),this.calendar=b(c),this.calendar.fullCalendar({height:240,weekMode:"variable",allDayDefault:!1,lazyFetching:!1,ignoreTimezone:!0,header:{left:"prev",center:"title",right:"next"},dayClick:this.dayClick,events:this.getEvents,eventRender:this.eventRender},b.subscribe({"Calendar/visibleContextListChanged":this.visibleContextListChanged,"Calendar/refetchEvents":this.refetchEvents}))}return d.name="MiniCalendar",d.prototype.getEvents=function(a,b,c){return this.calendar.find(".fc-content td").removeClass("event slot-available").removeAttr("title"),this.mainCalendar.getEvents(a,b,c)},d.prototype.dayClick=function(a){return this.mainCalendar.gotoDate(a)},d.prototype.eventRender=function(a,b,d){var e,f,g,h,i,j;return f=d.dateCell(a.start),g=d.element.find("tr:nth-child("+(f.row+1)+") td:nth-child("+(f.col+1)+")"),g.addClass("event"),h=c.t("event_on_this_day","There is an event on this day"),e=(i=this.mainCalendar.displayAppointmentEvents)!=null?i.id:void 0,e&&e===((j=a.calendarEvent)!=null?j.appointment_group_id:void 0)&&a.object.available_slots&&(g.addClass("slot-available"),h=c.t("open_appointment_on_this_day","There is an open appointment on this day")),g.attr("title",h),!1},d.prototype.visibleContextListChanged=function(a){return this.calendar.fullCalendar("refetchEvents")},d.prototype.refetchEvents=function(){return this.calendar.fullCalendar("refetchEvents")},d}()})}.call(this),define("vendor/jquery.ui.core-1.9",["jquery","jqueryui/core"],function(a,b){function c(b,c){var e=b.nodeName.toLowerCase();if("area"===e){var f=b.parentNode,g=f.name,h;return!b.href||!g||f.nodeName.toLowerCase()!=="map"?!1:(h=a("img[usemap=#"+g+"]")[0],!!h&&d(h))}return(/input|select|textarea|button|object/.test(e)?!b.disabled:"a"==e?b.href||c:c)&&d(b)}function d(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{};if(a.ui.version)return;a.extend(a.ui,{version:"@VERSION",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({_focus:a.fn.focus,focus:function(b,c){return typeof b=="number"?this.each(function(){var d=this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;return a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length){var d=a(this[0]),e,f;while(d.length&&d[0]!==document){e=d.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){f=parseInt(d.css("zIndex"),10);if(!isNaN(f)&&f!==0)return f}d=d.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0,d&&(c-=parseFloat(a.curCSS(b,"border"+this+"Width",!0))||0),e&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)}),c}var f=d==="Width"?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return typeof b!="number"?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),a.support.minHeight=c.offsetHeight===100,a.support.selectstart="onselectstart"in c,b.removeChild(c).style.display="none"}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e=a.ui[b].prototype;for(var f in d)e.plugins[f]=e.plugins[f]||[],e.plugins[f].push([c,d[f]])},call:function(a,b,c){var d=a.plugins[b];if(!d||!a.element[0].parentNode)return;for(var e=0;e<d.length;e++)a.options[d[e][0]]&&d[e][1].apply(a.element,c)}},contains:a.contains,hasScroll:function(b,c){if(a(b).css("overflow")==="hidden")return!1;var d=c&&c==="left"?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&a.ui.isOverAxis(c,e,g)}})}),define("vendor/jquery.ui.widget-1.9",["jquery","jqueryui/widget"],function(a,b){var c=Array.prototype.slice,d=a.cleanData;a.cleanData=function(b){for(var c=0,e;(e=b[c])!=null;c++)a(e).triggerHandler("remove");d(b)},a.widget=function(b,d,e){var f=b.split(".")[0],g;b=b.split(".")[1],g=f+"-"+b,e||(e=d,d=a.Widget),a.expr[":"][g]=function(c){return!!a.data(c,b)},a[f]=a[f]||{},a[f][b]=a.extend(function(c,d){if(!this._createWidget)return new a[f][b](c,d);arguments.length&&this._createWidget(c,d)},a[f][b],{version:e.version});var h=new d;h.options=a.widget.extend({},h.options),a.each(e,function(b,f){a.isFunction(f)&&(e[b]=function(){var a=function(a){return d.prototype[a].apply(this,c.call(arguments,1))},b=function(a,b){return d.prototype[a].apply(this,b)};return function(){var c=this._super,d=this._superApply,e;return this._super=a,this._superApply=b,e=f.apply(this,arguments),this._super=c,this._superApply=d,e}}())}),a[f][b].prototype=a.widget.extend(h,{namespace:f,widgetName:b,widgetEventPrefix:b,widgetBaseClass:g},e),a.widget.bridge(b,a[f][b])},a.widget.extend=function(d){var e=c.call(arguments,1),f=0,g=e.length,h,i;for(;f<g;f++)for(h in e[f])i=e[f][h],e[f].hasOwnProperty(h)&&i!==b&&(d[h]=a.isPlainObject(i)?a.widget.extend({},d[h],i):i);return d},a.widget.bridge=function(d,e){a.fn[d]=function(f){var g=typeof f=="string",h=c.call(arguments,1),i=this;return f=!g&&h.length?a.widget.extend.apply(null,[f].concat(h)):f,g?this.each(function(){var c=a.data(this,d);if(!c)return console.log("WARNING, this will break with new jqueryui: cannot call methods on "+d+" prior to initialization; "+"attempted to call method '"+f+"'");if(!a.isFunction(c[f])||f.charAt(0)==="_")return a.error("no such method '"+f+"' for "+d+" widget instance");var e=c[f].apply(c,h);if(e!==c&&e!==b)return i=e&&e.jquery?i.pushStack(e.get()):e,!1}):this.each(function(){var b=a.data(this,d);b?b.option(f||{})._init():e(f,this)}),i}},a.Widget=function(b,c){if(!this._createWidget)return new a[namespace][name](b,c);arguments.length&&this._createWidget(b,c)},a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,c){c=a(c||this.defaultElement||this)[0],this.element=a(c),this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),c!==this&&(a.data(c,this.widgetName,this),this._bind({remove:"destroy"})),this._create(),this._trigger("create"),this._init()},_getCreateOptions:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled"),this.bindings.unbind("."+this.widgetName),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e=c,f,g,h;if(arguments.length===0)return a.widget.extend({},this.options);if(typeof c=="string"){e={},f=c.split("."),c=f.shift();if(f.length){g=e[c]=a.widget.extend({},this.options[c]);for(h=0;h<f.length-1;h++)g[f[h]]=g[f[h]]||{},g=g[f[h]];c=f.pop();if(d===b)return g[c]===b?null:g[c];g[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];e[c]=d}}return this._setOptions(e),this},_setOptions:function(b){var c=this;return a.each(b,function(a,b){c._setOption(a,b)}),this},_setOption:function(a,b){return this.options[a]=b,a==="disabled"&&(this.widget().toggleClass(this.widgetBaseClass+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_bind:function(b,c){c?(b=a(b),this.bindings=this.bindings.add(b)):(c=b,b=this.element);var d=this;a.each(c,function(c,e){b.bind(c+"."+d.widgetName,function(){if(d.options.disabled===!0||a(this).hasClass("ui-state-disabled"))return;return(typeof e=="string"?d[e]:e).apply(d,arguments)})})},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._bind(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._bind(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e=this.options[b],f;c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),d=d||{};if(c.originalEvent)for(var g=a.event.props.length,h;g;)h=a.event.props[--g],c[h]=c.originalEvent[h];return this.element.trigger(c,d),f=a.isArray(d)?[c].concat(d):[c,d],!(a.isFunction(e)&&e.apply(this.element[0],f)===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){typeof e=="string"&&(e={effect:e});var g,h=e?e===!0||typeof e=="number"?c:e.effect||c:b;e=e||{},typeof e=="number"&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&(a.effects.effect[h]||a.uiBackCompat!==!1&&a.effects[h])?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}}),a.uiBackCompat!==!1&&(a.Widget.prototype._getCreateOptions=function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]})}),define("vendor/jquery.ui.menu-1.9",["jquery","jqueryui/autocomplete","vendor/jquery.ui.core-1.9","vendor/jquery.ui.widget-1.9"],function(a){var b=0;a.widget("ui.menu",{version:"@VERSION",defaultElement:"<ul>",delay:150,options:{position:{my:"left top",at:"right top"}},_create:function(){var c=this;this.activeMenu=this.element,this.menuId=this.element.attr("id")||"ui-menu-"+b++,this.element.find(".ui-icon").length&&this.element.addClass("ui-menu-icons"),this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({id:this.menuId,role:"menu"}).bind("click.menu",function(b){var d=a(b.target).closest(".ui-menu-item:has(a)");if(c.options.disabled)return!1;if(!d.length)return;(!c.active||c.active[0]!==d[0])&&c.focus(b,d),c.select(b)}).bind("mouseover.menu",function(b){if(c.options.disabled)return;var d=a(b.target).closest(".ui-menu-item");d.length&&(d.siblings().children(".ui-state-active").removeClass("ui-state-active"),c.focus(b,d))}).bind("mouseout.menu",function(b){if(c.options.disabled)return;var d=a(b.target).closest(".ui-menu-item");d.length&&c.blur(b)}).bind("focus.menu",function(b){if(c.options.disabled)return;c.focus(b,a(b.target).children(".ui-menu-item:first"))}).bind("blur.menu",function(a){if(c.options.disabled)return;c.collapseAll(a)}),this.refresh(),this.element.attr("tabIndex",0).bind("keydown.menu",function(b){if(c.options.disabled)return;switch(b.keyCode){case a.ui.keyCode.PAGE_UP:c.previousPage(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.PAGE_DOWN:c.nextPage(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.HOME:c._move("first","first",b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.END:c._move("last","last",b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.UP:c.previous(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.DOWN:c.next(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.LEFT:c.collapse(b)&&b.stopImmediatePropagation(),b.preventDefault();break;case a.ui.keyCode.RIGHT:c.expand(b)&&b.stopImmediatePropagation(),b.preventDefault();break;case a.ui.keyCode.ENTER:c.active.children("a[aria-haspopup='true']").length?c.expand(b)&&b.stopImmediatePropagation():(c.select(b),b.stopImmediatePropagation()),b.preventDefault();break;case a.ui.keyCode.ESCAPE:c.collapse(b)&&b.stopImmediatePropagation(),b.preventDefault();break;default:b.stopPropagation(),clearTimeout(c.filterTimer);var d,e=c.previousFilter||"",f=String.fromCharCode(b.keyCode),g=!1;f==e?g=!0:f=e+f;function h(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}d=c.activeMenu.children(".ui-menu-item").filter(function(){return(new RegExp("^"+h(f),"i")).test(a(this).children("a").text())}),d=g&&d.index(c.active.next())!=-1?c.active.nextAll(".ui-menu-item"):d,d.length||(f=String.fromCharCode(b.keyCode),d=c.activeMenu.children(".ui-menu-item").filter(function(){return(new RegExp("^"+h(f),"i")).test(a(this).children("a").text())})),d.length?(c.focus(b,d),d.length>1?(c.previousFilter=f,c.filterTimer=setTimeout(function(){delete c.previousFilter},1e3)):delete c.previousFilter):delete c.previousFilter}}),this._bind(document,{click:function(b){a(b.target).closest(".ui-menu").length||this.collapseAll(b)}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find("ul").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").show(),this.element.find(".ui-menu-item").unbind(".menu").removeClass("ui-menu-item").removeAttr("role").children("a").removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").removeAttr("id").children(".ui-icon").remove()},refresh:function(){var b=this,c=this.element.find("ul:not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr("role","menu").hide().attr("aria-hidden","true").attr("aria-expanded","false"),d=c.add(this.element).children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation");d.children("a").addClass("ui-corner-all").attr("tabIndex",-1).attr("role","menuitem").attr("id",function(a){return b.element.attr("id")+"-"+a}),c.each(function(){var b=a(this),c=b.prev("a");c.attr("aria-haspopup","true").prepend('<span class="ui-menu-icon ui-icon ui-icon-carat-1-e"></span>'),b.attr("aria-labelledby",c.attr("id"))})},focus:function(b,c){var d,e=this;this.blur(b);if(this._hasScroll()){var f=parseFloat(a.curCSS(this.activeMenu[0],"borderTopWidth",!0))||0,g=parseFloat(a.curCSS(this.activeMenu[0],"paddingTop",!0))||0,h=c.offset().top-this.activeMenu.offset().top-f-g,i=this.activeMenu.scrollTop(),j=this.activeMenu.height(),k=c.height();h<0?this.activeMenu.scrollTop(i+h):h+k>j&&this.activeMenu.scrollTop(i+h-j+k)}this.active=c.first().children("a").addClass("ui-state-focus").end(),e.element.attr("aria-activedescendant",e.active.children("a").attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e.timer=setTimeout(function(){e._close()},e.delay),d=a(">ul",c),d.length&&/^mouse/.test(b.type)&&e._startOpening(d),this.activeMenu=c.parent(),this._trigger("focus",b,{item:c})},blur:function(a){if(!this.active)return;clearTimeout(this.timer),this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active})},_startOpening:function(a){clearTimeout(this.timer);if(a.attr("aria-hidden")!=="true")return;var b=this;b.timer=setTimeout(function(){b._close(),b._open(a)},b.delay)},_open:function(b){clearTimeout(this.timer),this.element.find(".ui-menu").not(b.parents()).hide().attr("aria-hidden","true");var c=a.extend({},{of:this.active},a.type(this.options.position)=="function"?this.options.position(this.active):this.options.position);b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(a){this.element.find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active"),this.blur(a),this.activeMenu=this.element},_close:function(){this.active.parent().find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(a){var b=this.active&&this.active.parents("li:not(.ui-menubar-item)").first();if(b&&b.length)return this.active.parent().attr("aria-hidden","true").attr("aria-expanded","false").hide(),this.focus(a,b),!0},expand:function(a){var b=this,c=this.active&&this.active.children("ul").children("li").first();if(c&&c.length)return this._open(c.parent()),setTimeout(function(){b.focus(a,c)},20),!0},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){if(!this.active){this.focus(c,this.activeMenu.children(".ui-menu-item")[b]());return}var d;a==="first"||a==="last"?d=this.active[a==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1):d=this.active[a+"All"](".ui-menu-item").eq(0),d.length?this.focus(c,d):this.focus(c,this.activeMenu.children(".ui-menu-item")[b]())},nextPage:function(b){if(this._hasScroll()){if(!this.active){this.focus(b,this.activeMenu.children(".ui-menu-item").first());return}if(this.last())return;var c=this.active.offset().top,d=this.element.height(),e;this.active.nextAll(".ui-menu-item").each(function(){return e=a(this),a(this).offset().top-c-d<0}),this.focus(b,e)}else this.focus(b,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())},previousPage:function(b){if(this._hasScroll()){if(!this.active){this.focus(b,this.activeMenu.children(".ui-menu-item").first());return}if(this.first())return;var c=this.active.offset().top,d=this.element.height(),e;this.active.prevAll(".ui-menu-item").each(function(){return e=a(this),a(this).offset().top-c+d>0}),this.focus(b,e)}else this.focus(b,this.activeMenu.children(".ui-menu-item").first())},_hasScroll:function(){return this.element.height()<this.element.prop("scrollHeight")},select:function(a){var b={item:this.active};this.collapseAll(a),this._trigger("select",a,b)}})}),define("jquery.ui.menu.inputmenu",["jquery","vendor/jquery.ui.menu-1.9"],function(a,b){var c=a.ui.menu.prototype,d=c.refresh;a.extend(c,{refresh:function(){d.call(this);var b=this,c=this.element.find("li.ui-menu-item"),e=!1;this.element.bind("click.menu",function(a){(new RegExp(/^a$/i)).test(a.target.tagName)||a.preventDefault()});var f=0;this.element.find("input[type='checkbox'], input[type='radio']").each(function(){var b=a(this).closest("label");b.length&&(a(this).insertBefore(b),a(this).attr("id")||a(this).attr("id","ui-input-"+f++),b.attr("for",a(this).attr("id")))}),c.children("a").each(function(b,c){var d=a(c),f=d.parent();d.children().is("input[type='checkbox'], input[type='radio']")&&(d.closest("ul").addClass("ui-menu-icons"),d.children("input[type='checkbox']").is(":checked")?(d.prepend('<span class="ui-icon ui-icon-check"></span>'),f.attr({role:"menuitemcheckbox","aria-checked":"true"})):d.children("input[type='radio']").is(":checked")?(d.prepend('<span class="ui-icon ui-icon-radio-on"></span>'),f.attr({role:"menuitemradio","aria-checked":"true"})):d.children("input[type='radio']").length?(d.prepend('<span class="ui-icon ui-icon-radio-off"></span>'),f.attr({role:"menuitemradio","aria-checked":"false"})):f.attr({role:"menuitemcheckbox","aria-checked":"false"}),d.children().is("input[type='radio']")&&f.attr("radio-group",d.children("input[type='radio']").attr("name")),f.prev().length&&!f.prev().children("a").length?(f.prev().addClass("ui-state-disabled").html("<span class='ui-menu-input-group'>"+f.prev().text()+"</span>").bind("click.menu",!1).after('<li class="ui-menu-item"><hr /></li>'),e=!0):f.prev().length&&!f.prev().children("a").children().is("input[type='checkbox'], input[type='radio']")&&f.before("<li><hr /></li>"),e&&f.next().length&&!f.next().children("a").children().is("input[type='checkbox'], input[type='radio']")?(f.after("<li><hr /></li>"),e=!1):f.next().length&&!f.next().children("a").children().is("input[type='checkbox'], input[type='radio']")&&f.after("<li><hr /></li>"),d.children("input[type='checkbox'], input[type='radio']").hide())}),c.bind("keydown.menu",function(c){c.keyCode===a.ui.keyCode.SPACE&&(b.active.children("a").children().is("input[type='checkbox'], input[type='radio']")&&(b.select(c),c.stopImmediatePropagation()),c.preventDefault())})},select:function(b){var c={item:this.active};this.active.children("a").children().is("input[type='checkbox']")&&(this.active.attr("aria-checked")==="false"?(this.active.children("a").prepend('<span class="ui-icon ui-icon-check"></span>'),this.active.attr("aria-checked","true"),this.active.children("a").children("input[type='checkbox']").prop("checked","checked").trigger("change")):this.active.attr("aria-checked")==="true"&&(this.active.children("a").children("span.ui-icon-check").remove(),this.active.attr("aria-checked","false"),this.active.children("a").children("input[type='checkbox']").removeAttr("checked").trigger("change"))),this.active.children("a").children().is("input[type='radio']")&&this.active.attr("aria-checked")==="false"&&(this.active.children("a").children("span.ui-icon-radio-off").toggleClass("ui-icon-radio-on ui-icon-radio-off"),this.active.attr("aria-checked","true"),this.active.children("a").children("input[type='radio']").prop("checked","checked").trigger("change"),this.active.siblings("[radio-group="+a(this.active).attr("radio-group")+"]").each(function(){a(this).attr("aria-checked","false"),a(this).children("a").children("span.ui-icon-radio-on").toggleClass("ui-icon-radio-on ui-icon-radio-off"),a(this).children("a").children("input[type='radio']").removeAttr("checked")})),this.active.children("a").children().is("input[type='checkbox'], input[type='radio']")||this.collapseAll(),this._trigger("select",b,c)}})}),define("vendor/jquery.ui.position-1.9",["jquery"],function(a,b){a.ui=a.ui||{};var c=/left|center|right/,d=/top|center|bottom/,e=/[+-]\d+%?/,f=/^\w+/,g=/%$/,h="center",i=a.fn.position;a.position={scrollbarWidth:function(){var b,c,d=a("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),e=d.children()[0];return a("body").append(d),b=e.offsetWidth,d.css("overflow","scroll"),c=e.offsetWidth,b===c&&(c=d[0].clientWidth),d.remove(),b-c},getScrollInfo:function(b){var c=b[0],d=b.height()<c.scrollHeight,e=b.width()<c.scrollWidth,f=a.position.scrollbarWidth();return{height:d?f:0,width:e?f:0}}},a.fn.position=function(b){if(!b||!b.of)return i.apply(this,arguments);b=a.extend({},b);var j=a(b.of),k=a(b.within||window),l=j[0],m=(b.collision||"flip").split(" "),n={},o,p,q,r;return l.nodeType===9?(p=j.width(),q=j.height(),r={top:0,left:0}):a.isWindow(l)?(p=j.width(),q=j.height(),r={top:j.scrollTop(),left:j.scrollLeft()}):l.preventDefault?(b.at="left top",p=q=0,r={top:b.of.pageY,left:b.of.pageX}):(p=j.outerWidth(),q=j.outerHeight(),r=j.offset()),a.each(["my","at"],function(){var a=(b[this]||"").split(" "),g,i;a.length===1&&(a=c.test(a[0])?a.concat([h]):d.test(a[0])?[h].concat(a):[h,h]),a[0]=c.test(a[0])?a[0]:h,a[1]=d.test(a[1])?a[1]:h,g=e.exec(a[0]),i=e.exec(a[1]),n[this]=[g?g[0]:0,i?i[0]:0],b[this]=[f.exec(a[0])[0],f.exec(a[1])[0]]}),m.length===1&&(m[1]=m[0]),b.at[0]==="right"?r.left+=p:b.at[0]===h&&(r.left+=p/2),b.at[1]==="bottom"?r.top+=q:b.at[1]===h&&(r.top+=q/2),o=[parseInt(n.at[0],10)*(g.test(n.at[0])?p/100:1),parseInt(n.at[1],10)*(g.test(n.at[1])?q/100:1)],r.left+=o[0],r.top+=o[1],this.each(function(){var c=a(this),d=c.outerWidth(),e=c.outerHeight(),f=parseInt(a.curCSS(this,"marginLeft",!0))||0,i=parseInt(a.curCSS(this,"marginTop",!0))||0,j=a.position.getScrollInfo(k),l=d+f+(parseInt(a.curCSS(this,"marginRight",!0))||0)+j.width,s=e+i+(parseInt(a.curCSS(this,"marginBottom",!0))||0)+j.height,t=a.extend({},r),u=[parseInt(n.my[0],10)*(g.test(n.my[0])?c.outerWidth()/100:1),parseInt(n.my[1],10)*(g.test(n.my[1])?c.outerHeight()/100:1)],v;b.my[0]==="right"?t.left-=d:b.my[0]===h&&(t.left-=d/2),b.my[1]==="bottom"?t.top-=e:b.my[1]===h&&(t.top-=e/2),t.left+=u[0],t.top+=u[1],t.left=Math.round(t.left),t.top=Math.round(t.top),v={left:t.left-f,top:t.top-i},a.each(["left","top"],function(f,g){a.ui.position[m[f]]&&a.ui.position[m[f]][g](t,{targetWidth:p,targetHeight:q,elemWidth:d,elemHeight:e,collisionPosition:v,collisionWidth:l,collisionHeight:s,offset:[o[0]+u[0],o[1]+u[1]],my:b.my,at:b.at,within:k,elem:c})}),a.fn.bgiframe&&c.bgiframe(),c.offset(a.extend(t,{using:b.using}))})},a.ui.position={fit:{left:function(b,c){var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?e.scrollLeft():d.offset().left,h=f?e.width():d.outerWidth(),i=g-c.collisionPosition.left,j=c.collisionPosition.left+c.collisionWidth-h-g;c.collisionWidth>h||i>0?b.left+=i:j>0?b.left-=j:b.left=Math.max(b.left-c.collisionPosition.left,b.left)},top:function(b,c){var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?e.scrollTop():d.offset().top,h=f?e.height():d.outerHeight(),i=g-c.collisionPosition.top,j=c.collisionPosition.top+c.collisionHeight-h-g;c.collisionHeight>h||i>0?b.top+=i:j>0?b.top-=j:b.top=Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(b,c){if(c.at[0]===h)return;c.elem.removeClass("ui-flipped-left ui-flipped-right");var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?0:d.offset().left,i=f?d.width():d.outerWidth(),j=c.collisionPosition.left-g,k=c.collisionPosition.left+c.collisionWidth-i-g,l=c.my[0]==="left",m=c.my[0]==="left"?-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,n=c.at[0]==="left"?c.targetWidth:-c.targetWidth,o=-2*c.offset[0];if(j<0||k>0)c.elem.addClass("ui-flipped-"+(j<0?"right":"left")),b.left+=m+n+o},top:function(b,c){if(c.at[1]===h)return;c.elem.removeClass("ui-flipped-top ui-flipped-bottom");var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?0:d.offset().top,i=f?d.height():d.outerHeight(),j=c.collisionPosition.top-g,k=c.collisionPosition.top+c.collisionHeight-i-g,l=c.my[1]==="top",m=l?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,n=c.at[1]==="top"?c.targetHeight:-c.targetHeight,o=-2*c.offset[1];if(j<0||k>0)c.elem.addClass("ui-flipped-"+(j<0?"bottom":"top")),b.top+=m+n+o}}},a.uiBackCompat!==!1&&function(a){var c=a.fn.position;a.fn.position=function(d){if(!d||!d.offset)return c.call(this,d);var e=d.offset.split(" "),f=d.at.split(" ");return e.length===1&&(e[1]=e[0]),/^\d/.test(e[0])&&(e[0]="+"+e[0]),/^\d/.test(e[1])&&(e[1]="+"+e[1]),f.length===1&&(/left|center|right/.test(f[0])?f[1]="center":(f[1]=f[0],f[0]="center")),c.call(this,a.extend(d,{at:f[0]+e[0]+" "+f[1]+e[1],offset:b}))}}(a)}),define("vendor/jquery.ui.popup-1.9",["jquery","vendor/jquery.ui.core-1.9","vendor/jquery.ui.widget-1.9","vendor/jquery.ui.position-1.9"],function(a,b,c,d){var e=0;a.widget("ui.popup",{version:"@VERSION",options:{position:{my:"left top",at:"left bottom"}},_create:function(){this.options.trigger||(this.options.trigger=this.element.prev()),this.element.attr("id")||(this.element.attr("id","ui-popup-"+e++),this.generatedId=!0),this.element.attr("role")||(this.element.attr("role","dialog"),this.generatedRole=!0),this.options.trigger.attr("aria-haspopup","true").attr("aria-owns",this.element.attr("id")),this.element.addClass("ui-popup"),this.close(),this._bind(this.options.trigger,{keydown:function(b){this.options.trigger.is("a:ui-button")&&b.keyCode==a.ui.keyCode.SPACE&&b.preventDefault(),b.keyCode==a.ui.keyCode.SPACE&&this.options.trigger.is("a:not(:ui-button)")&&this.options.trigger.trigger("click",b),b.keyCode==a.ui.keyCode.DOWN&&(b.preventDefault(),this.options.trigger.trigger("click",b))},click:function(a){a.preventDefault();if(this.isOpen)return;var b=this;clearTimeout(this.closeTimer),setTimeout(function(){b.open(a)},1)}}),this.element.is(":ui-menu")||this._bind({keydown:function(b){if(b.keyCode!==a.ui.keyCode.TAB)return;var c=a(":tabbable",this.element),d=c.first(),e=c.last();b.target===e[0]&&!b.shiftKey?(d.focus(1),b.preventDefault()):b.target===d[0]&&b.shiftKey&&(e.focus(1),b.preventDefault())}}),this._bind({focusout:function(a){var b=this;b.closeTimer=setTimeout(function(){b.close(a)},100)},focusin:function(a){clearTimeout(this.closeTimer)}}),this._bind({keyup:function(b){b.keyCode==a.ui.keyCode.ESCAPE&&this.element.is(":visible")&&(this.close(b),this.options.trigger.focus())}}),this._bind(document,{click:function(b){this.isOpen&&!a(b.target).closest(".ui-popup").length&&this.close(b)}})},_destroy:function(){this.element.show().removeClass("ui-popup").removeAttr("aria-hidden").removeAttr("aria-expanded").unbind("keypress.ui-popup"),this.options.trigger.removeAttr("aria-haspopup").removeAttr("aria-owns"),this.generatedId&&this.element.removeAttr("id"),this.generatedRole&&this.element.removeAttr("role")},open:function(b){var c=a.extend({},{of:this.options.trigger},this.options.position);this.element.show().attr("aria-hidden","false").attr("aria-expanded","true").position(c);if(this.element.is(":ui-menu"))this.element.menu("focus",b,this.element.children("li").first()),this.element.focus();else{var d=this.element.find(":tabbable");this.removeTabIndex=!1,d.length||(this.element.is(":tabbable")||(this.element.attr("tabindex","0"),this.removeTabIndex=!0),d=d.add(this.element[0])),d.first().focus(1)}this.options.trigger.attr("tabindex",-1),this.isOpen=!0,this._trigger("open",b)},close:function(a){this.element.hide().attr("aria-hidden","true").attr("aria-expanded","false"),this.options.trigger.attr("tabindex",0),this.removeTabIndex&&this.element.removeAttr("tabindex"),this.isOpen=!1,this._trigger("close",a)}})}),define("vendor/jquery.ui.button-1.9",["jquery","jqueryui/button","vendor/jquery.ui.core-1.9","vendor/jquery.ui.widget-1.9"],function(a,b){var c,d,e,f,g="ui-button ui-widget ui-state-default ui-corner-all",h="ui-state-hover ui-state-active ",i="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",j=function(){var b=a(this).find(":ui-button");setTimeout(function(){b.button("refresh")},1)},k=function(b){var c=b.name,d=b.form,e=a([]);return c&&(d?e=a(d).find("[name='"+c+"']"):e=a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form})),e};a.widget("ui.button",{version:"@VERSION",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",j),typeof this.options.disabled!="boolean"&&(this.options.disabled=this.element.prop("disabled")),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var b=this,h=this.options,i=this.type==="checkbox"||this.type==="radio",l="ui-state-hover"+(i?"":" ui-state-active"),m="ui-state-focus";h.label===null&&(h.label=this.buttonElement.html()),this.element.is(":disabled")&&(h.disabled=!0),this.buttonElement.addClass(g).attr("role","button").bind("mouseenter.button",function(){if(h.disabled)return;a(this).addClass("ui-state-hover"),this===c&&a(this).addClass("ui-state-active")}).bind("mouseleave.button",function(){if(h.disabled)return;a(this).removeClass(l)}).bind("click.button",function(a){h.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this.element.bind("focus.button",function(){b.buttonElement.addClass(m)}).bind("blur.button",function(){b.buttonElement.removeClass(m)}),i&&(this.element.bind("change.button",function(){if(f)return;b.refresh()}),this.buttonElement.bind("mousedown.button",function(a){if(h.disabled)return;f=!1,d=a.pageX,e=a.pageY}).bind("mouseup.button",function(a){if(h.disabled)return;if(d!==a.pageX||e!==a.pageY)f=!0})),this.type==="checkbox"?this.buttonElement.bind("click.button",function(){if(h.disabled||f)return!1;a(this).toggleClass("ui-state-active"),b.buttonElement.attr("aria-pressed",b.element[0].checked)}):this.type==="radio"?this.buttonElement.bind("click.button",function(){if(h.disabled||f)return!1;a(this).addClass("ui-state-active"),b.buttonElement.attr("aria-pressed","true");var c=b.element[0];k(c).not(c).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown.button",function(){if(h.disabled)return!1;a(this).addClass("ui-state-active"),c=this,a(document).one("mouseup",function(){c=null})}).bind("mouseup.button",function(){if(h.disabled)return!1;a(this).removeClass("ui-state-active")}).bind("keydown.button",function(b){if(h.disabled)return!1;(b.keyCode==a.ui.keyCode.SPACE||b.keyCode==a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active")}).bind("keyup.button",function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})),this._setOption("disabled",h.disabled),this._resetButton()},_determineButtonType:function(){this.element.is(":checkbox")?this.type="checkbox":this.element.is(":radio")?this.type="radio":this.element.is("input")?this.type="input":this.type="button";if(this.type==="checkbox"||this.type==="radio"){var a=this.element.parents().last(),b="label[for="+this.element.attr("id")+"]";this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible");var c=this.element.is(":checked");c&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",c)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(g+" "+h+" "+i).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,b){this._super("_setOption",a,b);if(a==="disabled"){b?this.element.prop("disabled",!0):this.element.prop("disabled",!1);return}this._resetButton()},refresh:function(){var b=this.element.is(":disabled");b!==this.options.disabled&&this._setOption("disabled",b),this.type==="radio"?k(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if(this.type==="input"){this.options.label&&this.element.val(this.options.label);return}var b=this.buttonElement.removeClass(i),c=a("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=this.options.icons,e=d.primary&&d.secondary,f=[];d.primary||d.secondary?(this.options.text&&f.push("ui-button-text-icon"+(e?"s":d.primary?"-primary":"-secondary")),d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>"),d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>"),this.options.text||(f.push(e?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||b.attr("title",c))):f.push("ui-button-text-only"),b.addClass(f.join(" "))}}),a.ui.button.version="@VERSION",a.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){a==="disabled"&&this.buttons.button("option",a,b),this._super("_setOption",a,b)},refresh:function(){var b=this.element.css("direction")==="ltr";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?"ui-corner-left":"ui-corner-right").end().filter(":last").addClass(b?"ui-corner-right":"ui-corner-left").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/jquery.kylemenu",["jquery","jquery.ui.menu.inputmenu","vendor/jquery.ui.popup-1.9","vendor/jquery.ui.button-1.9"],function(b,c,d,e){var f;return f=function(){function c(d,e){this.keepButtonActive=a(this.keepButtonActive,this),this.onClose=a(this.onClose,this),this.close=a(this.close,this),this.onOpen=a(this.onOpen,this);var f,g,h,i=this;this.$trigger=b(d).data("kyleMenu",this),this.opts=b.extend(!0,{},c.defaults,e),this.opts.noButton||(this.$trigger.button(this.opts.buttonOpts),this.$trigger.bind("mouseleave.button",this.keepButtonActive)),this.$menu=this.$trigger.next().menu(this.opts.menuOpts).popup(this.opts.popupOpts).addClass("ui-kyle-menu use-css-transitions-for-show-hide"),this.opts.appendMenuTo&&(f=this.$menu.data("popup"),h=f.open,g=this,f.open=function(){return g.$menu.appendTo(g.opts.appendMenuTo),h.apply(this,arguments)},this.$placeholder=b('<span style="display:none;">').insertAfter(this.$menu),this.$menu.bind("click",function(){var a;return(a=i.$placeholder).trigger.apply(a,arguments)})),this.$menu.bind({menuselect:this.close,popupopen:this.onOpen,popupclose:this.onClose})}return c.name="KyleMenu",c.prototype.onOpen=function(a){return this.adjustCarat(a),this.$menu.addClass("ui-state-open")},c.prototype.open=function(){return this.$menu.popup("open")},c.prototype.close=function(){return this.$menu.popup("close").removeClass("ui-state-open")},c.prototype.onClose=function(){return this.opts.appendMenuTo&&this.$menu.insertBefore(this.$placeholder),this.$trigger.removeClass("ui-state-active"),this.$menu.removeClass("ui-state-open")},c.prototype.keepButtonActive=function(){if(this.$menu.is(".ui-state-open"))return this.$trigger.addClass("ui-state-active")},c.prototype.adjustCarat=function(a){var c,d,e,f,g;return(g=this.$carat)!=null&&g.remove(),this.$trigger.addClass("ui-state-active"),f=this.$trigger.outerWidth(),e=this.$trigger.offset().left-this.$menu.offset().left,c=a.pageX-this.$trigger.offset().left,d=Math.min(Math.max(6,c),f-6)+e,this.$carat=b('<span class="ui-menu-carat"><span /></span>').css("left",d).prependTo(this.$menu),this.$menu.css("-webkit-transform-origin-x",d+"px")},c.defaults={popupOpts:{position:{my:"center top",at:"center bottom",offset:"0 10px",within:"#main",collision:"fit"}},buttonOpts:{icons:{primary:"ui-icon-home",secondary:"ui-icon-droparrow"}}},c}(),b.fn.kyleMenu=function(a){return this.each(function(){if(!b(this).data().kyleMenu)return new f(this,a)})},b(document).delegate(".al-trigger","click",function(a){var c,d,e;c=b(this),d={buttonOpts:{icons:{primary:null,secondary:null}}};if(!c.data("kyleMenu"))return a.preventDefault(),e=b.extend(d,c.data("kyleMenuOptions")),(new f(c,e)).open()}),f})}.call(this),define("vendor/jquery.ui.core-1.9",["jquery","jqueryui/core"],function(a,b){function c(b,c){var e=b.nodeName.toLowerCase();if("area"===e){var f=b.parentNode,g=f.name,h;return!b.href||!g||f.nodeName.toLowerCase()!=="map"?!1:(h=a("img[usemap=#"+g+"]")[0],!!h&&d(h))}return(/input|select|textarea|button|object/.test(e)?!b.disabled:"a"==e?b.href||c:c)&&d(b)}function d(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{};if(a.ui.version)return;a.extend(a.ui,{version:"@VERSION",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({_focus:a.fn.focus,focus:function(b,c){return typeof b=="number"?this.each(function(){var d=this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;return a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length){var d=a(this[0]),e,f;while(d.length&&d[0]!==document){e=d.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){f=parseInt(d.css("zIndex"),10);if(!isNaN(f)&&f!==0)return f}d=d.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0,d&&(c-=parseFloat(a.curCSS(b,"border"+this+"Width",!0))||0),e&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)}),c}var f=d==="Width"?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return typeof b!="number"?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),a.support.minHeight=c.offsetHeight===100,a.support.selectstart="onselectstart"in c,b.removeChild(c).style.display="none"}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e=a.ui[b].prototype;for(var f in d)e.plugins[f]=e.plugins[f]||[],e.plugins[f].push([c,d[f]])},call:function(a,b,c){var d=a.plugins[b];if(!d||!a.element[0].parentNode)return;for(var e=0;e<d.length;e++)a.options[d[e][0]]&&d[e][1].apply(a.element,c)}},contains:a.contains,hasScroll:function(b,c){if(a(b).css("overflow")==="hidden")return!1;var d=c&&c==="left"?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&a.ui.isOverAxis(c,e,g)}})}),define("vendor/jquery.ui.widget-1.9",["jquery","jqueryui/widget"],function(a,b){var c=Array.prototype.slice,d=a.cleanData;a.cleanData=function(b){for(var c=0,e;(e=b[c])!=null;c++)a(e).triggerHandler("remove");d(b)},a.widget=function(b,d,e){var f=b.split(".")[0],g;b=b.split(".")[1],g=f+"-"+b,e||(e=d,d=a.Widget),a.expr[":"][g]=function(c){return!!a.data(c,b)},a[f]=a[f]||{},a[f][b]=a.extend(function(c,d){if(!this._createWidget)return new a[f][b](c,d);arguments.length&&this._createWidget(c,d)},a[f][b],{version:e.version});var h=new d;h.options=a.widget.extend({},h.options),a.each(e,function(b,f){a.isFunction(f)&&(e[b]=function(){var a=function(a){return d.prototype[a].apply(this,c.call(arguments,1))},b=function(a,b){return d.prototype[a].apply(this,b)};return function(){var c=this._super,d=this._superApply,e;return this._super=a,this._superApply=b,e=f.apply(this,arguments),this._super=c,this._superApply=d,e}}())}),a[f][b].prototype=a.widget.extend(h,{namespace:f,widgetName:b,widgetEventPrefix:b,widgetBaseClass:g},e),a.widget.bridge(b,a[f][b])},a.widget.extend=function(d){var e=c.call(arguments,1),f=0,g=e.length,h,i;for(;f<g;f++)for(h in e[f])i=e[f][h],e[f].hasOwnProperty(h)&&i!==b&&(d[h]=a.isPlainObject(i)?a.widget.extend({},d[h],i):i);return d},a.widget.bridge=function(d,e){a.fn[d]=function(f){var g=typeof f=="string",h=c.call(arguments,1),i=this;return f=!g&&h.length?a.widget.extend.apply(null,[f].concat(h)):f,g?this.each(function(){var c=a.data(this,d);if(!c)return console.log("WARNING, this will break with new jqueryui: cannot call methods on "+d+" prior to initialization; "+"attempted to call method '"+f+"'");if(!a.isFunction(c[f])||f.charAt(0)==="_")return a.error("no such method '"+f+"' for "+d+" widget instance");var e=c[f].apply(c,h);if(e!==c&&e!==b)return i=e&&e.jquery?i.pushStack(e.get()):e,!1}):this.each(function(){var b=a.data(this,d);b?b.option(f||{})._init():e(f,this)}),i}},a.Widget=function(b,c){if(!this._createWidget)return new a[namespace][name](b,c);arguments.length&&this._createWidget(b,c)},a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,c){c=a(c||this.defaultElement||this)[0],this.element=a(c),this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),c!==this&&(a.data(c,this.widgetName,this),this._bind({remove:"destroy"})),this._create(),this._trigger("create"),this._init()},_getCreateOptions:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled"),this.bindings.unbind("."+this.widgetName),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e=c,f,g,h;if(arguments.length===0)return a.widget.extend({},this.options);if(typeof c=="string"){e={},f=c.split("."),c=f.shift();if(f.length){g=e[c]=a.widget.extend({},this.options[c]);for(h=0;h<f.length-1;h++)g[f[h]]=g[f[h]]||{},g=g[f[h]];c=f.pop();if(d===b)return g[c]===b?null:g[c];g[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];e[c]=d}}return this._setOptions(e),this},_setOptions:function(b){var c=this;return a.each(b,function(a,b){c._setOption(a,b)}),this},_setOption:function(a,b){return this.options[a]=b,a==="disabled"&&(this.widget().toggleClass(this.widgetBaseClass+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_bind:function(b,c){c?(b=a(b),this.bindings=this.bindings.add(b)):(c=b,b=this.element);var d=this;a.each(c,function(c,e){b.bind(c+"."+d.widgetName,function(){if(d.options.disabled===!0||a(this).hasClass("ui-state-disabled"))return;return(typeof e=="string"?d[e]:e).apply(d,arguments)})})},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._bind(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._bind(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e=this.options[b],f;c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),d=d||{};if(c.originalEvent)for(var g=a.event.props.length,h;g;)h=a.event.props[--g],c[h]=c.originalEvent[h];return this.element.trigger(c,d),f=a.isArray(d)?[c].concat(d):[c,d],!(a.isFunction(e)&&e.apply(this.element[0],f)===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){typeof e=="string"&&(e={effect:e});var g,h=e?e===!0||typeof e=="number"?c:e.effect||c:b;e=e||{},typeof e=="number"&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&(a.effects.effect[h]||a.uiBackCompat!==!1&&a.effects[h])?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}}),a.uiBackCompat!==!1&&(a.Widget.prototype._getCreateOptions=function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]})}),define("vendor/jquery.ui.menu-1.9",["jquery","jqueryui/autocomplete","vendor/jquery.ui.core-1.9","vendor/jquery.ui.widget-1.9"],function(a){var b=0;a.widget("ui.menu",{version:"@VERSION",defaultElement:"<ul>",delay:150,options:{position:{my:"left top",at:"right top"}},_create:function(){var c=this;this.activeMenu=this.element,this.menuId=this.element.attr("id")||"ui-menu-"+b++,this.element.find(".ui-icon").length&&this.element.addClass("ui-menu-icons"),this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({id:this.menuId,role:"menu"}).bind("click.menu",function(b){var d=a(b.target).closest(".ui-menu-item:has(a)");if(c.options.disabled)return!1;if(!d.length)return;(!c.active||c.active[0]!==d[0])&&c.focus(b,d),c.select(b)}).bind("mouseover.menu",function(b){if(c.options.disabled)return;var d=a(b.target).closest(".ui-menu-item");d.length&&(d.siblings().children(".ui-state-active").removeClass("ui-state-active"),c.focus(b,d))}).bind("mouseout.menu",function(b){if(c.options.disabled)return;var d=a(b.target).closest(".ui-menu-item");d.length&&c.blur(b)}).bind("focus.menu",function(b){if(c.options.disabled)return;c.focus(b,a(b.target).children(".ui-menu-item:first"))}).bind("blur.menu",function(a){if(c.options.disabled)return;c.collapseAll(a)}),this.refresh(),this.element.attr("tabIndex",0).bind("keydown.menu",function(b){if(c.options.disabled)return;switch(b.keyCode){case a.ui.keyCode.PAGE_UP:c.previousPage(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.PAGE_DOWN:c.nextPage(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.HOME:c._move("first","first",b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.END:c._move("last","last",b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.UP:c.previous(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.DOWN:c.next(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.LEFT:c.collapse(b)&&b.stopImmediatePropagation(),b.preventDefault();break;case a.ui.keyCode.RIGHT:c.expand(b)&&b.stopImmediatePropagation(),b.preventDefault();break;case a.ui.keyCode.ENTER:c.active.children("a[aria-haspopup='true']").length?c.expand(b)&&b.stopImmediatePropagation():(c.select(b),b.stopImmediatePropagation()),b.preventDefault();break;case a.ui.keyCode.ESCAPE:c.collapse(b)&&b.stopImmediatePropagation(),b.preventDefault();break;default:b.stopPropagation(),clearTimeout(c.filterTimer);var d,e=c.previousFilter||"",f=String.fromCharCode(b.keyCode),g=!1;f==e?g=!0:f=e+f;function h(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}d=c.activeMenu.children(".ui-menu-item").filter(function(){return(new RegExp("^"+h(f),"i")).test(a(this).children("a").text())}),d=g&&d.index(c.active.next())!=-1?c.active.nextAll(".ui-menu-item"):d,d.length||(f=String.fromCharCode(b.keyCode),d=c.activeMenu.children(".ui-menu-item").filter(function(){return(new RegExp("^"+h(f),"i")).test(a(this).children("a").text())})),d.length?(c.focus(b,d),d.length>1?(c.previousFilter=f,c.filterTimer=setTimeout(function(){delete c.previousFilter},1e3)):delete c.previousFilter):delete c.previousFilter}}),this._bind(document,{click:function(b){a(b.target).closest(".ui-menu").length||this.collapseAll(b)}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find("ul").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").show(),this.element.find(".ui-menu-item").unbind(".menu").removeClass("ui-menu-item").removeAttr("role").children("a").removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").removeAttr("id").children(".ui-icon").remove()},refresh:function(){var b=this,c=this.element.find("ul:not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr("role","menu").hide().attr("aria-hidden","true").attr("aria-expanded","false"),d=c.add(this.element).children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation");d.children("a").addClass("ui-corner-all").attr("tabIndex",-1).attr("role","menuitem").attr("id",function(a){return b.element.attr("id")+"-"+a}),c.each(function(){var b=a(this),c=b.prev("a");c.attr("aria-haspopup","true").prepend('<span class="ui-menu-icon ui-icon ui-icon-carat-1-e"></span>'),b.attr("aria-labelledby",c.attr("id"))})},focus:function(b,c){var d,e=this;this.blur(b);if(this._hasScroll()){var f=parseFloat(a.curCSS(this.activeMenu[0],"borderTopWidth",!0))||0,g=parseFloat(a.curCSS(this.activeMenu[0],"paddingTop",!0))||0,h=c.offset().top-this.activeMenu.offset().top-f-g,i=this.activeMenu.scrollTop(),j=this.activeMenu.height(),k=c.height();h<0?this.activeMenu.scrollTop(i+h):h+k>j&&this.activeMenu.scrollTop(i+h-j+k)}this.active=c.first().children("a").addClass("ui-state-focus").end(),e.element.attr("aria-activedescendant",e.active.children("a").attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e.timer=setTimeout(function(){e._close()},e.delay),d=a(">ul",c),d.length&&/^mouse/.test(b.type)&&e._startOpening(d),this.activeMenu=c.parent(),this._trigger("focus",b,{item:c})},blur:function(a){if(!this.active)return;clearTimeout(this.timer),this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active})},_startOpening:function(a){clearTimeout(this.timer);if(a.attr("aria-hidden")!=="true")return;var b=this;b.timer=setTimeout(function(){b._close(),b._open(a)},b.delay)},_open:function(b){clearTimeout(this.timer),this.element.find(".ui-menu").not(b.parents()).hide().attr("aria-hidden","true");var c=a.extend({},{of:this.active},a.type(this.options.position)=="function"?this.options.position(this.active):this.options.position);b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(a){this.element.find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active"),this.blur(a),this.activeMenu=this.element},_close:function(){this.active.parent().find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(a){var b=this.active&&this.active.parents("li:not(.ui-menubar-item)").first();if(b&&b.length)return this.active.parent().attr("aria-hidden","true").attr("aria-expanded","false").hide(),this.focus(a,b),!0},expand:function(a){var b=this,c=this.active&&this.active.children("ul").children("li").first();if(c&&c.length)return this._open(c.parent()),setTimeout(function(){b.focus(a,c)},20),!0},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){if(!this.active){this.focus(c,this.activeMenu.children(".ui-menu-item")[b]());return}var d;a==="first"||a==="last"?d=this.active[a==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1):d=this.active[a+"All"](".ui-menu-item").eq(0),d.length?this.focus(c,d):this.focus(c,this.activeMenu.children(".ui-menu-item")[b]())},nextPage:function(b){if(this._hasScroll()){if(!this.active){this.focus(b,this.activeMenu.children(".ui-menu-item").first());return}if(this.last())return;var c=this.active.offset().top,d=this.element.height(),e;this.active.nextAll(".ui-menu-item").each(function(){return e=a(this),a(this).offset().top-c-d<0}),this.focus(b,e)}else this.focus(b,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())},previousPage:function(b){if(this._hasScroll()){if(!this.active){this.focus(b,this.activeMenu.children(".ui-menu-item").first());return}if(this.first())return;var c=this.active.offset().top,d=this.element.height(),e;this.active.prevAll(".ui-menu-item").each(function(){return e=a(this),a(this).offset().top-c+d>0}),this.focus(b,e)}else this.focus(b,this.activeMenu.children(".ui-menu-item").first())},_hasScroll:function(){return this.element.height()<this.element.prop("scrollHeight")},select:function(a){var b={item:this.active};this.collapseAll(a),this._trigger("select",a,b)}})}),define("jquery.ui.menu.inputmenu",["jquery","vendor/jquery.ui.menu-1.9"],function(a,b){var c=a.ui.menu.prototype,d=c.refresh;a.extend(c,{refresh:function(){d.call(this);var b=this,c=this.element.find("li.ui-menu-item"),e=!1;this.element.bind("click.menu",function(a){(new RegExp(/^a$/i)).test(a.target.tagName)||a.preventDefault()});var f=0;this.element.find("input[type='checkbox'], input[type='radio']").each(function(){var b=a(this).closest("label");b.length&&(a(this).insertBefore(b),a(this).attr("id")||a(this).attr("id","ui-input-"+f++),b.attr("for",a(this).attr("id")))}),c.children("a").each(function(b,c){var d=a(c),f=d.parent();d.children().is("input[type='checkbox'], input[type='radio']")&&(d.closest("ul").addClass("ui-menu-icons"),d.children("input[type='checkbox']").is(":checked")?(d.prepend('<span class="ui-icon ui-icon-check"></span>'),f.attr({role:"menuitemcheckbox","aria-checked":"true"})):d.children("input[type='radio']").is(":checked")?(d.prepend('<span class="ui-icon ui-icon-radio-on"></span>'),f.attr({role:"menuitemradio","aria-checked":"true"})):d.children("input[type='radio']").length?(d.prepend('<span class="ui-icon ui-icon-radio-off"></span>'),f.attr({role:"menuitemradio","aria-checked":"false"})):f.attr({role:"menuitemcheckbox","aria-checked":"false"}),d.children().is("input[type='radio']")&&f.attr("radio-group",d.children("input[type='radio']").attr("name")),f.prev().length&&!f.prev().children("a").length?(f.prev().addClass("ui-state-disabled").html("<span class='ui-menu-input-group'>"+f.prev().text()+"</span>").bind("click.menu",!1).after('<li class="ui-menu-item"><hr /></li>'),e=!0):f.prev().length&&!f.prev().children("a").children().is("input[type='checkbox'], input[type='radio']")&&f.before("<li><hr /></li>"),e&&f.next().length&&!f.next().children("a").children().is("input[type='checkbox'], input[type='radio']")?(f.after("<li><hr /></li>"),e=!1):f.next().length&&!f.next().children("a").children().is("input[type='checkbox'], input[type='radio']")&&f.after("<li><hr /></li>"),d.children("input[type='checkbox'], input[type='radio']").hide())}),c.bind("keydown.menu",function(c){c.keyCode===a.ui.keyCode.SPACE&&(b.active.children("a").children().is("input[type='checkbox'], input[type='radio']")&&(b.select(c),c.stopImmediatePropagation()),c.preventDefault())})},select:function(b){var c={item:this.active};this.active.children("a").children().is("input[type='checkbox']")&&(this.active.attr("aria-checked")==="false"?(this.active.children("a").prepend('<span class="ui-icon ui-icon-check"></span>'),this.active.attr("aria-checked","true"),this.active.children("a").children("input[type='checkbox']").prop("checked","checked").trigger("change")):this.active.attr("aria-checked")==="true"&&(this.active.children("a").children("span.ui-icon-check").remove(),this.active.attr("aria-checked","false"),this.active.children("a").children("input[type='checkbox']").removeAttr("checked").trigger("change"))),this.active.children("a").children().is("input[type='radio']")&&this.active.attr("aria-checked")==="false"&&(this.active.children("a").children("span.ui-icon-radio-off").toggleClass("ui-icon-radio-on ui-icon-radio-off"),this.active.attr("aria-checked","true"),this.active.children("a").children("input[type='radio']").prop("checked","checked").trigger("change"),this.active.siblings("[radio-group="+a(this.active).attr("radio-group")+"]").each(function(){a(this).attr("aria-checked","false"),a(this).children("a").children("span.ui-icon-radio-on").toggleClass("ui-icon-radio-on ui-icon-radio-off"),a(this).children("a").children("input[type='radio']").removeAttr("checked")})),this.active.children("a").children().is("input[type='checkbox'], input[type='radio']")||this.collapseAll(),this._trigger("select",b,c)}})}),define("vendor/jquery.ui.position-1.9",["jquery"],function(a,b){a.ui=a.ui||{};var c=/left|center|right/,d=/top|center|bottom/,e=/[+-]\d+%?/,f=/^\w+/,g=/%$/,h="center",i=a.fn.position;a.position={scrollbarWidth:function(){var b,c,d=a("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),e=d.children()[0];return a("body").append(d),b=e.offsetWidth,d.css("overflow","scroll"),c=e.offsetWidth,b===c&&(c=d[0].clientWidth),d.remove(),b-c},getScrollInfo:function(b){var c=b[0],d=b.height()<c.scrollHeight,e=b.width()<c.scrollWidth,f=a.position.scrollbarWidth();return{height:d?f:0,width:e?f:0}}},a.fn.position=function(b){if(!b||!b.of)return i.apply(this,arguments);b=a.extend({},b);var j=a(b.of),k=a(b.within||window),l=j[0],m=(b.collision||"flip").split(" "),n={},o,p,q,r;return l.nodeType===9?(p=j.width(),q=j.height(),r={top:0,left:0}):a.isWindow(l)?(p=j.width(),q=j.height(),r={top:j.scrollTop(),left:j.scrollLeft()}):l.preventDefault?(b.at="left top",p=q=0,r={top:b.of.pageY,left:b.of.pageX}):(p=j.outerWidth(),q=j.outerHeight(),r=j.offset()),a.each(["my","at"],function(){var a=(b[this]||"").split(" "),g,i;a.length===1&&(a=c.test(a[0])?a.concat([h]):d.test(a[0])?[h].concat(a):[h,h]),a[0]=c.test(a[0])?a[0]:h,a[1]=d.test(a[1])?a[1]:h,g=e.exec(a[0]),i=e.exec(a[1]),n[this]=[g?g[0]:0,i?i[0]:0],b[this]=[f.exec(a[0])[0],f.exec(a[1])[0]]}),m.length===1&&(m[1]=m[0]),b.at[0]==="right"?r.left+=p:b.at[0]===h&&(r.left+=p/2),b.at[1]==="bottom"?r.top+=q:b.at[1]===h&&(r.top+=q/2),o=[parseInt(n.at[0],10)*(g.test(n.at[0])?p/100:1),parseInt(n.at[1],10)*(g.test(n.at[1])?q/100:1)],r.left+=o[0],r.top+=o[1],this.each(function(){var c=a(this),d=c.outerWidth(),e=c.outerHeight(),f=parseInt(a.curCSS(this,"marginLeft",!0))||0,i=parseInt(a.curCSS(this,"marginTop",!0))||0,j=a.position.getScrollInfo(k),l=d+f+(parseInt(a.curCSS(this,"marginRight",!0))||0)+j.width,s=e+i+(parseInt(a.curCSS(this,"marginBottom",!0))||0)+j.height,t=a.extend({},r),u=[parseInt(n.my[0],10)*(g.test(n.my[0])?c.outerWidth()/100:1),parseInt(n.my[1],10)*(g.test(n.my[1])?c.outerHeight()/100:1)],v;b.my[0]==="right"?t.left-=d:b.my[0]===h&&(t.left-=d/2),b.my[1]==="bottom"?t.top-=e:b.my[1]===h&&(t.top-=e/2),t.left+=u[0],t.top+=u[1],t.left=Math.round(t.left),t.top=Math.round(t.top),v={left:t.left-f,top:t.top-i},a.each(["left","top"],function(f,g){a.ui.position[m[f]]&&a.ui.position[m[f]][g](t,{targetWidth:p,targetHeight:q,elemWidth:d,elemHeight:e,collisionPosition:v,collisionWidth:l,collisionHeight:s,offset:[o[0]+u[0],o[1]+u[1]],my:b.my,at:b.at,within:k,elem:c})}),a.fn.bgiframe&&c.bgiframe(),c.offset(a.extend(t,{using:b.using}))})},a.ui.position={fit:{left:function(b,c){var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?e.scrollLeft():d.offset().left,h=f?e.width():d.outerWidth(),i=g-c.collisionPosition.left,j=c.collisionPosition.left+c.collisionWidth-h-g;c.collisionWidth>h||i>0?b.left+=i:j>0?b.left-=j:b.left=Math.max(b.left-c.collisionPosition.left,b.left)},top:function(b,c){var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?e.scrollTop():d.offset().top,h=f?e.height():d.outerHeight(),i=g-c.collisionPosition.top,j=c.collisionPosition.top+c.collisionHeight-h-g;c.collisionHeight>h||i>0?b.top+=i:j>0?b.top-=j:b.top=Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(b,c){if(c.at[0]===h)return;c.elem.removeClass("ui-flipped-left ui-flipped-right");var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?0:d.offset().left,i=f?d.width():d.outerWidth(),j=c.collisionPosition.left-g,k=c.collisionPosition.left+c.collisionWidth-i-g,l=c.my[0]==="left",m=c.my[0]==="left"?-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,n=c.at[0]==="left"?c.targetWidth:-c.targetWidth,o=-2*c.offset[0];if(j<0||k>0)c.elem.addClass("ui-flipped-"+(j<0?"right":"left")),b.left+=m+n+o},top:function(b,c){if(c.at[1]===h)return;c.elem.removeClass("ui-flipped-top ui-flipped-bottom");var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?0:d.offset().top,i=f?d.height():d.outerHeight(),j=c.collisionPosition.top-g,k=c.collisionPosition.top+c.collisionHeight-i-g,l=c.my[1]==="top",m=l?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,n=c.at[1]==="top"?c.targetHeight:-c.targetHeight,o=-2*c.offset[1];if(j<0||k>0)c.elem.addClass("ui-flipped-"+(j<0?"bottom":"top")),b.top+=m+n+o}}},a.uiBackCompat!==!1&&function(a){var c=a.fn.position;a.fn.position=function(d){if(!d||!d.offset)return c.call(this,d);var e=d.offset.split(" "),f=d.at.split(" ");return e.length===1&&(e[1]=e[0]),/^\d/.test(e[0])&&(e[0]="+"+e[0]),/^\d/.test(e[1])&&(e[1]="+"+e[1]),f.length===1&&(/left|center|right/.test(f[0])?f[1]="center":(f[1]=f[0],f[0]="center")),c.call(this,a.extend(d,{at:f[0]+e[0]+" "+f[1]+e[1],offset:b}))}}(a)}),define("vendor/jquery.ui.popup-1.9",["jquery","vendor/jquery.ui.core-1.9","vendor/jquery.ui.widget-1.9","vendor/jquery.ui.position-1.9"],function(a,b,c,d){var e=0;a.widget("ui.popup",{version:"@VERSION",options:{position:{my:"left top",at:"left bottom"}},_create:function(){this.options.trigger||(this.options.trigger=this.element.prev()),this.element.attr("id")||(this.element.attr("id","ui-popup-"+e++),this.generatedId=!0),this.element.attr("role")||(this.element.attr("role","dialog"),this.generatedRole=!0),this.options.trigger.attr("aria-haspopup","true").attr("aria-owns",this.element.attr("id")),this.element.addClass("ui-popup"),this.close(),this._bind(this.options.trigger,{keydown:function(b){this.options.trigger.is("a:ui-button")&&b.keyCode==a.ui.keyCode.SPACE&&b.preventDefault(),b.keyCode==a.ui.keyCode.SPACE&&this.options.trigger.is("a:not(:ui-button)")&&this.options.trigger.trigger("click",b),b.keyCode==a.ui.keyCode.DOWN&&(b.preventDefault(),this.options.trigger.trigger("click",b))},click:function(a){a.preventDefault();if(this.isOpen)return;var b=this;clearTimeout(this.closeTimer),setTimeout(function(){b.open(a)},1)}}),this.element.is(":ui-menu")||this._bind({keydown:function(b){if(b.keyCode!==a.ui.keyCode.TAB)return;var c=a(":tabbable",this.element),d=c.first(),e=c.last();b.target===e[0]&&!b.shiftKey?(d.focus(1),b.preventDefault()):b.target===d[0]&&b.shiftKey&&(e.focus(1),b.preventDefault())}}),this._bind({focusout:function(a){var b=this;b.closeTimer=setTimeout(function(){b.close(a)},100)},focusin:function(a){clearTimeout(this.closeTimer)}}),this._bind({keyup:function(b){b.keyCode==a.ui.keyCode.ESCAPE&&this.element.is(":visible")&&(this.close(b),this.options.trigger.focus())}}),this._bind(document,{click:function(b){this.isOpen&&!a(b.target).closest(".ui-popup").length&&this.close(b)}})},_destroy:function(){this.element.show().removeClass("ui-popup").removeAttr("aria-hidden").removeAttr("aria-expanded").unbind("keypress.ui-popup"),this.options.trigger.removeAttr("aria-haspopup").removeAttr("aria-owns"),this.generatedId&&this.element.removeAttr("id"),this.generatedRole&&this.element.removeAttr("role")},open:function(b){var c=a.extend({},{of:this.options.trigger},this.options.position);this.element.show().attr("aria-hidden","false").attr("aria-expanded","true").position(c);if(this.element.is(":ui-menu"))this.element.menu("focus",b,this.element.children("li").first()),this.element.focus();else{var d=this.element.find(":tabbable");this.removeTabIndex=!1,d.length||(this.element.is(":tabbable")||(this.element.attr("tabindex","0"),this.removeTabIndex=!0),d=d.add(this.element[0])),d.first().focus(1)}this.options.trigger.attr("tabindex",-1),this.isOpen=!0,this._trigger("open",b)},close:function(a){this.element.hide().attr("aria-hidden","true").attr("aria-expanded","false"),this.options.trigger.attr("tabindex",0),this.removeTabIndex&&this.element.removeAttr("tabindex"),this.isOpen=!1,this._trigger("close",a)}})}),define("vendor/jquery.ui.button-1.9",["jquery","jqueryui/button","vendor/jquery.ui.core-1.9","vendor/jquery.ui.widget-1.9"],function(a,b){var c,d,e,f,g="ui-button ui-widget ui-state-default ui-corner-all",h="ui-state-hover ui-state-active ",i="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",j=function(){var b=a(this).find(":ui-button");setTimeout(function(){b.button("refresh")},1)},k=function(b){var c=b.name,d=b.form,e=a([]);return c&&(d?e=a(d).find("[name='"+c+"']"):e=a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form})),e};a.widget("ui.button",{version:"@VERSION",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",j),typeof this.options.disabled!="boolean"&&(this.options.disabled=this.element.prop("disabled")),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var b=this,h=this.options,i=this.type==="checkbox"||this.type==="radio",l="ui-state-hover"+(i?"":" ui-state-active"),m="ui-state-focus";h.label===null&&(h.label=this.buttonElement.html()),this.element.is(":disabled")&&(h.disabled=!0),this.buttonElement.addClass(g).attr("role","button").bind("mouseenter.button",function(){if(h.disabled)return;a(this).addClass("ui-state-hover"),this===c&&a(this).addClass("ui-state-active")}).bind("mouseleave.button",function(){if(h.disabled)return;a(this).removeClass(l)}).bind("click.button",function(a){h.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this.element.bind("focus.button",function(){b.buttonElement.addClass(m)}).bind("blur.button",function(){b.buttonElement.removeClass(m)}),i&&(this.element.bind("change.button",function(){if(f)return;b.refresh()}),this.buttonElement.bind("mousedown.button",function(a){if(h.disabled)return;f=!1,d=a.pageX,e=a.pageY}).bind("mouseup.button",function(a){if(h.disabled)return;if(d!==a.pageX||e!==a.pageY)f=!0})),this.type==="checkbox"?this.buttonElement.bind("click.button",function(){if(h.disabled||f)return!1;a(this).toggleClass("ui-state-active"),b.buttonElement.attr("aria-pressed",b.element[0].checked)}):this.type==="radio"?this.buttonElement.bind("click.button",function(){if(h.disabled||f)return!1;a(this).addClass("ui-state-active"),b.buttonElement.attr("aria-pressed","true");var c=b.element[0];k(c).not(c).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown.button",function(){if(h.disabled)return!1;a(this).addClass("ui-state-active"),c=this,a(document).one("mouseup",function(){c=null})}).bind("mouseup.button",function(){if(h.disabled)return!1;a(this).removeClass("ui-state-active")}).bind("keydown.button",function(b){if(h.disabled)return!1;(b.keyCode==a.ui.keyCode.SPACE||b.keyCode==a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active")}).bind("keyup.button",function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})),this._setOption("disabled",h.disabled),this._resetButton()},_determineButtonType:function(){this.element.is(":checkbox")?this.type="checkbox":this.element.is(":radio")?this.type="radio":this.element.is("input")?this.type="input":this.type="button";if(this.type==="checkbox"||this.type==="radio"){var a=this.element.parents().last(),b="label[for="+this.element.attr("id")+"]";this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible");var c=this.element.is(":checked");c&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",c)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(g+" "+h+" "+i).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,b){this._super("_setOption",a,b);if(a==="disabled"){b?this.element.prop("disabled",!0):this.element.prop("disabled",!1);return}this._resetButton()},refresh:function(){var b=this.element.is(":disabled");b!==this.options.disabled&&this._setOption("disabled",b),this.type==="radio"?k(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if(this.type==="input"){this.options.label&&this.element.val(this.options.label);return}var b=this.buttonElement.removeClass(i),c=a("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=this.options.icons,e=d.primary&&d.secondary,f=[];d.primary||d.secondary?(this.options.text&&f.push("ui-button-text-icon"+(e?"s":d.primary?"-primary":"-secondary")),d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>"),d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>"),this.options.text||(f.push(e?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||b.attr("title",c))):f.push("ui-button-text-only"),b.addClass(f.join(" "))}}),a.ui.button.version="@VERSION",a.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){a==="disabled"&&this.buttons.button("option",a,b),this._super("_setOption",a,b)},refresh:function(){var b=this.element.css("direction")==="ltr";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?"ui-corner-left":"ui-corner-right").end().filter(":last").addClass(b?"ui-corner-right":"ui-corner-left").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/jquery.kylemenu",["jquery","jquery.ui.menu.inputmenu","vendor/jquery.ui.popup-1.9","vendor/jquery.ui.button-1.9"],function(b,c,d,e){var f;return f=function(){function c(d,e){this.keepButtonActive=a(this.keepButtonActive,this),this.onClose=a(this.onClose,this),this.close=a(this.close,this),this.onOpen=a(this.onOpen,this);var f,g,h,i=this;this.$trigger=b(d).data("kyleMenu",this),this.opts=b.extend(!0,{},c.defaults,e),this.opts.noButton||(this.$trigger.button(this.opts.buttonOpts),this.$trigger.bind("mouseleave.button",this.keepButtonActive)),this.$menu=this.$trigger.next().menu(this.opts.menuOpts).popup(this.opts.popupOpts).addClass("ui-kyle-menu use-css-transitions-for-show-hide"),this.opts.appendMenuTo&&(f=this.$menu.data("popup"),h=f.open,g=this,f.open=function(){return g.$menu.appendTo(g.opts.appendMenuTo),h.apply(this,arguments)},this.$placeholder=b('<span style="display:none;">').insertAfter(this.$menu),this.$menu.bind("click",function(){var a;return(a=i.$placeholder).trigger.apply(a,arguments)})),this.$menu.bind({menuselect:this.close,popupopen:this.onOpen,popupclose:this.onClose})}return c.name="KyleMenu",c.prototype.onOpen=function(a){return this.adjustCarat(a),this.$menu.addClass("ui-state-open")},c.prototype.open=function(){return this.$menu.popup("open")},c.prototype.close=function(){return this.$menu.popup("close").removeClass("ui-state-open")},c.prototype.onClose=function(){return this.opts.appendMenuTo&&this.$menu.insertBefore(this.$placeholder),this.$trigger.removeClass("ui-state-active"),this.$menu.removeClass("ui-state-open")},c.prototype.keepButtonActive=function(){if(this.$menu.is(".ui-state-open"))return this.$trigger.addClass("ui-state-active")},c.prototype.adjustCarat=function(a){var c,d,e,f,g;return(g=this.$carat)!=null&&g.remove(),this.$trigger.addClass("ui-state-active"),f=this.$trigger.outerWidth(),e=this.$trigger.offset().left-this.$menu.offset().left,c=a.pageX-this.$trigger.offset().left,d=Math.min(Math.max(6,c),f-6)+e,this.$carat=b('<span class="ui-menu-carat"><span /></span>').css("left",d).prependTo(this.$menu),this.$menu.css("-webkit-transform-origin-x",d+"px")},c.defaults={popupOpts:{position:{my:"center top",at:"center bottom",offset:"0 10px",within:"#main",collision:"fit"}},buttonOpts:{icons:{primary:"ui-icon-home",secondary:"ui-icon-droparrow"}}},c}(),b.fn.kyleMenu=function(a){return this.each(function(){if(!b(this).data().kyleMenu)return new f(this,a)})},b(document).delegate(".al-trigger","click",function(a){var c,d,e;c=b(this),d={buttonOpts:{icons:{primary:null,secondary:null}}};if(!c.data("kyleMenu"))return a.preventDefault(),e=b.extend(d,c.data("kyleMenuOptions")),(new f(c,e)).open()}),f})}.call(this),function(){require(["compiled/jquery.kylemenu"])}.call(this),define("compiled/bundles/jquery_ui_menu",function(){}),define("compiled/bundles/jquery_ui_menu",function(){}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/calendar/CommonEvent",["jquery","jquery.ajaxJSON","vendor/jquery.ba-tinypubsub"],function(b){return function(){function c(b,c,d){this.save=a(this.save,this),this.removeClass=a(this.removeClass,this),this.addClass=a(this.addClass,this),this.isUndated=a(this.isUndated,this),this.contextCode=a(this.contextCode,this),this.isAppointmentGroupEvent=a(this.isAppointmentGroupEvent,this),this.isAppointmentGroupFilledEvent=a(this.isAppointmentGroupFilledEvent,this),this.isNewEvent=a(this.isNewEvent,this),this.eventType="generic",this.contextInfo=c,this.actualContextInfo=d,this.allPossibleContexts=null,this.className=[],this.object={}}return c.prototype.isNewEvent=function(){var a;return this.eventType==="generic"||((a=this.object)!=null?!a.id:!void 0)},c.prototype.isAppointmentGroupFilledEvent=function(){var a,b;return((a=this.object)!=null?(b=a.child_events)!=null?b.length:void 0:void 0)>0},c.prototype.isAppointmentGroupEvent=function(){var a;return(a=this.object)!=null?a.appointment_group_url:void 0},c.prototype.contextCode=function(){var a,b,c;return((a=this.object)!=null?a.effective_context_code:void 0)||((b=this.object)!=null?b.context_code:void 0)||((c=this.contextInfo)!=null?c.asset_string:void 0)},c.prototype.isUndated=function(){return this.start===null},c.prototype.displayTimeString=function(){return""},c.prototype.readableType=function(){return""},c.prototype.fullDetailsURL=function(){return null},c.prototype.startDate=function(){return this.date},c.prototype.endDate=function(){return this.startDate()},c.prototype.possibleContexts=function(){return this.allPossibleContexts||[this.contextInfo]},c.prototype.addClass=function(a){var b,c,d,e,f;c=!1,f=this.className;for(d=0,e=f.length;d<e;d++){b=f[d];if(b===a){c=!0;break}}if(!c)return this.className.push(a)},c.prototype.removeClass=function(a){var b,c,d,e,f,g;c=0,f=this.className,g=[];for(d=0,e=f.length;d<e;d++)b=f[d],b===a?g.push(this.className.splice(c,1)):g.push(c+=1);return g},c.prototype.save=function(a,c,d){var e,f,g,h,i,j=this;return g=function(a){return j.copyDataFromObject(a),b.publish("CommonEvent/eventSaved",j),typeof c=="function"?c():void 0},f=function(a){return b.publish("CommonEvent/eventSaveFailed",j),typeof d=="function"?d():void 0},i=this.methodAndURLForSave(),e=i[0],h=i[1],b.publish("CommonEvent/eventSaving",this),b.ajaxJSON(h,e,a,g,f)},c}()})}.call(this),define("jst/calendar/calendarApp",["compiled/handlebars_helpers","i18n!calendar.calendar_app"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/calendarApp"]=b(function(a,b,c,d,e){c=c||a.helpers;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0;f+='<div>\n  <div id="calendar-header">\n    <div style="float: right">\n      <a href="#" id="refresh_calendar_link">',g="Refresh",h="refresh",i={},j="calendar.calendarApp",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</a>\n    </div>\n    \n    <span id="calendar_views">\n      <input type="radio" id="week"      name="calendar_view" /><label for="week">',g="Week",h="links.calendar_week",i={},j="calendar.calendarApp",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</label>\n      <input type="radio" id="month"     name="calendar_view" checked="checked" /><label for="month">',g="Month",h="links.calendar_month",i={},j="calendar.calendarApp",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</label>\n      <input type="radio" id="scheduler" name="calendar_view" /><label for="scheduler">',g="Scheduler",h="links.calendar_scheduler",i={},j="calendar.calendarApp",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;return f+=' <span stye="display: none" class="counter-badge"></span></label>\n    </div>\n  </span>\n  \n  <div class="scheduler-wrapper" style="display: none">\n    <div class="appointment-list">\n      <div class="list-wrapper"></div>\n    </div>\n  </div>\n  <div class="calendar"></div>\n</div>',f}),c["calendar/calendarApp"]}),define("jst/calendar/eventDetails",["compiled/handlebars_helpers","i18n!calendar.event_details"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/eventDetails"]=b(function(a,b,c,d,e){function o(a,b){var d="",e;return d+='\n        <a href="',e=c.fullDetailsURL||a.fullDetailsURL,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"fullDetailsURL",{hash:{}})),d+=n(e)+'" class="view_event_link">',e=c.title||a.title,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"title",{hash:{}})),d+=n(e)+"</a>\n      ",d}function p(a,b){var d="",e;return d+="\n        ",e=c.title||a.title,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"title",{hash:{}})),d+=n(e)+"\n      ",d}function q(a,b){var d="",e,f,g,h;d+='\n        <tr>\n          <th scope="row">',e="Calendar",f="calendar",g={},h="calendar.eventDetails",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;d+='</th>\n          <td><a href="',e=c.contextInfo||a.contextInfo,e=e===null||e===undefined||e===!1?e:e.url,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"contextInfo.url",{hash:{}})),d+=n(e)+'">',e=c.contextInfo||a.contextInfo,e=e===null||e===undefined||e===!1?e:e.name,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"contextInfo.name",{hash:{}})),d+=n(e)+"</a>\n            ",e=c.actualContextInfo||a.actualContextInfo,f=c["if"],i=j.program(6,r,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;return d+="\n          </td>\n        </tr>\n      ",d}function r(a,b){var d="",e;return d+='\n              <br><span class="event-details-actual-context">',e=c.actualContextInfo||a.actualContextInfo,e=e===null||e===undefined||e===!1?e:e.name,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"actualContextInfo.name",{hash:{}})),d+=n(e)+"</span>\n            ",d}function s(a,b){var d="",e,f,g,h;d+='\n        <tr>\n          <th scope="row">',e="Location",f="location",g={},h="calendar.eventDetails",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;return d+="</th>\n          <td>",e=c.location_name||a.location_name,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"location_name",{hash:{}})),d+=n(e)+"</td>\n        </tr>\n      ",d}function t(a,b){var d="",e,f,g,h;d+='\n        <tr>\n          <th scope="row">',e="Details",f="details",g={},h="calendar.eventDetails",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;d+="</th>\n          <td>",e=c.description||a.description,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"description",{hash:{}}));if(e||e===0)d+=e;return d+="</td>\n        </tr>\n      ",d}function u(a,b){var d="",e,f,g,h;d+='\n        <tr>\n          <th scope="row">',e="Attendees",f="attendees",g={},h="calendar.eventDetails",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;d+="</th>\n          <td>\n            ",e=c.can_edit||a.can_edit,f=c["if"],i=j.program(13,v,b),i.hash={},i.fn=i,i.inverse=j.program(16,x,b),e=f.call(a,e,i);if(e||e===0)d+=e;return d+="\n          </td>\n        </tr>\n      ",d}function v(a,b){var d="",e,f;d+='\n              <ul id="attendees">\n                ',e=c.reservations||a.reservations,f=c.each,i=j.program(14,w,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;return d+="\n              </ul>\n            ",d}function w(a,b){var d="",e;return d+='\n                  <li data-url="',e=c.event_url||a.event_url,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"event_url",{hash:{}})),d+=n(e)+'">\n                    <div class="ellipsis">',e=c.name||a.name,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"name",{hash:{}})),d+=n(e)+'</div>\n                    <a href="javascript:void(0)" class="cancel_appointment_link"></a>\n                  </li>\n                ',d}function x(a,b){var d="",e,f;d+="\n              <ul>\n                ",e=c.reservations||a.reservations,f=c.each,i=j.program(17,y,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;return d+="\n              </ul>\n            ",d}function y(a,b){var d="",e;return d+="\n                  <li>",e=c.name||a.name,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"name",{hash:{}})),d+=n(e)+"</li>\n                ",d}function z(a,b){var d="",e,f,g,h;d+='\n        <tr>\n          <th scope="row">',e="Slots available",f="slots_available",g={},h="calendar.eventDetails",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;return d+="</th>\n          <td>",e=c.availableSlotsText||a.availableSlotsText,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"availableSlotsText",{hash:{}})),d+=n(e)+"</td>\n        </tr>\n      ",d}function A(a,b){var d="",e;return d+='\n      <div class="available_slots">\n        ',e=c.available_slots_text||a.available_slots_text,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"available_slots_text",{hash:{}})),d+=n(e)+"\n      </div>\n    ",d}function B(a,b){var d="",e,f,g,h;d+='\n      <a href="#" class="button-secondary delete_event_link">',e="Delete",f="links.delete",g={},h="calendar.eventDetails",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;return d+="</a>\n    ",d}function C(a,b){var d="",e,f,g,h;d+='\n        <a href="#" class="reserve_event_link"><strong>',e="Reserve",f="links.reserve",g={},h="calendar.eventDetails",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;return d+="</strong></a>\n      ",d}function D(a,b){var d="",e,f,g,h;d+='\n        <a href="#" class="unreserve_event_link">',e="Un-reserve",f="links.unreserve",g={},h="calendar.eventDetails",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;return d+="</a>\n      ",d}function E(a,b){var d="",e,f,g,h;d+='\n        <a href="#" class="edit_event_link">',e="Edit",f="links.edit",g={},h="calendar.eventDetails",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;return d+="</a>\n      ",d}function F(a,b){var d="",e,f,g,h;d+='\n        <a href="#" class="message_students">\n          ',e="Message students",f="message_students",g={},h="calendar.eventDetails",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;return d+="\n        </a>\n      ",d}c=c||a.helpers;var f="",g,h,i,j=this,k="function",l=c.helperMissing,m=void 0,n=this.escapeExpression;f+='<div class="event-details carat-bottom">\n  <div class=\'event-details-header\'>\n    <a href="#" class="popover_close x-close-link"></a>\n    <h3 class="details_title title">\n      ',g=c.showEventLink||b.showEventLink,h=c["if"],i=j.program(1,o,e),i.hash={},i.fn=i,i.inverse=j.program(3,p,e),g=h.call(b,g,i);if(g||g===0)f+=g;f+='\n    </h3>\n  </div>\n  <div class="event-details-content">\n    <div class="event-details-timestring">',g=c.displayTimeString||b.displayTimeString,typeof g===k?g=g.call(b,{hash:{}}):g===m&&(g=l.call(b,"displayTimeString",{hash:{}}));if(g||g===0)f+=g;f+='</div>\n    <table cellspacing="0">\n      ',g=c.contextInfo||b.contextInfo,h=c["if"],i=j.program(5,q,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;f+="\n      ",g=c.location_name||b.location_name,h=c["if"],i=j.program(8,s,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;f+="\n      ",g=c.description||b.description,h=c["if"],i=j.program(10,t,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;f+="\n      ",g=c.reservations||b.reservations,h=c["if"],i=j.program(12,u,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;f+="\n      ",g=c.availableSlotsText||b.availableSlotsText,h=c["if"],i=j.program(19,z,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;f+='\n    </table>\n    <div class="details_description lock_explanation">',g=c.lock_explanation||b.lock_explanation,typeof g===k?g=g.call(b,{hash:{}}):g===m&&(g=l.call(b,"lock_explanation",{hash:{}}));if(g||g===0)f+=g;f+="</div>\n    ",g=c.available_slots_text||b.available_slots_text,h=c["if"],i=j.program(21,A,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;f+='\n  </div>\n  <div class="popover-links-holder event-details-footer">\n    ',g=c.can_delete||b.can_delete,h=c["if"],i=j.program(23,B,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;f+='\n    <div class="event-details-links">\n      ',g=c.can_reserve||b.can_reserve,h=c["if"],i=j.program(25,C,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;f+="\n      ",g=c.can_unreserve||b.can_unreserve,h=c["if"],i=j.program(27,D,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;f+="\n      ",g=c.can_edit||b.can_edit,h=c["if"],i=j.program(29,E,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;f+="\n      ",g=c.reservations||b.reservations,h=c["if"],i=j.program(31,F,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;return f+="\n    </div>\n  </div>\n</div>\n",f}),c["calendar/eventDetails"]}),define("jst/calendar/deleteItem",["compiled/handlebars_helpers","i18n!calendar.delete_item"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/deleteItem"]=b(function(a,b,c,d,e){function o(a,b){var d="",e;return d+="\n  <p>\n    ",e=c.details||a.details,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"details",{hash:{}})),d+=n(e)+"\n  </p>\n  ",d}function p(a,b){var d="",e,f,g,h;d+='\n  <div>\n    <label for="cancel_reason">',e="Reason for deletion:",f="deletion_reason",g={},h="calendar.deleteItem",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;return d+='</label><br />\n    <textarea id="cancel_reason"></textarea>\n  </div>\n  ',d}c=c||a.helpers;var f="",g,h,i,j=this,k="function",l=c.helperMissing,m=void 0,n=this.escapeExpression;f+='<div id="delete_event_dialog">\n  <p>\n    ',g=c.message||b.message,typeof g===k?g=g.call(b,{hash:{}}):g===m&&(g=l.call(b,"message",{hash:{}})),f+=n(g)+"\n  </p>\n  ",g=c.details||b.details,h=c["if"],i=j.program(1,o,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;f+="\n  ",g=c.hide_reason||b.hide_reason,h=c.unless,i=j.program(3,p,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;return f+="\n</div>",f}),c["calendar/deleteItem"]}),define("jst/calendar/reservationOverLimitDialog",["compiled/handlebars_helpers","i18n!calendar.reservation_over_limit_dialog"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/reservationOverLimitDialog"]=b(function(a,b,c,d,e){function q(a,b){var d="",e,f,g,h;d+="\n    ",e="Cancel existing reservation and sign up for this one?",f="cancel_existing_reservation",g={},h="calendar.reservationOverLimitDialog",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;return d+="\n  ",d}function r(a,b){var d="",e,f,g,h;d+="\n    ",e="Appointment limit reached",f="appointment_limit_reached",g={},h="calendar.reservationOverLimitDialog",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;return d+="\n  ",d}function s(a,b){var d="",e,f,g;return d+="\n    <div>\n      ",e=c.end_at||a.end_at,f=c.start_at||a.start_at,g=c.semanticDateRange||a.semanticDateRange,typeof g===m?e=g.call(a,f,e,{hash:{}}):g===o?e=n.call(a,"semanticDateRange",f,e,{hash:{}}):e=g,d+=p(e)+"\n    </div>\n  ",d}function t(a,b){var d="",e,f,g,h;d+="\n    ",e="Would you like to cancel that and sign up for this?",f="would_you_like_to_cancel_that_and_sign_up_for_this",g={},h="calendar.reservationOverLimitDialog",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;return d+="\n  ",d}function u(a,b){var d="",e,f,g,h;d+="\n    ",e="Please cancel one of your other reservations and try again.",f="cancel_some_appointments_and_try_again",g={},h="calendar.reservationOverLimitDialog",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;return d+="\n  ",d}c=c||a.helpers;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0,p=this.escapeExpression;f+='<div title="\n  ',g=c.reschedulable||b.reschedulable,h=c["if"],k=l.program(1,q,e),k.hash={},k.fn=k,k.inverse=l.program(3,r,e),g=h.call(b,g,k);if(g||g===0)f+=g;f+='">\n\n  ',g="You are already signed up for:",h="you_are_already_signed_up_for",i={},j="calendar.reservationOverLimitDialog",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+="<br>\n  ",g=c.reservations||b.reservations,h=c.each,k=l.program(5,s,e),k.hash={},k.fn=k,k.inverse=l.noop,g=h.call(b,g,k);if(g||g===0)f+=g;f+="\n  ",g=c.reschedulable||b.reschedulable,h=c["if"],k=l.program(7,t,e),k.hash={},k.fn=k,k.inverse=l.program(9,u,e),g=h.call(b,g,k);if(g||g===0)f+=g;return f+="\n</div>\n",f}),c["calendar/reservationOverLimitDialog"]}),define("jst/calendar/messageParticipants",["compiled/handlebars_helpers","i18n!calendar.message_participants"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/messageParticipants"]=b(function(a,b,c,d,e){function q(a,b){var d="",e,f,g,h;d+="\n  ",e="Message Groups",f="message_groups",g={},h="calendar.messageParticipants",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;return d+="\n",d}function r(a,b){var d="",e,f,g,h;d+="\n  ",e="Message Students",f="message_students",g={},h="calendar.messageParticipants",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;return d+="\n",d}function s(a,b){var d="",e,f,g,h;d+='\n      <option value="all">',e="All groups",f="all_groups",g={},h="calendar.messageParticipants",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;d+='</option>\n      <option value="unregistered">',e="Groups who haven't signed up yet",f="unregistered_groups",g={},h="calendar.messageParticipants",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;d+='</option>\n      <option value="registered">',e="Groups who have already signed up",f="registered_groups",g={},h="calendar.messageParticipants",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;return d+="</option>\n      ",d}function t(a,b){var d="",e,f,g,h;d+='\n      <option value="all">',e="All users",f="all_users",g={},h="calendar.messageParticipants",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;d+='</option>\n      <option value="unregistered">',e="Users who haven't signed up yet",f="unregistered_users",g={},h="calendar.messageParticipants",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;d+='</option>\n      <option value="registered">',e="Users who have already signed up",f="registered_users",g={},h="calendar.messageParticipants",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;return d+="</option>\n      ",d}c=c||a.helpers;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0,p=c.blockHelperMissing;f+='<form title="',g="Group",h=c.participant_type||b.participant_type,i=c.ifEqual||b.ifEqual,k=l.program(1,q,e),k.hash={},k.fn=k,k.inverse=l.program(3,r,e),typeof i===m?g=i.call(b,h,g,k):g=p.call(b,i,h,g,k);if(g||g===0)f+=g;f+="\" action='#' id='message_participants_form'>\n  <h2>",g="Send a message to...",h="send_message_to",i={},j="calendar.messageParticipants",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</h2>\n  <div>\n    <select class="message_groups">\n      ',g="Group",h=c.participant_type||b.participant_type,i=c.ifEqual||b.ifEqual,k=l.program(5,s,e),k.hash={},k.fn=k,k.inverse=l.program(7,t,e),typeof i===m?g=i.call(b,h,g,k):g=p.call(b,i,h,g,k);if(g||g===0)f+=g;f+='\n    </select>\n  </div>\n  <ul class="participant_list"></ul>\n  <div class="clear"></div>\n  <div>\n    <label for="body">',g="Message:",h="message_label",i={},j="calendar.messageParticipants",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;return f+='</label><br />\n    <textarea id="body" name="body"></textarea>\n  </div>\n  <div class="error"></div>\n</form>\n',f}),c["calendar/messageParticipants"]}),define("jst/calendar/recipientList",["compiled/handlebars_helpers"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/recipientList"]=b(function(a,b,c,d,e){function q(a,b){var d="",e,f;d+="\n  ",e=c.recipients||a.recipients,f=c.each,j=k.program(2,r,b),j.hash={},j.fn=j,j.inverse=k.noop,e=f.call(a,e,j);if(e||e===0)d+=e;return d+="\n",d}function r(a,b){var d="",e;return d+="\n    <li>\n      <span>",e=c.name||a.name,typeof e===l?e=e.call(a,{hash:{}}):e===n&&(e=m.call(a,"name",{hash:{}})),d+=o(e)+'</span>\n      <input name="recipients[]" type="hidden" value="group_',e=c.id||a.id,typeof e===l?e=e.call(a,{hash:{}}):e===n&&(e=m.call(a,"id",{hash:{}})),d+=o(e)+'" />\n    </li>\n  ',d}function s(a,b){var d="",e,f;d+="\n  ",e=c.recipients||a.recipients,f=c.each,j=k.program(5,t,b),j.hash={},j.fn=j,j.inverse=k.noop,e=f.call(a,e,j);if(e||e===0)d+=e;return d+="\n",d}function t(a,b){var d="",e;return d+="\n    <li>\n      <span>",e=c.name||a.name,typeof e===l?e=e.call(a,{hash:{}}):e===n&&(e=m.call(a,"name",{hash:{}})),d+=o(e)+'</span>\n      <input name="recipients[]" type="hidden" value="',e=c.id||a.id,typeof e===l?e=e.call(a,{hash:{}}):e===n&&(e=m.call(a,"id",{hash:{}})),d+=o(e)+'" />\n    </li>\n  ',d}c=c||a.helpers;var f="",g,h,i,j,k=this,l="function",m=c.helperMissing,n=void 0,o=this.escapeExpression,p=c.blockHelperMissing;g="Group",h=c.recipientType||b.recipientType,i=c.ifEqual||b.ifEqual,j=k.program(1,q,e),j.hash={},j.fn=j,j.inverse=k.program(4,s,e),typeof i===l?g=i.call(b,h,g,j):g=p.call(b,i,h,g,j);if(g||g===0)f+=g;return f+="\n",f}),c["calendar/recipientList"]}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/calendar/MessageParticipantsDialog",["jquery","underscore","i18n!calendar","jst/calendar/messageParticipants","jst/calendar/recipientList"],function(b,c,d,e,f){var g;return g=function(){function g(d){var g;this.opts=d,this.messageFailed=a(this.messageFailed,this),this.messageSent=a(this.messageSent,this),this.sendMessage=a(this.sendMessage,this),this.loadParticipants=a(this.loadParticipants,this),this.opts.timeslot?(this.recipients=c(this.opts.timeslot.child_events).map(function(a){return a.user||a.group}),g=this.recipients[0].short_name===void 0?"Group":"User",this.$form=b(e({participant_type:g})),this.$form.find("select.message_groups").remove()):(this.group=this.opts.group,this.$form=b(e({participant_type:this.group.participant_type})),this.dataSource=this.opts.dataSource,this.$select=this.$form.find("select.message_groups").change(this.loadParticipants).val("unregistered")),this.$form.submit(this.sendMessage),this.$participantList=this.$form.find("ul"),this.recipients&&this.$participantList.html(f({recipientType:g,recipients:this.recipients}))}return g.name="MessageParticipantsDialog",g.prototype.show=function(){return this.$form.dialog({width:400,resizable:!1,buttons:[{text:d.t("buttons.send_message","Send"),"data-text-while-loading":d.t("buttons.sending_message","Sending..."),click:function(){return b(this).submit()}},{text:d.t("buttons.cancel","Cancel"),click:function(){return b(this).dialog("close")}}],close:function(){return b(this).remove()}}),this.loadParticipants()},g.prototype.participantStatus=function(a){var c;return a==null&&(a=null),c=b('<li class="status" />'),this.$participantList.html(c),a?c.text(a):c.spin()},g.prototype.loadParticipants=function(){var a,b=this;if(this.recipients)return;return a=this.$select.val(),this.loading=!0,this.participantStatus(),this.dataSource.getParticipants(this.group,a,function(a){var c;return delete b.loading,a.length?b.$participantList.html(f({recipientType:b.group.participant_type,recipients:a})):(c=b.group.participant_type==="Group"?d.t("no_groups","No groups found"):d.t("no_users","No users found"),b.participantStatus(c))})},g.prototype.sendMessage=function(a){var c,d;a.preventDefault();if(this.loading)return;c=this.$form.getFormData();if(!c["recipients[]"]||!c.body)return;return d=b.ajaxJSON("/conversations","POST",c,this.messageSent,this.messageFailed),this.$form.disableWhileLoading(d,{buttons:["[data-text-while-loading] .ui-button-text"]})},g.prototype.messageSent=function(a){return this.$form.dialog("close"),b.flashMessage(d.t("messages_sent","Messages Sent"))},g.prototype.messageFailed=function(a){return this.$form.find(".error").text(d.t("errors.send_message_failed","There was an error sending your message, please try again"))},g}()})}.call(this),define("jst/calendar/TimeBlockRow",["compiled/handlebars_helpers","i18n!calendar.time_block_row"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/TimeBlockRow"]=b(function(a,b,c,d,e){function p(a,b){return'class="locked"'}function q(a,b){return" disabled"}function r(a,b){return" disabled"}function s(a,b){return" disabled"}function t(a,b){var d="",e,f,g,h;d+='\n      <a href="#" class="delete-block-link">',e="Remove row",f="remove_row",g={},h="calendar.TimeBlockRow",g.scope=h,h=c.t||a.t,j={},j.hash=g,typeof h===l?e=h.call(a,f,e,j):h===n?e=m.call(a,"t",f,e,j):e=h;if(e||e===0)d+=e;return d+="</a>\n    ",d}c=c||a.helpers;var f="",g,h,i,j,k=this,l="function",m=c.helperMissing,n=void 0,o=this.escapeExpression;f+="<tr ",g=c.locked||b.locked,h=c["if"],j=k.program(1,p,e),j.hash={},j.fn=j,j.inverse=k.noop,g=h.call(b,g,j);if(g||g===0)f+=g;f+='>\n  <td class="date-column"><input name="date" class="date_field" value="',g="MMM d, yyyy",h=c.start||b.start,i=c.dateToString||b.dateToString,typeof i===l?g=i.call(b,h,g,{hash:{}}):i===n?g=m.call(b,"dateToString",h,g,{hash:{}}):g=i,f+=o(g)+'"',g=c.locked||b.locked,h=c["if"],j=k.program(3,q,e),j.hash={},j.fn=j,j.inverse=k.noop,g=h.call(b,g,j);if(g||g===0)f+=g;f+='/></td>\n  <td class="start-time-column"><input name="start_time" class="time_field start_time" value="',g="h:mmtt",h=c.start||b.start,i=c.dateToString||b.dateToString,typeof i===l?g=i.call(b,h,g,{hash:{}}):i===n?g=m.call(b,"dateToString",h,g,{hash:{}}):g=i,f+=o(g)+'"',g=c.locked||b.locked,h=c["if"],j=k.program(5,r,e),j.hash={},j.fn=j,j.inverse=k.noop,g=h.call(b,g,j);if(g||g===0)f+=g;f+='/></td>\n  <td class="separator-column">-</td>\n  <td class="end-time-column"><input name="end_time" class="time_field end_time" value="',g="h:mmtt",h=c.end||b.end,i=c.dateToString||b.dateToString,typeof i===l?g=i.call(b,h,g,{hash:{}}):i===n?g=m.call(b,"dateToString",h,g,{hash:{}}):g=i,f+=o(g)+'"',g=c.locked||b.locked,h=c["if"],j=k.program(7,s,e),j.hash={},j.fn=j,j.inverse=k.noop,g=h.call(b,g,j);if(g||g===0)f+=g;f+='/></td>\n  <td class="delete-column">\n    ',g=c.locked||b.locked,h=c.unless,j=k.program(9,t,e),j.hash={},j.fn=j,j.inverse=k.noop,g=h.call(b,g,j);if(g||g===0)f+=g;return f+="\n  </td>\n</tr>\n",f}),c["calendar/TimeBlockRow"]}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty;define("compiled/calendar/TimeBlockRow",["i18n!calendar","jst/calendar/TimeBlockRow"],function(c,d){var e;return e=function(){function e(b,c){var e=this;this.TimeBlockList=b,c==null&&(c={}),this.focus=a(this.focus,this),this.remove=a(this.remove,this),this.locked=c.locked,this.$row=$(d(c)).bind({focusin:this.focus,focusout:function(){return e.$row.removeClass("focused")}}),this.inputs={},this.locked||(this.$row.find(".date_field").date_field(),this.$row.find(".time_field").time_field()),$.each(this.inputNames,function(a,b){e.inputs[b]={},e.inputs[b].$el=e.$row.find("input[name='"+b+"']").change(function(){return e.handleInputChange(b)}),e.updateModel(b);if(e.locked)return e.inputs[b].valid=!0}),this.$row.find(".delete-block-link").click(this.remove)}return e.name="TimeBlockRow",e.prototype.inputNames=["date","start_time","end_time"],e.prototype.updateModel=function(a){return this.inputs[a].val=$.trim(this.inputs[a].$el.val())},e.prototype.handleInputChange=function(a){this.updateModel(a),this.validateField(a),this.validate()},e.prototype.updateDom=function(a,b){return this.inputs[a].val=b,this.inputs[a].$el.val(b)},e.prototype.remove=function(a){return a!=null&&a.preventDefault(),this.$row.remove(),this.TimeBlockList.rowRemoved(this)},e.prototype.focus=function(){this.$row.addClass("focused");if(this.$row.is(":last-child"))return this.$row.parents(".time-block-list-body-wrapper").scrollTop(9999)},e.prototype.validateField=function(a){var b,c;return b=this.inputs[a].$el.nextAll(".datetime_suggest"),c=b.hasClass("invalid_datetime"),c||this.updateDom(a,b.text()),this.inputs[a].$el.toggleClass("error",c),this.inputs[a].valid=!c},e.prototype.validate=function(){var a,d,e,f,g,h;if(this.locked)return!0;f=!0,g=this.inputs;for(d in g){if(!b.call(g,d))continue;a=g[d],(h=a.$el.data("associated_error_box"))!=null&&h.remove(),this.validateField(d)||(f=!1)}return f&&!this.blank()&&(this.validDate()&&this.inputs.end_time.val&&this.endAt()<new Date&&(f=!1,this.inputs.end_time.$el.addClass("error").errorBox(c.t("ends_in_past_error","You cannot create an appointment slot that ends in the past"))),this.inputs.start_time.val&&this.inputs.end_time.val&&(e=this.validDate()||"Today",this.timeToDate(e,this.inputs.end_time.val)<=this.timeToDate(e,this.inputs.start_time.val)&&(f=!1,this.inputs.start_time.$el.addClass("error").errorBox(c.t("end_before_start_error","Start time must be before end time"))))),this.blank()||f},e.prototype.timeToDate=function(a,b){return Date.parse(a+" "+b)},e.prototype.endAt=function(){if(this.validDate())return this.timeToDate(this.inputs.date.val,this.inputs.end_time.val)},e.prototype.startAt=function(){if(this.validDate())return this.timeToDate(this.inputs.date.val,this.inputs.start_time.val)},e.prototype.validDate=function(){if(this.inputs.date.val&&this.inputs.date.valid)return this.inputs.date.val},e.prototype.getData=function(){return[this.startAt(),this.endAt(),!!this.locked]},e.prototype.blank=function(){return this.inputs.date.val===""&&this.inputs.start_time.val===""&&this.inputs.end_time.val===""},e}()})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/calendar/TimeBlockList",["jquery","i18n!calendar","compiled/calendar/TimeBlockListManager","compiled/calendar/TimeBlockRow","jquery.instructure_date_and_time","jquery.instructure_forms","vendor/date"],function(b,c,d,e){var f;return f=function(){function f(c,e,f){this.handleSplitClick=a(this.handleSplitClick,this),this.addRow=a(this.addRow,this);var g=this;this.element=b(c),this.splitterDiv=b(e),this.blocksManager=new d(f),this.splitterDiv.find(".split-link").click(this.handleSplitClick),this.element.delegate("input","change",function(a){if(b(a.currentTarget).closest("tr").is(":last-child"))return g.addRow()}),this.render()}return f.name="TimeBlockList",f.prototype.render=function(){var a,b,c,d;this.rows=[],this.element.empty(),d=this.blocksManager.blocks;for(b=0,c=d.length;b<c;b++)a=d[b],this.addRow(a);return this.addRow()},f.prototype.rowRemoved=function(a){var b,c;this.rows=function(){var d,e,f,g;f=this.rows,g=[];for(d=0,e=f.length;d<e;d++){c=f[d];if(c===a)continue;c.locked||(b=!0),g.push(c)}return g}.call(this);if(!b)return this.addRow()},f.prototype.addRow=function(a){var b;return b=new e(this,a),this.element.append(b.$row),this.rows.push(b),b},f.prototype.handleSplitClick=function(a){var b;return a.preventDefault(),b=this.splitterDiv.find("[name=duration]").val(),this.split(b)},f.prototype.split=function(a){if(a&&this.validate())return this.blocksManager.split(a),this.render()},f.prototype.validate=function(){var a,b,d,e,f,g;b=!0,this.blocksManager.reset(),f=this.rows;for(d=0,e=f.length;d<e;d++)a=f[d],a.validate()?a.blank()||(g=this.blocksManager).add.apply(g,a.getData()):b=!1;return b||alert(c.t("time_block_errors","There are errors in your time block selections.")),b},f.prototype.blocks=function(){var a,b,c,d,e;d=this.blocksManager.blocks,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],a.locked||e.push([a.start,a.end]);return e},f}()})}.call(this),define("jst/calendar/editCalendarEvent",["compiled/handlebars_helpers","i18n!calendar.edit_calendar_event"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/editCalendarEvent"]=b(function(a,b,c,d,e){function q(a,b){var d="",e;return d+="\n          ",e=c.title||a.title,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"title",{hash:{}})),d+=p(e)+"\n        ",d}function r(a,b){var d="",e;return d+='\n          <input id="calendar_event_title" name="calendar_event[title]" size="30" style="width: 150px;" type="text" value="',e=c.title||a.title,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"title",{hash:{}})),d+=p(e)+'"/>\n        ',d}function s(a,b){var d="",e,f;d+="\n            ",e=c.can_create_calendar_events||a.can_create_calendar_events,f=c["if"],k=l.program(6,t,b),k.hash={},k.fn=k,k.inverse=l.noop,e=f.call(a,e,k);if(e||e===0)d+=e;return d+="\n          ",d}function t(a,b){var d="",e;return d+='\n              <option value="',e=c.asset_string||a.asset_string,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"asset_string",{hash:{}})),d+=p(e)+'">',e=c.name||a.name,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"name",{hash:{}})),d+=p(e)+"</option>\n            ",d}c=c||a.helpers;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0,p=this.escapeExpression;f+="<form action='#' id='edit_calendar_event_form' style='padding: 5px; width: 400px'>\n  <table class=\"formtable\" style=\"width: 100%;\">\n    <tr>\n      <td style=\"vertical-align: top;\">",g="Title:",h="title",i={},j="calendar.editCalendarEvent",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+="</td>\n      <td>\n        ",g=c.lockedTitle||b.lockedTitle,h=c["if"],k=l.program(1,q,e),k.hash={},k.fn=k,k.inverse=l.program(3,r,e),g=h.call(b,g,k);if(g||g===0)f+=g;f+='\n      </td>\n    </tr>\n    <tr>\n      <td style="vertical-align: top;">',g="Date:",h="date",i={},j="calendar.editCalendarEvent",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</td>\n      <td><input type="text" name="date" style="width: 100px;" class="date_field"/></td>\n    </tr>\n    <tr>\n      <td style="vertical-align: top;">',g="From:",h="from",i={},j="calendar.editCalendarEvent",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</td>\n      <td>\n        <div style="float: left;"><input type="text" name="start_time" style="width: 60px;" class="time_field start_time"/></div>\n        ',g="* to *",h="timespan_separator",i={},j="calendar.editCalendarEvent",i.scope=j,j='<div style="float: left; margin: 5px">$1</div>',i.w0=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='\n        <div style="float: left;"><input type="text" name="end_time" style="width: 60px;" class="time_field end_time"/></div>\n        <div class="clear"></div>\n      </td>\n    </tr>\n    <tr class="context_select">\n      <td>',g="Calendar:",h="calendar",i={},j="calendar.editCalendarEvent",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</td>\n      <td>\n        <select class="context_id" name="calendar_event[context_code]">\n          ',g=c.contexts||b.contexts,h=c.each,k=l.program(5,s,e),k.hash={},k.fn=k,k.inverse=l.noop,g=h.call(b,g,k);if(g||g===0)f+=g;f+='\n        </select>\n      </td>\n    </tr><tr>\n      <td></td>\n      <td><a href="#" class="more_options_link">',g="more options",h="links.more_options",i={},j="calendar.editCalendarEvent",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</a></td>\n    </tr><tr>\n      <td colspan="2" class="button-container" style="text-align: right">\n        <button type="submit" class="button">',g="Submit",h="buttons.submit",i={},j="calendar.editCalendarEvent",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;return f+="</button>\n      </td>\n    </tr>\n  </table>\n</form>\n",f}),c["calendar/editCalendarEvent"]}),define("jst/calendar/genericSelect",["compiled/handlebars_helpers"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/genericSelect"]=b(function(a,b,c,d,e){function o(a,b){var d="",e,f;d+='\n    <option value="',e=c.asset_string||a.asset_string,f=c["if"],i=j.program(2,p,b),i.hash={},i.fn=i,i.inverse=j.program(4,q,b),e=f.call(a,e,i);if(e||e===0)d+=e;return d+='">',e=c.name||a.name,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"name",{hash:{}})),d+=n(e)+"</option>\n  ",d}function p(a,b){var d;return d=c.asset_string||a.asset_string,typeof d===k?d=d.call(a,{hash:{}}):d===m&&(d=l.call(a,"asset_string",{hash:{}})),n(d)}function q(a,b){var d;return d=c.id||a.id,typeof d===k?d=d.call(a,{hash:{}}):d===m&&(d=l.call(a,"id",{hash:{}})),n(d)}c=c||a.helpers;var f="",g,h,i,j=this,k="function",l=c.helperMissing,m=void 0,n=this.escapeExpression;f+='<select class="',g=c.cssClass||b.cssClass,typeof g===k?g=g.call(b,{hash:{}}):g===m&&(g=l.call(b,"cssClass",{hash:{}})),f+=n(g)+'" name="',g=c.name||b.name,typeof g===k?g=g.call(b,{hash:{}}):g===m&&(g=l.call(b,"name",{hash:{}})),f+=n(g)+'">\n  ',g=c.collection||b.collection,h=c.each,i=j.program(1,o,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;return f+="\n</select>",f}),c["calendar/genericSelect"]}),define("jst/calendar/editAssignment",["compiled/handlebars_helpers","i18n!calendar.edit_assignment"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/editAssignment"]=b(function(a,b,c,d,e){function q(a,b){var d="",e,f;d+="\n            ",e=c.can_create_assignments||a.can_create_assignments,f=c["if"],k=l.program(2,r,b),k.hash={},k.fn=k,k.inverse=l.noop,e=f.call(a,e,k);if(e||e===0)d+=e;return d+="\n          ",d}function r(a,b){var d="",e;return d+='\n              <option value="',e=c.asset_string||a.asset_string,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"asset_string",{hash:{}})),d+=p(e)+'">',e=c.name||a.name,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"name",{hash:{}})),d+=p(e)+"</option>\n            ",d}c=c||a.helpers;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0,p=this.escapeExpression;f+="<form action='#' id='edit_assignment_form' style='padding: 5px; width: 400px'>\n  <table class=\"formtable\" style=\"width: 100%;\">\n    <tr>\n      <td>",g="Title:",h="title",i={},j="calendar.editAssignment",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</td>\n      <td><input id="assignment_title" name="assignment[title]" size="30" style="width: 200px;" type="text" value="',g=c.title||b.title,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"title",{hash:{}})),f+=p(g)+'"/></td>\n    </tr>\n    <tr>\n      <td>',g="Due:",h="due",i={},j="calendar.editAssignment",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</td>\n      <td>\n        <input class="datetime_field" id="assignment_due_at" name="assignment[due_at]" size="30" style="width: 150px;" type="text" />\n      </td>\n    </tr>\n    <tr class="context_select">\n      <td>',g="Calendar:",h="calendar",i={},j="calendar.editAssignment",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</td>\n      <td>\n        <select class="context_id">\n          ',g=c.contexts||b.contexts,h=c.each,k=l.program(1,q,e),k.hash={},k.fn=k,k.inverse=l.noop,g=h.call(b,g,k);if(g||g===0)f+=g;f+="\n        </select>\n      </td>\n    </tr>\n    <tr>\n      <td>",g="Group:",h="group",i={},j="calendar.editAssignment",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</td>\n      <td class="assignment_group_select">\n        <select class="assignment_group" name="assignment[assignment_group_id]">\n          <option value="new">[ New Group ]</option>\n        </select>\n      </td>\n    </tr>\n    <tr>\n      <td></td>\n      <td><a href="#" class="more_options_link">',g="more options",h="links.more_options",i={},j="calendar.editAssignment",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</a></td>\n    </tr>\n    <tr>\n      <td colspan="2" style="text-align: right">\n        <button type="submit" class="button">',g="Submit",h="buttons.submit",i={},j="calendar.editAssignment",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;return f+="</button>\n      </td>\n    </tr>\n  </table>\n</form>",f}),c["calendar/editAssignment"]}),define("jst/calendar/editApptCalendarEvent",["compiled/handlebars_helpers","i18n!calendar.edit_appt_calendar_event"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/editApptCalendarEvent"]=b(function(a,b,c,d,e){c=c||a.helpers;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0,p=this.escapeExpression;f+='<form action="',g=c.calendarEvent||b.calendarEvent,g=g===null||g===undefined||g===!1?g:g.appointment_group_url,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"calendarEvent.appointment_group_url",{hash:{}})),f+=p(g)+'" id="edit_appt_calendar_event_form">\n  <p>\n    <strong>',g="Description:",h="description",i={},j="calendar.editApptCalendarEvent",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</strong><br>\n    <textarea name="description">',g=c.description||b.description,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"description",{hash:{}})),f+=p(g)+'</textarea>\n  </p>\n  <p>\n    <input type="checkbox" name="max_participants_option">\n    ',g="Limit this slot to",h="slot_limit",i={},j="calendar.editApptCalendarEvent",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='\n    <input type="number" name="max_participants" class="max-participants" min="1" disabled>\n    ',g="users.",h="users",i={},j="calendar.editApptCalendarEvent",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;return f+="\n  </p>\n</form>\n",f}),c["calendar/editApptCalendarEvent"]}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/calendar/EditApptCalendarEventDialog",["i18n!appt_calendar_event_dialog","jst/calendar/editApptCalendarEvent"],function(b,c){var d;return d=function(){function d(d){var e,f=this;this.event=d,this.save=a(this.save,this),this.form=$("<div></div>").html(c(this.event)).appendTo("body"),e=this.form.find("[name=max_participants_option]"),this.$maxParticipants=this.form.find("[name=max_participants]"),e.change(function(){return f.$maxParticipants.prop("disabled",!e.prop("checked"))}),this.event.calendarEvent.participants_per_appointment&&(e.click(),this.$maxParticipants.val(this.event.calendarEvent.participants_per_appointment)),this.dialog=this.form.dialog({autoOpen:!1,width:"auto",resizable:!1,title:b.t("title","Edit %{name}",{name:this.event.title}),buttons:[{text:b.t("update","Update"),"class":"button",click:this.save}]})}return d.name="EditApptCalendarEventDialog",d.prototype.show=function(){return this.dialog.dialog("open")},d.prototype.save=function(){var a,c,d,e;return a=this.dialog.getFormData(),c=a.max_participants_option==="on",d=a.max_participants,c&&d<=0?(this.$maxParticipants.errorBox(b.t("invalid_participants","You must allow at least one user to attend")),!1):(this.event.calendarEvent.description=a.description,c?(this.event.calendarEvent.total_slots=d,this.event.calendarEvent.remaining_slots=d-this.event.calendarEvent.child_events.length):(this.event.calendarEvent.total_slots=void 0,this.event.calendarEvent.remaining_slots=void 0),e=c?d:"",this.event.save({"calendar_event[description]":a.description,"calendar_event[participants_per_appointment]":e}),this.dialog.dialog("destroy"),this.form.remove())},d}()})}.call(this),define("jst/calendar/editAppointmentGroup",["compiled/handlebars_helpers","i18n!calendar.edit_appointment_group"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/editAppointmentGroup"]=b(function(a,b,c,d,e){function r(a,b){return"checked"}function s(a,b){return" "}function t(a,b){return' style="display:none;" '}function u(a,b){return' style="display:none;" '}c=c||a.helpers;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0,p=this.escapeExpression,q=c.blockHelperMissing;f+="<form action='#' id='edit_appointment_form'>\n  <div class=\"left-column-wrapper\">\n    <p>\n      <b>",g="Name",h="name",i={},j="calendar.editAppointmentGroup",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</b><br />\n      <input type="text" name="title" style="width: 190px" value="',g=c.appointment_group||b.appointment_group,g=g===null||g===undefined||g===!1?g:g.title,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"appointment_group.title",{hash:{}})),f+=p(g)+'">\n    </p>\n    <p>\n      <b>',g="Location",h="location",i={},j="calendar.editAppointmentGroup",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</b><br />\n      <input type="text" name="location" style="width: 190px" value="',g=c.appointment_group||b.appointment_group,g=g===null||g===undefined||g===!1?g:g.location_name,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"appointment_group.location_name",{hash:{}})),f+=p(g)+'">\n    </p>\n    <div class="select-calendar-container">\n      <b>',g="Calendar",h="calendar",i={},j="calendar.editAppointmentGroup",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</b><br />\n      <button class="button ag_contexts_selector"></button>\n      <div class="ag-menu-container"></div>\n    </div>\n    <p>\n      <input type="checkbox" class="group-signup-checkbox" id="group-signup-checkbox" name="use_group_signup" value="1" ',g="Group",h=c.participant_type||b.participant_type,i=c.ifEqual||b.ifEqual,k=l.program(1,r,e),k.hash={},k.fn=k,k.inverse=l.noop,typeof i===m?g=i.call(b,h,g,k):g=q.call(b,i,h,g,k);if(g||g===0)f+=g;f+='>\n      <label for="group-signup-checkbox">Have students sign up in groups.</label>\n    </p>\n    <div class="group-signup" style="display: none">\n      <b>',g="Group Category",h="group_category",i={},j="calendar.editAppointmentGroup",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</b><br />\n      <div class="group_select">\n        <select name="group_category_id"></select>\n      </div>\n    </div>\n  </div>\n  <div class="right-column-wrapper">\n    <div class="time-block-list-wrapper">\n      <div class="time-block-list">\n        <table class="time-block-list-header">\n          <tr>\n            <th class="date-column">Date</th>\n            <th class="time-range-column" colspan="4">Time Range</th>\n          </tr>\n        </table>\n        <div class="time-block-list-body-wrapper">\n          <table class="time-block-list-body"></table>\n        </div>\n        <div class="splitter" style="font-size: 0.8em">\n          <p>\n            <a class="split-link button small-button" href="#">Split</a>into slots of <input type="number" name="duration" value="30" style="width: 40px" /> minutes each.\n          </p>\n        </div>\n      </div>\n    </div>\n    <div style="margin-top: 1.5em">\n      <b>Options</b>\n      <ul class="ag-options">\n        <li>\n          <input type="checkbox" id="appointment-blocks-per-slot-option-button" name="per_slot_option" value="1" />\n          <label for="appointment-blocks-per-slot-option-button">Limit each time slot to</label>\n          <input type="number" name="participants_per_appointment" value="',g=c.appointment_group||b.appointment_group,g=g===null||g===undefined||g===!1?g:g.participants_per_appointment,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"appointment_group.participants_per_appointment",{hash:{}})),f+=p(g)+'" style="width: 40px;" />\n          <label for="appointment-blocks-per-slot-option-button">\n            <span ',g="Group",h=c.participant_type||b.participant_type,i=c.ifEqual||b.ifEqual,k=l.program(3,s,e),k.hash={},k.fn=k,k.inverse=l.program(5,t,e),typeof i===m?g=i.call(b,h,g,k):g=q.call(b,i,h,g,k);if(g||g===0)f+=g;f+=' class="per_appointment_groups_label">groups.</span>\n            <span ',g="Group",h=c.participant_type||b.participant_type,i=c.ifEqual||b.ifEqual,k=l.program(7,u,e),k.hash={},k.fn=k,k.inverse=l.noop,typeof i===m?g=i.call(b,h,g,k):g=q.call(b,i,h,g,k);if(g||g===0)f+=g;return f+=' class="per_appointment_users_label">users.</span>\n          </label>\n        </li>\n        <li>\n          <input type="checkbox" id="appointment-blocks-participant-visibility-button" name="participant_visibility" value="1" />\n          <label for="appointment-blocks-participant-visibility-button">Allow students to see who has signed up for time slots.</label>\n        </li>\n        <li>\n          <input type="checkbox" id="max-per-student-option" name="max_appointments_per_participant_option" value="1">\n          <label for="max-per-student-option">Limit participants to</label>\n          <input type="number" name="max_appointments_per_participant" value="',g=c.appointment_group||b.appointment_group,g=g===null||g===undefined||g===!1?g:g.max_appointments_per_participant,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"appointment_group.max_appointments_per_participant",{hash:{}})),f+=p(g)+'" min="1"style="width: 40px">\n          <label for="max-per-student-option">appointment(s).</label>\n        </li>\n      </ul>\n    </div>\n  </div>\n  <div class="details-wrapper">\n    <b>Details:</b><br />\n    <textarea name="description" style="width: 100%">',g=c.appointment_group||b.appointment_group,g=g===null||g===undefined||g===!1?g:g.description,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"appointment_group.description",{hash:{}})),f+=p(g)+"</textarea>\n  </div>\n</form>\n",f}),c["calendar/editAppointmentGroup"]}),define("jst/calendar/sectionCheckboxes",["compiled/handlebars_helpers"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/sectionCheckboxes"]=b(function(a,b,c,d,e){function o(a,b){var d="",e,f;d+='\n    <li>\n      <input type="checkbox" name="section_ids[]" value="',e=c.asset_string||a.asset_string,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"asset_string",{hash:{}})),d+=n(e)+'" id="',e=c.asset_string||a.asset_string,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"asset_string",{hash:{}})),d+=n(e)+'_checkbox" ',e=c.selected||a.selected,f=c["if"],i=j.program(2,p,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;return d+='>\n      <label for="',e=c.asset_string||a.asset_string,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"asset_string",{hash:{}})),d+=n(e)+'_checkbox">',e=c.name||a.name,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"name",{hash:{}})),d+=n(e)+"</label>\n    </li>\n  ",d}function p(a,b){return"checked"}c=c||a.helpers;var f="",g,h,i,j=this,k="function",l=c.helperMissing,m=void 0,n=this.escapeExpression;f+="<ul>\n  ",g=c.sections||b.sections,h=c.each,i=j.program(1,o,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;return f+="\n</ul>\n",f}),c["calendar/sectionCheckboxes"]}),define("jst/calendar/contextSelector",["compiled/handlebars_helpers","i18n!calendar.context_selector"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/contextSelector"]=b(function(a,b,c,d,e){c=c||a.helpers;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0;f+='<div class="ag_contexts_menu hidden">\n  <ul class="ag-contexts"></ul>\n  <button class="button small-button ag_contexts_done">',g="Done",h="done",i={},j="calendar.contextSelector",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;return f+="</button>\n</div>\n",f}),c["calendar/contextSelector"]}),define("jst/calendar/contextSelectorItem",["compiled/handlebars_helpers"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/contextSelectorItem"]=b(function(a,b,c,d,e){function o(a,b){var d="",e;return d+='\n      <li>\n        <input type="checkbox" name="sections[]" value="',e=c.asset_string||a.asset_string,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"asset_string",{hash:{}})),d+=n(e)+'" id="option_',e=c.asset_string||a.asset_string,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"asset_string",{hash:{}})),d+=n(e)+'">\n        <label for="option_',e=c.asset_string||a.asset_string,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"asset_string",{hash:{}})),d+=n(e)+'">',e=c.name||a.name,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"name",{hash:{}})),d+=n(e)+"</label>\n      </li>\n    ",d}c=c||a.helpers;var f="",g,h,i,j=this,k="function",l=c.helperMissing,m=void 0,n=this.escapeExpression;f+='<li>\n  <a class="ag_sections_toggle"></a>\n  <input type="checkbox" name="context_codes[]" value="',g=c.asset_string||b.asset_string,typeof g===k?g=g.call(b,{hash:{}}):g===m&&(g=l.call(b,"asset_string",{hash:{}})),f+=n(g)+'" id="option_',g=c.asset_string||b.asset_string,typeof g===k?g=g.call(b,{hash:{}}):g===m&&(g=l.call(b,"asset_string",{hash:{}})),f+=n(g)+'">\n  <label for="option_',g=c.asset_string||b.asset_string,typeof g===k?g=g.call(b,{hash:{}}):g===m&&(g=l.call(b,"asset_string",{hash:{}})),f+=n(g)+'">',g=c.name||b.name,typeof g===k?g=g.call(b,{hash:{}}):g===m&&(g=l.call(b,"name",{hash:{}})),f+=n(g)+'</label>\n  <ul class="ag_sections hidden">\n    ',g=c.course_sections||b.course_sections,h=c.each,i=j.program(1,o,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;return f+="\n  </ul>\n</li>\n",f}),c["calendar/contextSelectorItem"]}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/calendar/ContextSelector",["jquery","underscore","jst/calendar/contextSelector","jst/calendar/contextSelectorItem","compiled/fn/preventDefault"],function(b,c,d,e,f){var g,h;return h=function(){function d(b){this.context=b,this.sectionChange=a(this.sectionChange,this),this.setState=a(this.setState,this),this.change=a(this.change,this),this.toggleSections=a(this.toggleSections,this),this.state="off",this.locked=!1}return d.name="ContextSelectorItem",d.prototype.render=function(a){return this.$listItem=b(e(this.context)),this.$listItem.appendTo(a),this.$sectionsList=this.$listItem.find(".ag_sections"),this.$listItem.find(".ag_sections_toggle").click(f(this.toggleSections)),this.$contentCheckbox=this.$listItem.find('[name="context_codes[]"]'),this.$contentCheckbox.change(f(this.change)),this.$sectionCheckboxes=this.$listItem.find('[name="sections[]"]'),this.$sectionCheckboxes.change(this.sectionChange)},d.prototype.toggleSections=function(a){return b(a.target).toggleClass("ag-sections-expanded"),this.$sectionsList.toggleClass("hidden")},d.prototype.change=function(){var a;return a=function(){switch(this.state){case"off":return"on";case"on":return"off";case"partial":return"on"}}.call(this),this.setState(a)},d.prototype.setState=function(a){var c;if(this.locked)return;this.state=a;switch(this.state){case"on":case"off":c=this.state==="on",this.$contentCheckbox.prop("checked",c),this.$contentCheckbox.prop("indeterminate",!1),this.$sectionCheckboxes.prop("checked",c);break;case"partial":this.$contentCheckbox.prop("checked",!0),this.$contentCheckbox.prop("indeterminate",!0)}return b.publish("/contextSelector/changed")},d.prototype.sectionChange=function(){switch(this.$sectionCheckboxes.filter(":checked").length){case 0:return this.setState("off");case this.$sectionCheckboxes.length:return this.setState("on");default:return this.setState("partial")}},d.prototype.disable=function(){return this.$contentCheckbox.prop("disabled",!0),this.disableSections()},d.prototype.disableSections=function(){return this.$sectionCheckboxes.prop("disabled",!0)},d.prototype.lock=function(){return this.locked=!0,this.disable(),this.disableSections()},d.prototype.isChecked=function(){return this.state!=="off"},d.prototype.sections=function(){var a;return a=this.$sectionCheckboxes.filter(":checked"),a.length===this.$sectionCheckboxes.length?[]:c.map(a,function(a){return a.value})},d}(),g=function(){function a(a,c,e,g,i){var j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H=this;this.apptGroup=c,this.contexts=e,this.$menu=b(a).html(d()),j=this.$menu.find(".ag-contexts"),b.subscribe("/contextSelector/changed",function(){return g(H.selectedContexts(),H.selectedSections())}),this.contextSelectorItems={},B=this.contexts;for(r=0,v=B.length;r<v;r++)k=B[r],o=new h(k),o.render(j),this.contextSelectorItems[o.context.asset_string]=o;C=this.apptGroup.context_codes;for(s=0,w=C.length;s<w;s++){m=C[s];if(!this.contextSelectorItems[m])continue;this.contextSelectorItems[m].setState("on"),this.contextSelectorItems[m].lock()}if(this.apptGroup.sub_context_codes.length>0)if(this.apptGroup.sub_context_codes[0].match(/^group_category_/)){D=this.contextSelectorItems;for(k in D)o=D[k],o.lock()}else{n={},E=this.contexts;for(t=0,x=E.length;t<x;t++){k=E[t],F=k.course_sections;for(u=0,y=F.length;u<y;u++)p=F[u],n[p.asset_string]=k.asset_string}G=this.apptGroup.sub_context_codes;for(A=0,z=G.length;A<z;A++)q=G[A],b("[value='"+q+"']").prop("checked",!0),l=n[q],o=this.contextSelectorItems[l],o.sectionChange(),o.lock()}b(".ag_contexts_done").click(f(i)),g(this.selectedContexts(),this.selectedSections())}return a.name="ContextSelector",a.prototype.selectedContexts=function(){var a;return a=c.chain(this.contextSelectorItems).values().filter(function(a){return a.state!=="off"}).map(function(a){return a.context.asset_string}).value(),a},a.prototype.selectedSections=function(){var a;return a=c.chain(this.contextSelectorItems).values().map(function(a){return a.sections()}).reject(function(a){return a.length===0}).flatten().value(),a},a}()})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/calendar/EditAppointmentGroupDetails",["jquery","underscore","i18n!EditAppointmentGroupDetails","compiled/calendar/TimeBlockList","jst/calendar/editAppointmentGroup","jst/calendar/genericSelect","jst/calendar/sectionCheckboxes","compiled/calendar/ContextSelector","compiled/fn/preventDefault","jquery.ajaxJSON","jquery.disableWhileLoading","jquery.instructure_forms"],function(b,c,d,e,f,g,h,i,j){var k;return k=function(){function h(c,d,g,h){var k,l,m,n,o,p,q,r,s,t=this;this.apptGroup=d,this.contexts=g,this.closeCB=h,this.toggleContextsMenu=a(this.toggleContextsMenu,this),this.contextsChanged=a(this.contextsChanged,this),this.save=a(this.save,this),this.saveClick=a(this.saveClick,this),this.saveWithoutPublishingClick=a(this.saveWithoutPublishingClick,this),this.currentContextInfo=null,b(c).html(f({title:this.apptGroup.title,contexts:this.contexts,appointment_group:this.apptGroup})),this.contextsHash={},s=this.contexts;for(q=0,r=s.length;q<r;q++)l=s[q],this.contextsHash[l.asset_string]=l;this.form=b(c).find("form"),this.contextSelector=new i(".ag-menu-container",this.apptGroup,this.contexts,this.contextsChanged,this.toggleContextsMenu),this.apptGroup.id?(this.form.attr("action",this.apptGroup.url),this.form.find(".context_id").val(this.apptGroup.context_code).attr("disabled",!0),this.form.find("select.context_id").change(),this.disableGroups(),this.apptGroup.participant_type==="Group"?(this.form.find(".group-signup-checkbox").prop("checked",!0),this.form.find(".group_category").val(this.apptGroup.sub_context_codes[0])):this.form.find(".group-signup-checkbox").prop("checked",!1)):this.form.attr("action","/api/v1/appointment_groups"),this.form.find(".ag_contexts_selector").click(j(this.toggleContextsMenu)),p=function(){var a,b,c,d;c=this.apptGroup.appointmentEvents||[],d=[];for(a=0,b=c.length;a<b;a++)k=c[a],d.push([k.start,k.end,!0]);return d}.call(this),this.timeBlockList=new e(this.form.find(".time-block-list-body"),this.form.find(".splitter"),p),this.form.find('[name="slot_duration"]').change(function(a){if(t.form.find('[name="autosplit_option"]').is(":checked"))return t.timeBlockList.split(a.target.value),t.timeBlockList.render()}),this.form.find('[name="participant_visibility"]').prop("checked",this.apptGroup.participant_visibility==="protected"),this.form.find(".group-signup-checkbox").change(function(a){var b;return b=!!a.target.checked,t.form.find(".per_appointment_groups_label").toggle(b),t.form.find(".per_appointment_users_label").toggle(!b),t.form.find(".group-signup").toggle(b)}),this.form.find(".group-signup-checkbox").change(),this.form.find('[name="per_slot_option"]').change(function(a){var b,c;b=a.target,c=t.form.find('[name="participants_per_appointment"]');if(!b.checked)return c.attr("disabled",!0);c.attr("disabled",!1);if(c.val()==="")return c.val("1")}),this.apptGroup.participants_per_appointment>0?(this.form.find('[name="per_slot_option"]').prop("checked",!0),this.form.find('[name="participants_per_appointment"]').val(this.apptGroup.participants_per_appointment)):this.form.find('[name="participants_per_appointment"]').attr("disabled",!0),o=this.form.find('[name="max_appointments_per_participant"]'),m=this.apptGroup.max_appointments_per_participant||1,o.val(m),n=this.form.find("#max-per-student-option"),n.change(function(){return o.prop("disabled",!n.prop("checked"))}),m>0?n.prop("checked",!0):o.attr("disabled",!0),this.apptGroup.workflow_state==="active"&&this.form.find("#appointment-blocks-active-button").attr("disabled",!0).prop("checked",!0)}return h.name="EditAppointmentGroupDetails",h.prototype.saveWithoutPublishingClick=function(a){return a.preventDefault(),this.save(!1)},h.prototype.saveClick=function(a){return a.preventDefault(),this.save(!0)},h.prototype.save=function(a){var c,e,f,g,h,i,j,k,l,m,n,o,p,q=this;f=this.form.getFormData({object_name:"appointment_group"}),e=this.apptGroup.id===void 0,k={"appointment_group[title]":f.title,"appointment_group[description]":f.description,"appointment_group[location_name]":f.location};if(f.max_appointments_per_participant_option){if(f.max_appointments_per_participant<1)return b('[name="max_appointments_per_participant"]').errorBox(d.t("bad_max_appts","You must allow at least one appointment per participant")),!1;k["appointment_group[max_appointments_per_participant]"]=f.max_appointments_per_participant}else k["appointment_group[max_appointments_per_participant]"]="";k["appointment_group[new_appointments]"]=[];if(!this.timeBlockList.validate())return!1;p=this.timeBlockList.blocks();for(n=0,o=p.length;n<o;n++)l=p[n],k["appointment_group[new_appointments]"].push([b.dateToISO8601UTC(b.unfudgeDateForProfileTimezone(l[0])),b.dateToISO8601UTC(b.unfudgeDateForProfileTimezone(l[1]))]);f.per_slot_option==="1"&&f.participants_per_appointment&&(k["appointment_group[participants_per_appointment]"]=f.participants_per_appointment),a&&this.apptGroup.workflow_state!=="active"&&(k["appointment_group[publish]"]="1"),k["appointment_group[participant_visibility]"]=f.participant_visibility==="1"?"protected":"private",delete f["context_codes[]"],delete f["sections[]"],c=this.contextSelector.selectedContexts();if(c.length===0){b(".ag_contexts_selector").errorBox(d.t("context_required","You need to select a calendar"));return}return k["appointment_group[context_codes]"]=c,e&&(f.use_group_signup==="1"&&f.group_category_id?k["appointment_group[sub_context_codes]"]=[f.group_category_id]:(m=this.contextSelector.selectedSections(),m&&(k["appointment_group[sub_context_codes]"]=m)),k["appointment_group[min_appointments_per_participant]"]=1),j=function(){return q.closeCB(!0)},i=function(){},h=this.apptGroup.id?"PUT":"POST",g=b.ajaxJSON(this.form.attr("action"),h,k,j,i),this.form.disableWhileLoading(g)},h.prototype.contextsChanged=function(a,b){var e,f,g,h,i,j;b.length===0&&a.length===0?this.form.find(".ag_contexts_selector").text(d.t("select_calendars","Select Calendars")):(a.length>0&&(f=a[0],i=this.contextsHash[f].name,a.length>1&&(i+=d.t("and_n_contexts"," and %{n} others",{n:a.length-1})),this.form.find(".ag_contexts_selector").text(i)),b.length>0&&(h=b[0],g=c.chain(this.contexts).pluck("course_sections").flatten().find(function(a){return a.asset_string===h}).value(),i=g.name,b.length>1&&(i+=d.t("and_n_sectionCodes"," and %{n} others",{n:b.length-1})),this.form.find(".ag_contexts_selector").text(i))),e=this.contextsHash[a[0]];if(a.length!==1||b.length!==0||((j=e.group_categories)!=null?j.length:void 0)<=0)return this.disableGroups();this.enableGroups(e);if(this.apptGroup.sub_context_codes.length>0)return this.form.find("[name=group_category_id]").prop("disabled",!0)},h.prototype.disableGroups=function(){return this.form.find(".group-signup-checkbox").attr("disabled",!0),this.form.find("group-signup").hide()},h.prototype.enableGroups=function(a){var b;return this.form.find(".group-signup-checkbox").attr("disabled",!1),b={cssClass:"group_category",name:"group_category_id",collection:a.group_categories},this.form.find(".group_select").html(g(b)),this.form.find("group-signup").show()},h.prototype.toggleContextsMenu=function(a){return b(".ag_contexts_menu").toggleClass("hidden")},h}()})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/calendar/EditAppointmentGroupDialog",["jquery","i18n!calendar","compiled/calendar/EditAppointmentGroupDetails","jst/calendar/editAppointmentGroup","jqueryui/dialog"],function(b,c,d,e){var f,g;return g=b('<div id="edit_event"><div class="wrapper"></div>').appendTo("body").dialog({autoOpen:!1,width:"auto",resizable:!1,title:c.t("titles.edit_appointment_group","Edit Appointment Group")}),g.dialog("widget").find("#edit_event").css("overflow","visible"),f=function(){function b(b,c,d){this.apptGroup=b,this.contexts=c,this.parentCloseCB=d,this.show=a(this.show,this),this.closeCB=a(this.closeCB,this),this.currentContextInfo=null}return b.name="EditAppointmentGroupDialog",b.prototype.closeCB=function(a){return g.dialog("close"),this.parentCloseCB(a)},b.prototype.show=function(){var a;return this.appointmentGroupsForm=new d(g.find(".wrapper"),this.apptGroup,this.contexts,this.closeCB),a=this.apptGroup.workflow_state==="active"?[{text:c.t("save_changes","Save Changes"),click:this.appointmentGroupsForm.saveClick}]:[{text:c.t("save_and_publish","Save & Publish"),"class":"ui-button-primary",click:this.appointmentGroupsForm.saveClick},{text:c.t("save","Save"),click:this.appointmentGroupsForm.saveWithoutPublishingClick}],g.dialog("option","buttons",a).dialog("open")},b}()})}.call(this),define("jst/calendar/editEvent",["compiled/handlebars_helpers","i18n!calendar.edit_event"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/editEvent"]=b(function(a,b,c,d,e){c=c||a.helpers;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0;f+='<div class="content" id="edit_event_tabs">\n  <ul class="tab_list">\n    <li><a href="#edit_calendar_event_form_holder" class="edit_calendar_event_option">',g="Event",h="tabs.event",i={},j="calendar.editEvent",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</a></li>\n    <li><a href="#edit_assignment_form_holder" class="edit_assignment_option">',g="Assignment",h="tabs.assignment",i={},j="calendar.editEvent",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;return f+='</a></li>\n  </ul>\n  <div id="edit_calendar_event_form_holder" class="tab_holder"></div>\n  <div id="edit_assignment_form_holder" class="tab_holder"></div>\n</div>',f}),c["calendar/editEvent"]}),define("jst/calendar/appointmentGroupList",["compiled/handlebars_helpers","i18n!calendar.appointment_group_list"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/appointmentGroupList"]=b(function(a,b,c,d,e){function p(a,b){var d="",e,f,g,h;d+='\n  <button class="button single_item_done_button">Done, Go Back To List</button>\n  <h2 id="appointment-group-list-header">',e="My Appointment Groups",f="my_appointment_groups",g={},h="calendar.appointmentGroupList",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;d+='</h2>\n  <ul id="appointment-group-list">\n    ',e=c.appointment_groups||a.appointment_groups,f=c.each,i=j.program(2,q,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;return d+="\n  </ul>\n",d}function q(a,b){var d="",e,f;d+="\n      <li class='appointment-group-item admin-link-hover-area ",e=c.requiring_action||a.requiring_action,f=c["if"],i=j.program(3,r,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;d+=" ",e=c.published||a.published,f=c.unless,i=j.program(5,s,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;d+="' data-appointment-group-id='",e=c.id||a.id,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"id",{hash:{}})),d+=o(e)+"'>\n        ",e=c.is_manageable||a.is_manageable,f=c["if"],i=j.program(7,t,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;d+="\n        ",e=c.requiring_action||a.requiring_action,f=c["if"],i=j.program(12,w,b),i.hash={},i.fn=i,i.inverse=j.program(14,x,b),e=f.call(a,e,i);if(e||e===0)d+=e;d+='\n\n        <h3><a class="view_calendar_link" href="#">',e=c.title||a.title,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"title",{hash:{}})),d+=o(e)+"</a></h3>\n        <div class='ag-context'>\n          ",e=c.contexts||a.contexts,f=c.toSentence||a.toSentence,i=j.program(18,A,b),i.hash={},i.fn=i,i.inverse=j.noop,typeof f===k?e=f.call(a,e,i):e=n.call(a,f,e,i);if(e||e===0)d+=e;d+="\n        </div>\n        ",e=c.location_name||a.location_name,f=c["if"],i=j.program(20,B,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;d+="\n        ",e=c.description||a.description,f=c["if"],i=j.program(22,C,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;d+="\n        ",e=c.is_manageable||a.is_manageable,f=c["if"],i=j.program(24,D,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;return d+="\n      </li>\n    ",d}function r(a,b){return"requiring-action"}function s(a,b){return"unpublished-ag"}function t(a,b){var d="",e,f,g;d+='\n          <div class="admin-links">\n            <button class="al-trigger"><span class="al-trigger-inner">Manage</span></button>\n            <ul class="al-options">\n              <li><a class="edit_link" href="#"><span class="ui-icon ui-icon-pencil" />Edit</a></li>\n              <li><a class="message_link" href="#"><span class="ui-icon ui-icon-mail-closed" />',e="Group",f=c.participant_type||a.participant_type,g=c.ifEqual||a.ifEqual,i=j.program(8,u,b),i.hash={},i.fn=i,i.inverse=j.program(10,v,b),typeof g===k?e=g.call(a,f,e,i):e=n.call(a,g,f,e,i);if(e||e===0)d+=e;return d+='</a></li>\n              <li><a class="delete_link" href="#"><span class="ui-icon ui-icon-trash" />Delete</a></li>\n            </ul>\n          </div>\n        ',d}function u(a,b){var d,e,f,g;return d="Message Groups Who...",e="message_groups",f={},g="calendar.appointmentGroupList",f.scope=g,g=c.t||a.t,i={},i.hash=f,typeof g===k?d=g.call(a,e,d,i):g===m?d=l.call(a,"t",e,d,i):d=g,d||d===0?d:""}function v(a,b){var d,e,f,g;return d="Message Students Who...",e="message_students",f={},g="calendar.appointmentGroupList",f.scope=g,g=c.t||a.t,i={},i.hash=f,typeof g===k?d=g.call(a,e,d,i):g===m?d=l.call(a,"t",e,d,i):d=g,d||d===0?d:""}function w(a,b){return'\n          <div class="alert alert-warning">\n            <div>\n              You can <a class="view_calendar_link" href="#">sign up</a> for this.\n            </div>\n          </div>\n        '}function x(a,b){var d="",e,f;d+="\n          ",e=c.signed_up_times||a.signed_up_times,f=c["if"],i=j.program(15,y,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;return d+="\n        ",d}function y(a,b){var d="",e,f;d+='\n            <div class="alert alert-success">\n              <div>You\'re signed up for</div>\n              ',e=c.signed_up_times||a.signed_up_times,f=c.each,i=j.program(16,z,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;return d+="\n            </div>\n          ",d}function z(a,b){var d="",e;d+='\n                <div><strong><a href="#" class="show_event_link" data-event-id="',e=c.id||a.id,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"id",{hash:{}})),d+=o(e)+'">',e=c.formatted_time||a.formatted_time,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"formatted_time",{hash:{}}));if(e||e===0)d+=e;return d+="</a></strong></div>\n              ",d}function A(a,b){var d="",e;return d+='<a href="',e=c.url||a.url,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"url",{hash:{}})),d+=o(e)+'">',e=c.name||a.name,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"name",{hash:{}})),d+=o(e)+"</a>",d}function B(a,b){var d="",e,f,g,h;d+='\n          <div class="ag-location">\n            <strong>',e="Location:",f="location",g={},h="calendar.appointmentGroupList",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;return d+="</strong>\n            <span>",e=c.location_name||a.location_name,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"location_name",{hash:{}})),d+=o(e)+"</span>\n          </div>\n        ",d}function C(a,b){var d="",e,f;return d+='\n          <p class="ag-description">',e=c.description||a.description,f=c.newlinesToBreak||a.newlinesToBreak,typeof f===k?e=f.call(a,e,{hash:{}}):f===m?e=l.call(a,"newlinesToBreak",e,{hash:{}}):e=f,d+=o(e)+"</p>\n        ",d}function D(a,b){var d="",e,f,g;d+='\n          <div class="ag-x-of-x-signed-up">\n            ',e="Group",f=c.participant_type||a.participant_type,g=c.ifEqual||a.ifEqual,i=j.program(25,E,b),i.hash={},i.fn=i,i.inverse=j.program(27,F,b),typeof g===k?e=g.call(a,f,e,i):e=n.call(a,g,f,e,i);if(e||e===0)d+=e;d+="\n            ",e=c.published||a.published,f=c.unless,i=j.program(29,G,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;return d+="\n          </div>\n        ",d}function E(a,b){var d="",e,f,g,h;d+="\n              ",e="%{signed_up} groups have signed up",f="x_groups_have_signed_up",g={},h="calendar.appointmentGroupList",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;return d+="\n            ",d}function F(a,b){var d="",e,f,g,h;d+="\n              ",e="%{signed_up} people have signed up",f="x_people_have_signed_up",g={},h="calendar.appointmentGroupList",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;return d+="\n            ",d}function G(a,b){return"(unpublished)"}function H(a,b){var d="",e,f;d+="\n  ",e=c.canManageAGroup||a.canManageAGroup,f=c["if"],i=j.program(32,I,b),i.hash={},i.fn=i,i.inverse=j.program(34,J,b),e=f.call(a,e,i);if(e||e===0)d+=e;return d+="\n",d}function I(a,b){var d="",e,f,g,h;d+="\n    <h2>\n      ",e="You have not created any appointment groups, and there are none you can sign up for",f="scheduler_explanation_teacher_header",g={},h="calendar.appointmentGroupList",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;d+="\n    </h2>\n    <p>\n      ",e="This is the Scheduler Tool. You can use it to create appointment groups for your students to sign up for.",f="scheduler_explanation_teacher_paragraph_1",g={},h="calendar.appointmentGroupList",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;d+="\n    </p>\n    <p>\n      ",e="For example, lets say you want to go over the midterm paper assignment with each of the students in your course. You would create a new appointment group, specify the dates and times that you're available, tell it to split that time into 15 minute blocks and only allow one student per time-block.",f="scheduler_explanation_teacher_paragraph_2",g={},h="calendar.appointmentGroupList",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;d+="\n    </p>\n    <p>\n      ",e="Then students would get notified and see that they need to sign up for one of the specified time blocks. They will be shown a calendar with the available time blocks overlaid on top of everything on their other calendars so they can pick a time that works for them.",f="scheduler_explanation_teacher_paragraph_3",g={},h="calendar.appointmentGroupList",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;d+="\n    </p>\n    <p>\n      ",e='* Get started now by clicking the "Create an appointment group" button to the right *',f="scheduler_explanation_teacher_paragraph_4",g={},h="calendar.appointmentGroupList",g.scope=h,h="<strong>$1</strong>",g.w0=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;return d+="\n    </p>\n  ",d}function J(a,b){var d="",e,f,g,h;d+="\n    <h2>\n      ",e="You do not have any appointment groups to sign up for",f="scheduler_explanation_student_header",g={},h="calendar.appointmentGroupList",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;d+="\n    </h2>\n    <p>\n      ",e='Teachers can use this scheduler tool to schedule things for their students to sign up for. Things like: "office hours", "group presentation time-slots" or "lunch with an alumnus".',f="scheduler_explanation_student_paragraph_1",g={},h="calendar.appointmentGroupList",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;d+="\n    </p>\n    <p>\n      ",e="None of your teachers have made any appointments you can sign up for so there is not anything for you do to now. You will be notified if anyone does create something so you can come sign up for it.",f="scheduler_explanation_student_paragraph_2",g={},h="calendar.appointmentGroupList",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;return d+="\n    </p>\n  ",d}c=c||a.helpers;var f="",g,h,i,j=this,k="function",l=c.helperMissing,m=void 0,n=c.blockHelperMissing,o=this.escapeExpression;g=c.appointment_groups||b.appointment_groups,h=c["if"],i=j.program(1,p,e),i.hash={},i.fn=i,i.inverse=j.program(31,H,e),g=h.call(b,g,i);if(g||g===0)f+=g;return f+="\n",f}),c["calendar/appointmentGroupList"]}),define("jst/calendar/schedulerRightSideAdminSection",["compiled/handlebars_helpers","i18n!calendar.scheduler_right_side_admin_section"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/schedulerRightSideAdminSection"]=b(function(a,b,c,d,e){c=c||a.helpers;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0;f+='<div class="rs-section">\n  <p>The scheduler tool lets you set up time slots that students (or student groups) can sign up for. To get started, click the button below.</p>\n  <button class="create_link button">',g="Create an appointment group",h="create_a_new_set_of_appointments",i={},j="calendar.schedulerRightSideAdminSection",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;return f+="</button>\n</div>\n",f}),c["calendar/schedulerRightSideAdminSection"]}),define("jst/calendar/contextList",["compiled/handlebars_helpers"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/contextList"]=b(function(a,b,c,d,e){function o(a,b){var d="",e,f;d+='\n    <li data-context="',e=c.asset_string||a.asset_string,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"asset_string",{hash:{}})),d+=n(e)+'" class="context_list_context">\n      <span class="checkbox group_',e=c.asset_string||a.asset_string,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"asset_string",{hash:{}})),d+=n(e)+'"></span>\n      ',e=c.name||a.name,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"name",{hash:{}})),d+=n(e)+"\n      ",e=c.can_create_stuff||a.can_create_stuff,f=c["if"],i=j.program(2,p,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;return d+="\n    </li>\n  ",d}function p(a,b){var d="",e,f;d+='\n        <button class="settings"></button>\n        <ul class="actions ui-menu-small">\n          ',e=c.can_create_calendar_events||a.can_create_calendar_events,f=c["if"],i=j.program(3,q,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;d+="\n          ",e=c.can_create_assignments||a.can_create_assignments,f=c["if"],i=j.program(5,r,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;return d+="\n        </ul>\n      ",d}function q(a,b){return'\n            <li><a href="#" data-action="add_event">Add Event</a></li>\n          '}function r(a,b){return'\n            <li><a href="#" data-action="add_assignment">Add Assignment</a></li>\n          '}c=c||a.helpers;var f="",g,h,i,j=this,k="function",l=c.helperMissing,m=void 0,n=this.escapeExpression;f+='<ul id="context-list">\n  ',g=c.contexts||b.contexts,h=c.each,i=j.program(1,o,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;return f+="\n</ul>\n",f}),c["calendar/contextList"]}),define("jst/calendar/undatedEvents",["compiled/handlebars_helpers"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["calendar/undatedEvents"]=b(function(a,b,c,d,e){function o(a,b){var d="",e,f;d+="\n  <b>Undated Events</b>\n  <ul>\n    ",e=c.events||a.events,f=c.each,i=j.program(2,p,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;return d+="\n  </ul>\n",d}function p(a,b){var d="",e;return d+='\n      <li class="undated_event event group_',e=c.contextCode||a.contextCode,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"contextCode",{hash:{}})),d+=n(e)+" ",e=c.id||a.id,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"id",{hash:{}})),d+=n(e)+'" data-event-id="',e=c.id||a.id,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"id",{hash:{}})),d+=n(e)+'">\n        ',e=c.title||a.title,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"title",{hash:{}})),d+=n(e)+"\n      </li>\n    ",d}function q(a,b){return'\n  <div class="spin_holder"></div>\n  <a href="#" data-text-while-loading="Loading undated events..." class="undated-events-link">Show undated events</a>\n'}c=c||a.helpers;var f="",g,h,i,j=this,k="function",l=c.helperMissing,m=void 0,n=this.escapeExpression;g=c.events||b.events,h=c["if"],i=j.program(1,o,e),i.hash={},i.fn=i,i.inverse=j.program(4,q,e),g=h.call(b,g,i);if(g||g===0)f+=g;return f+="\n",f}),c["calendar/undatedEvents"]}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define("compiled/calendar/CommonEvent.Assignment",["i18n!calendar","compiled/calendar/CommonEvent","jquery.instructure_date_and_time","jquery.instructure_misc_helpers"],function(b,d){var e,f;return f=b.t("prompts.delete_assignment","Are you sure you want to delete this assignment?"),e=function(b){function d(b,c){this.saveDates=a(this.saveDates,this),this.copyDataFromObject=a(this.copyDataFromObject,this),d.__super__.constructor.apply(this,arguments),this.eventType="assignment",this.deleteConfirmation=f,this.deleteURL=c.assignment_url,this.addClass("assignment"),this.copyDataFromObject(b)}return c(d,b),d.name="Assignment",d.prototype.copyDataFromObject=function(a){return a.assignment&&(a=a.assignment),this.object=this.assignment=a,this.id="assignment_"+a.id,this.title=a.title||a.name||"Untitled",this.addClass("group_"+this.contextCode()),this.start=a.due_at?$.parseFromISO(a.due_at,"due_date").time:null,this.isDueAtMidnight()&&(this.midnightFudged=!0,this.start.setMinutes(30)),this.description=a.description},d.prototype.fullDetailsURL=function(){return $.replaceTags(this.contextInfo.assignment_url,"id",this.assignment.id)},d.prototype.startDate=function(){return this.assignment.due_at?$.parseFromISO(this.assignment.due_at,"due_date").time:null},d.prototype.displayTimeString=function(){var a,b;return this.assignment.due_at?(a=$.parseFromISO(this.assignment.due_at,"due_date"),b=""+$.dateString(a.date)+" at "+a.time_string,"Due: <time datetime='"+a.time.toISOString()+"'>"+b+"</time>"):"No Date"},d.prototype.saveDates=function(a,b){return this.save({"assignment[due_at]":$.dateToISO8601UTC($.unfudgeDateForProfileTimezone(this.start))},a,b)},d.prototype.methodAndURLForSave=function(){var a,b;return this.isNewEvent()?(a="POST",b=this.contextInfo.create_assignment_url):(a="PUT",b=$.replaceTags(this.contextInfo.assignment_url,"id",this.assignment.id)),[a,b]},d.prototype.isDueAtMidnight=function(){return this.midnightFudged||this.start&&this.start.getHours()===23&&this.start.getMinutes()===59},d}(d)})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define("compiled/calendar/CommonEvent.CalendarEvent",["i18n!calendar","compiled/util/semanticDateRange","compiled/calendar/CommonEvent","jquery.instructure_date_and_time","jquery.instructure_misc_helpers"],function(b,d,e){var f,g;return g=b.t("prompts.delete_event","Are you sure you want to delete this event?"),f=function(b){function e(b,c,d){this.saveDates=a(this.saveDates,this),this.copyDataFromObject=a(this.copyDataFromObject,this),e.__super__.constructor.call(this,b,c,d),this.eventType="calendar_event",this.deleteConfirmation=g,this.deleteURL=c.calendar_event_url,this.copyDataFromObject(b)}return c(e,b),e.name="CalendarEvent",e.prototype.copyDataFromObject=function(a){return a.calendar_event&&(a=a.calendar_event),this.object=this.calendarEvent=a,this.id="calendar_event_"+a.id,this.title=a.title||"Untitled",this.start=a.start_at?$.parseFromISO(a.start_at).time:null,this.end=a.end_at?$.parseFromISO(a.end_at).time:null,this.allDay=a.all_day,this.editable=!0,this.lockedTitle=this.object.parent_event_id!=null,this.addClass("group_"+this.contextCode()),this.isAppointmentGroupEvent()&&(this.addClass("scheduler-event"),this.object.reserved&&this.addClass("scheduler-reserved"),this.object.available_slots===0&&this.addClass("scheduler-full"),(this.object.available_slots===void 0||this.object.available_slots>0)&&this.addClass("scheduler-available"),this.editable=!1),this.description=a.description},e.prototype.startDate=function(){return this.calendarEvent.start_at?$.parseFromISO(this.calendarEvent.start_at).time:null},e.prototype.endDate=function(){return this.calendarEvent.end_at?$.parseFromISO(this.calendarEvent.end_at).time:null},e.prototype.fullDetailsURL=function(){var a;return this.isAppointmentGroupEvent()?"/appointment_groups/"+this.object.appointment_group_id:$.replaceTags(this.contextInfo.calendar_event_url,"id",(a=this.calendarEvent.parent_event_id)!=null?a:this.calendarEvent.id)},e.prototype.displayTimeString=function(){return d(this.calendarEvent.start_at,this.calendarEvent.end_at)},e.prototype.saveDates=function(a,b){return this.save({"calendar_event[start_at]":this.start?$.dateToISO8601UTC($.unfudgeDateForProfileTimezone(this.start)):"","calendar_event[end_at]":this.end?$.dateToISO8601UTC($.unfudgeDateForProfileTimezone(this.end)):""},a,b)},e.prototype.methodAndURLForSave=function(){var a,b;return this.isNewEvent()?(a="POST",b="/api/v1/calendar_events"):(a="PUT",b=this.calendarEvent.url),[a,b]},e}(e)})}.call(this),function(){define("compiled/calendar/commonEventFactory",["jquery","compiled/calendar/CommonEvent","compiled/calendar/CommonEvent.Assignment","compiled/calendar/CommonEvent.CalendarEvent","compiled/str/splitAssetString"],function(a,b,c,d,e){return function(a,f){var g,h,i,j,k,l,m,n,o,p,q,r;if(a===null)return n=new b,n.allPossibleContexts=f,n;g=a.context_code,j=a.effective_context_code||g,p=null,a.assignment||a.assignment_group_id?p="assignment":p="calendar_event",a=a.assignment||a.calendar_event||a;if(a.hidden)return null;g==null&&(g=a.context_code),j==null&&(j=a.effective_context_code||a.context_code),k=null;for(q=0,r=f.length;q<r;q++){i=f[q];if(i.asset_string===j){k=i;break}}return k===null?null:(g!==j&&(o=e(g)),h=o&&(m=k[o[0]])?function(){var a,b,c;c=[];for(a=0,b=m.length;a<b;a++)l=m[a],l.id===o[1]&&c.push(l);return c}()[0]:void 0,p==="assignment"?n=new c(a,k):n=new d(a,k,h),n.can_edit=!1,n.can_delete=!1,k.can_create_calendar_events&&(n.can_edit=!0,n.can_delete=!0),n.object.workflow_state==="locked"&&(n.can_edit=!1),n.object.appointment_group_id&&k.can_create_calendar_events&&(n.can_edit=!0),n)}})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/calendar/EventDataSource",["jquery","compiled/calendar/commonEventFactory","jquery.ajaxJSON","vendor/jquery.ba-tinypubsub"],function(b,c){return function(){function d(c){this.fetchNextBatch=a(this.fetchNextBatch,this),this.startFetch=a(this.startFetch,this),this.getParticipants=a(this.getParticipants,this),this.getEvents=a(this.getEvents,this),this.getEventsForAppointmentGroup=a(this.getEventsForAppointmentGroup,this),this.processAppointmentData=a(this.processAppointmentData,this),this.getAppointmentGroups=a(this.getAppointmentGroups,this),this.getAppointmentGroupsFromCache=a(this.getAppointmentGroupsFromCache,this),this.getEventsFromCache=a(this.getEventsFromCache,this),this.processNextRequest=a(this.processNextRequest,this),this.getEventsFromCacheForContext=a(this.getEventsFromCacheForContext,this),this.addEventToCache=a(this.addEventToCache,this),this.needUndatedEventsForContexts=a(this.needUndatedEventsForContexts,this),this.requiredDateRangeForContexts=a(this.requiredDateRangeForContexts,this),this.requiredDateRangeForContext=a(this.requiredDateRangeForContext,this),this.clearCache=a(this.clearCache,this),this.eventWithId=a(this.eventWithId,this),this.eventDeleted=a(this.eventDeleted,this),this.eventSaved=a(this.eventSaved,this),this.contexts=c,this.clearCache(),this.inFlightRequest=!1,this.pendingRequests=[],b.subscribe("CommonEvent/eventDeleted",this.eventDeleted),b.subscribe("CommonEvent/eventSaved",this.eventSaved)}return d.prototype.eventSaved=function(a){return this.addEventToCache(a)},d.prototype.eventDeleted=function(a){var b,c;b=(c=this.cache.contexts[a.contextCode()])!=null?c.events:void 0;if(b)return delete b[a.id]},d.prototype.eventWithId=function(a){var b,c,d;d=this.cache.contexts;for(b in d){c=d[b];if(c.events[a])return c.events[a]}return null},d.prototype.clearCache=function(){var a,b,c,d,e;this.cache={contexts:{},appointmentGroups:{},participants:{},fetchedAppointmentGroups:null},d=this.contexts,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(this.cache.contexts[a.asset_string]={events:{},fetchedRanges:[],fetchedUndated:!1});return e},d.prototype.requiredDateRangeForContext=function(a,b,c){var d,e,f,g,h;if(!(d=this.cache.contexts[c]))return[a,b];if(!(f=d.fetchedRanges))return[a,b];for(g=0,h=f.length;g<h;g++)e=f[g],e[0]<=a&&a<=e[1]&&(a=e[1]),e[0]<=b&&b<=e[1]&&(b=e[0]);return[a,b]},d.prototype.requiredDateRangeForContexts=function(a,b,c){var d,e,f,g,h,i,j,k;f=b,g=a;for(i=0,j=c.length;i<j;i++)d=c[i],k=this.requiredDateRangeForContext(a,b,d),h=k[0],e=k[1],h<f&&(f=h),e>g&&(g=e);return[f,g]},d.prototype.needUndatedEventsForContexts=function(a){var b,c,d;for(c=0,d=a.length;c<d;c++){b=a[c];if(!this.cache.contexts[b].fetchedUndated)return!0}return!1},d.prototype.addEventToCache=function(a){var b,c;return b=a.contextCode(),c=this.cache.contexts[b],c.events[a.id]=a},d.prototype.getEventsFromCacheForContext=function(a,b,c){var d,e,f,g,h;d=this.cache.contexts[c],f=[],h=d.events;for(g in h)e=h[g],(!e.start&&!a||e.start>=a&&e.start<=b)&&f.push(e);return f},d.prototype.processNextRequest=function(){var a,b,c;c=this.pendingRequests.shift();if(c)return b=c[0],a=c[1],b.apply(null,a)},d.prototype.getEventsFromCache=function(a,b,c){var d,e,f,g;e=[];for(f=0,g=c.length;f<g;f++)d=c[f],e=e.concat(this.getEventsFromCacheForContext(a,b,d));return e},d.prototype.getAppointmentGroupsFromCache=function(){var a,b,c,d;c=this.cache.appointmentGroups,d=[];for(b in c)a=c[b],d.push(a);return d},d.prototype.getAppointmentGroups=function(a,b){var c,d,e,f=this;if(this.inFlightRequest){this.pendingRequests.push([this.getAppointmentGroups,arguments]);return}if(this.cache.fetchedAppointmentGroups&&this.cache.fetchedAppointmentGroups.manageable===a){b(this.getAppointmentGroupsFromCache()),this.processNextRequest();return}return this.cache.fetchedAppointmentGroups={manageable:a},this.cache.appointmentGroups={},c=function(a,b,c){var d,e,g,h;if(a){h=[];for(e=0,g=a.length;e<g;e++)d=a[e],c.scope==="manageable"?d.is_manageable=!0:d.is_scheduleable=!0,h.push(f.processAppointmentData(d));return h}},d=function(){return b(f.getAppointmentGroupsFromCache())},e=[["/api/v1/appointment_groups",{include:["appointments","child_events"]}]],a&&e.push(["/api/v1/appointment_groups",{scope:"manageable",include:["appointments","child_events"]}]),this.startFetch(e,c,d)},d.prototype.processAppointmentData=function(a){var b,d,e,f,g,h,i,j,k;g=a.id,this.cache.appointmentGroups[g]=a;if(a.appointments){a.appointmentEvents=[],j=a.appointments,k=[];for(h=0,i=j.length;h<i;h++)f=j[h],e=c(f,this.contexts),e&&e.object.workflow_state!=="deleted"?(a.appointmentEvents.push(e),this.addEventToCache(e),f.child_events?(e.childEvents=[],k.push(function(){var a,g,h,i;h=f.child_events,i=[];for(a=0,g=h.length;a<g;a++)d=h[a],b=c(d,this.contexts),this.addEventToCache(e),i.push(e.childEvents.push(b));return i}.call(this))):k.push(void 0)):k.push(void 0);return k}},d.prototype.getEventsForAppointmentGroup=function(a,b){var c,d,e=this;if(this.inFlightRequest){this.pendingRequests.push([this.getEventsForAppointmentGroup,arguments]);return}if(a.appointmentEvents){b(a.appointmentEvents),this.processNextRequest();return}return c=function(a){if(a)return e.processAppointmentData(a)},d={include:["appointments","child_events"]},this.startFetch([[a.url,d]],c,function(){return b(a.appointmentEvents)})},d.prototype.getEvents=function(a,d,e,f){var g,h,i,j,k,l,m,n,o,p=this;if(this.inFlightRequest){this.pendingRequests.push([this.getEvents,arguments]);return}l=function(a,c,d){var e,f,g;return g=p.requiredDateRangeForContexts(a,c,d),f=g[0],e=g[1],f<e?{context_codes:d,start_date:b.dateToISO8601UTC(f),end_date:b.dateToISO8601UTC(e)}:null},m=function(a){return p.needUndatedEventsForContexts(a)?{context_codes:a,undated:"1"}:null},k=a?l(a,d,e):m(e);if(!k){f(this.getEventsFromCache(a,d,e)),this.processNextRequest();return}for(n=0,o=e.length;n<o;n++)g=e[n],h=this.cache.contexts[g],h&&(a?h.fetchedRanges.push([a,d]):h.fetchedUndated=!0);return j=function(){return f(p.getEventsFromCache(a,d,e))},i=function(a){var b,d,e,f,g;if(a){g=[];for(e=0,f=a.length;e<f;e++)b=a[e],d=c(b,p.contexts),d&&d.object.workflow_state!=="deleted"?g.push(p.addEventToCache(d)):g.push(void 0);return g}},this.startFetch([["/api/v1/calendar_events",k],["/api/v1/calendar_events",b.extend({type:"assignment"},k)]],i,j)},d.prototype.getParticipants=function(a,b,c){var d,e,f,g,h=this;if(this.inFlightRequest){this.pendingRequests.push([this.getParticipants,arguments]);return}f=""+a.id+"_"+b;if(this.cache.participants[f]){c(this.cache.participants[f]),this.processNextRequest();return}return this.cache.participants[f]=[],d=function(a,b,c){if(a)return h.cache.participants[f].push.apply(h.cache.participants[f],a)},e=function(){return c(h.cache.participants[f])},g=a.participant_type==="Group"?"groups":"users",this.startFetch([["/api/v1/appointment_groups/"+a.id+"/"+g,{registration_status:b}]],d,e)},d.prototype.startFetch=function(a,b,c){var d,e,f,g,h,i,j=this;d=0,this.inFlightRequest=!0,f=function(e,f,g,h){b(e,g,h);if(f){d+=1;if(d>=a.length)return c(),j.inFlightRequest=!1,j.processNextRequest()}},i=[];for(g=0,h=a.length;g<h;g++)e=a[g],i.push(function(a){return j.fetchNextBatch(a[0],a[1],function(b,c){return f(b,c,a[0],a[1])})}(e));return i},d.prototype.fetchNextBatch=function(a,c,d){var e,f=this;return e=function(a){var b,c,d,e,f,g,h,i;if(!a)return null;e={},h=a.split(",");for(f=0,g=h.length;f<g;f++)b=h[f],i=b.split(";"),c=i[0],d=i[1],c=c.replace(/^</,"").replace(/>$/,""),d=d.split('"')[1],e[d]=c;return e},b.publish("EventDataSource/ajaxStarted"),c.per_page=50,b.ajaxJSON(a,"GET",c,function(a,g){var h,i;b.publish("EventDataSource/ajaxEnded"),h=typeof g.getResponseHeader=="function"?g.getResponseHeader("Link"):void 0,i=e(h);if(i!=null?i.next:void 0){d(a,!1),f.fetchNextBatch(i.next,c,d);return}return d(a,!0)})},d}()})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/calendar/EditCalendarEventDetails",["jquery","compiled/calendar/commonEventFactory","compiled/calendar/TimeBlockList","jst/calendar/editCalendarEvent","jst/calendar/genericSelect","jquery.instructure_date_and_time","jquery.instructure_forms","jquery.instructure_misc_helpers","vendor/date"],function(b,c,d,e,f){var g;return g=function(){function d(c,d,f,g){this.event=d,this.contextChangeCB=f,this.closeCB=g,this.formSubmit=a(this.formSubmit,this),this.setupTimeAndDatePickers=a(this.setupTimeAndDatePickers,this),this.contextChange=a(this.contextChange,this),this.setContext=a(this.setContext,this),this.moreOptionsClick=a(this.moreOptionsClick,this),this.activate=a(this.activate,this),this.currentContextInfo=null,this.form=b(e({title:this.event.title,contexts:this.event.possibleContexts(),lockedTitle:this.event.lockedTitle})),b(c).append(this.form),this.setupTimeAndDatePickers(),this.form.submit(this.formSubmit),this.form.find(".more_options_link").click(this.moreOptionsClick),this.form.find("select.context_id").change(this.contextChange),this.form.find("select.context_id").triggerHandler("change",!1),this.event.isNewEvent()||this.form.find(".context_select").hide()}return d.name="EditCalendarEventDetails",d.prototype.contextInfoForCode=function(a){var b,c,d,e;e=this.event.possibleContexts();for(c=0,d=e.length;c<d;c++){b=e[c];if(b.asset_string===a)return b}return null},d.prototype.activate=function(){return this.form.find("select.context_id").change()},d.prototype.moreOptionsClick=function(a){var c,d,e;if(this.event.object.parent_event_id)return;return a.preventDefault(),e=b(a.target).attr("href").split("#"),c=b("#edit_calendar_event_form").getFormData({object_name:"calendar_event"}),d={},c.title&&(d.title=c.title),c.date&&(d.start_at=""+c.date+" "+(c.start_time||""),d.end_at=""+c.date+" "+(c.end_time||"")),d.return_to=window.location.href,e[0]+="?"+b.param(d),window.location.href=e.join("#")},d.prototype.setContext=function(a){return this.form.find("select.context_id").val(a).triggerHandler("change",!1)},d.prototype.contextChange=function(a,c){var d,e;d=b(a.target).val(),this.currentContextInfo=this.contextInfoForCode(d),this.event.contextInfo=this.currentContextInfo;if(this.currentContextInfo===null)return;return c!==!1&&this.contextChangeCB(d),e=null,this.event.isNewEvent()?e=this.currentContextInfo.new_calendar_event_url:e=this.event.fullDetailsURL()+"/edit",this.form.find(".more_options_link").attr("href",e)},d.prototype.setupTimeAndDatePickers=function(){var a,c,d=this;this.form.find(".date_field").date_field(),this.form.find(".time_field").time_field().blur(function(a){var c,e,f,g;g=d.form.find(".time_field.start_time").next(".datetime_suggest").text(),d.form.find(".time_field.start_time").next(".datetime_suggest").hasClass("invalid_datetime")&&(g=null),g==null&&(g=d.form.find(".time_field.start_time").val()),e=d.form.find(".time_field.end_time").next(".datetime_suggest").text(),d.form.find(".time_field.end_time").next(".datetime_suggest").hasClass("invalid_datetime")&&(e=null),e==null&&(e=d.form.find(".time_field.end_time").val()),f=Date.parse(g),c=Date.parse(e),f=f||c,c=c||f,b(a.target).hasClass("end_time")?f>c&&(f=c):c<f&&(c=f),f&&d.form.find(".time_field.start_time").val(f.toString("h:mmtt").toLowerCase());if(c)return d.form.find(".time_field.end_time").val(c.toString("h:mmtt").toLowerCase())}),c=this.event.startDate(),a=this.event.endDate(),this.event.allDay||(c&&this.form.find(".time_field.start_time").val(c.toString("h:mmtt")).change().blur(),a&&this.form.find(".time_field.end_time").val(a.toString("h:mmtt")).change().blur());if(c)return this.form.find(".date_field").val(c.toString("MMM d, yyyy")).change()},d.prototype.formSubmit=function(a){var d,e,f,g,h,i,j;return a.preventDefault(),d=this.form.getFormData({object_name:"calendar_event"}),d.date?(i=Date.parse(""+d.date+" "+d.start_time),d.end_time==null&&(d.end_time=d.start_time),e=Date.parse(""+d.date+" "+d.end_time)):(i=null,e=null),h={"calendar_event[title]":(j=d.title)!=null?j:this.event.title,"calendar_event[start_at]":i?b.dateToISO8601UTC(b.unfudgeDateForProfileTimezone(i)):"","calendar_event[end_at]":e?b.dateToISO8601UTC(b.unfudgeDateForProfileTimezone(e)):""},this.event.isNewEvent()?(h["calendar_event[context_code]"]=d.context_code,g={calendar_event:{title:h["calendar_event[title]"],start_at:i?b.dateToISO8601UTC(i):null,end_at:e?b.dateToISO8601UTC(e):null,context_code:this.form.find(".context_id").val()}},f=c(g,this.event.possibleContexts()),f.save(h)):(this.event.title=h["calendar_event[title]"],this.event.start=i,this.event.end=e,this.event.save(h)),this.closeCB()},d}()})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/calendar/EditAssignmentDetails",["jquery","compiled/calendar/commonEventFactory","jst/calendar/editAssignment","jst/calendar/genericSelect","jquery.instructure_date_and_time","jquery.instructure_forms","jquery.instructure_misc_helpers"],function(b,c,d,e){var f;return f=function(){function f(c,e,f,g){this.event=e,this.contextChangeCB=f,this.closeCB=g,this.formSubmit=a(this.formSubmit,this),this.setupTimeAndDatePickers=a(this.setupTimeAndDatePickers,this),this.contextChange=a(this.contextChange,this),this.setContext=a(this.setContext,this),this.moreOptionsClick=a(this.moreOptionsClick,this),this.activate=a(this.activate,this),this.currentContextInfo=null,this.form=b(d({title:this.event.title,contexts:this.event.possibleContexts()})),b(c).append(this.form),this.setupTimeAndDatePickers(),this.form.submit(this.formSubmit),this.form.find(".more_options_link").click(this.moreOptionsClick),this.form.find("select.context_id").change(this.contextChange),this.form.find("select.context_id").triggerHandler("change",!1),this.event.isNewEvent()||(this.form.find(".context_select").hide(),this.form.attr("method","PUT"),this.form.attr("action",b.replaceTags(this.event.contextInfo.assignment_url,"id",this.event.object.id)))}return f.name="EditAssignmentDetails",f.prototype.contextInfoForCode=function(a){var b,c,d,e;e=this.event.possibleContexts();for(c=0,d=e.length;c<d;c++){b=e[c];if(b.asset_string===a)return b}return null},f.prototype.activate=function(){var a;this.form.find("select.context_id").change();if((a=this.event.assignment)!=null?a.assignment_group_id:void 0)return this.form.find(".assignment_group_select .assignment_group").val(this.event.assignment.assignment_group_id)},f.prototype.moreOptionsClick=function(a){var c,d,e;return a.preventDefault(),e=b(a.target).attr("href").split("#"),c=this.form.getFormData({object_name:"assignment"}),d={},c.title&&(d.title=c.title),c.due_at&&(d.due_at=c.due_at),c.assignment_group_id&&(d.assignment_group_id=c.assignment_group_id),d.return_to=window.location.href,e[0]+="?"+b.param(d),window.location.href=e.join("#")},f.prototype.setContext=function(a){return this.form.find("select.context_id").val(a).triggerHandler("change",!1)},f.prototype.contextChange=function(a,c){var d,f,g;if(this.ignoreContextChange)return;f=b(a.target).val(),this.currentContextInfo=this.contextInfoForCode(f),this.event.contextInfo=this.currentContextInfo;if(this.currentContextInfo===null)return;return c!==!1&&this.contextChangeCB(f),d={cssClass:"assignment_group",name:"assignment[assignment_group_id]",collection:this.currentContextInfo.assignment_groups},this.form.find(".assignment_group_select").html(e(d)),this.form.attr("action",this.currentContextInfo.create_assignment_url),g=this.event.assignment?""+this.event.assignment.html_url+"/edit":this.currentContextInfo.new_assignment_url,this.form.find(".more_options_link").attr("href",g)},f.prototype.setupTimeAndDatePickers=function(){var a,b;this.form.find(".datetime_field").datetime_field(),b=this.event.startDate(),a=this.event.endDate();if(this.event.allDay)return this.form.find(".datetime_field").val(b.toString("MMM d, yyyy")).change();if(b)return this.form.find(".datetime_field").val(b.toString("MMM d, yyyy h:mmtt")).change()},f.prototype.formSubmit=function(a){var d,e,f,g,h;return a.preventDefault(),e=this.form.getFormData()["assignment[due_at]"],e===""?d=null:d=this.form.find("#assignment_due_at").data("date"),h={"assignment[name]":this.form.find("#assignment_title").val(),"assignment[due_at]":d?b.dateToISO8601UTC(b.unfudgeDateForProfileTimezone(d)):"","assignment[assignment_group_id]":this.form.find(".assignment_group").val()},this.event.isNewEvent()?(g={assignment:{title:h["assignment[name]"],due_at:d?b.dateToISO8601UTC(d):null,context_code:this.form.find(".context_id").val()}},f=c(g,this.event.possibleContexts()),f.save(h)):(this.event.title=h["assignment[name]"],this.event.start=d,this.event.save(h)),this.closeCB()},f}()})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/calendar/EditEventDetailsDialog",["jquery","i18n!calendar","underscore","compiled/calendar/CommonEvent","compiled/calendar/EditCalendarEventDetails","compiled/calendar/EditAssignmentDetails","compiled/calendar/EditApptCalendarEventDialog","compiled/calendar/EditAppointmentGroupDetails","jst/calendar/editEvent","jqueryui/dialog","jqueryui/tabs"],function(b,c,d,e,f,g,h,i,j){var k;return k=b('<div id="edit_event"><div /></div>').appendTo("body").dialog({autoOpen:!1,width:"auto",resizable:!1,title:c.t("titles.edit_event","Edit Event")}),function(){function c(b){this.event=b,this.show=a(this.show,this),this.closeCB=a(this.closeCB,this),this.contextChange=a(this.contextChange,this),this.setupTabs=a(this.setupTabs,this),this.currentContextInfo=null}return c.prototype.contextInfoForCode=function(a){var b,c,d,e;e=this.event.possibleContexts();for(c=0,d=e.length;c<d;c++){b=e[c];if(b.asset_string===a)return b}return null},c.prototype.setupTabs=function(){var a,c;return c=k.find("#edit_event_tabs"),c.tabs().bind("tabsselect",function(a,c){return b(c.panel).closest(".tab_holder").data("form-widget").activate()}),this.event.eventType==="calendar_event"?(c.tabs("select",0),c.tabs("remove",1),this.calendarEventForm.activate()):this.event.eventType==="assignment"?(c.tabs("select",1),c.tabs("remove",0),this.assignmentDetailsForm.activate()):(a=d.any(this.event.allPossibleContexts,function(a){return a.can_create_assignments}),a||c.tabs("remove",1),this.calendarEventForm.activate())},c.prototype.contextChange=function(a){k.removeClass(k.data("group_class")),k.addClass("group_"+a).data("group_class","group_"+a),this.calendarEventForm&&this.calendarEventForm.setContext(a);if(this.assignmentDetailsForm)return this.assignmentDetailsForm.setContext(a)},c.prototype.closeCB=function(){return k.dialog("close")},c.prototype.show=function(){var a,c;if(this.event.isAppointmentGroupEvent())return(new h(this.event)).show();c=j(),k.children().replaceWith(c);if(this.event.isNewEvent()||this.event.eventType==="calendar_event")a=k.find("#edit_calendar_event_form_holder"),this.calendarEventForm=new f(a,this.event,this.contextChange,this.closeCB),a.data("form-widget",this.calendarEventForm);if(this.event.isNewEvent()||this.event.eventType==="assignment")this.assignmentDetailsForm=new g(b("#edit_assignment_form_holder"),this.event,this.contextChange,this.closeCB),k.find("#edit_assignment_form_holder").data("form-widget",this.assignmentDetailsForm);return this.setupTabs(),k.dialog("open")},c}()})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};define("compiled/calendar/sidebar",["jquery","compiled/userSettings","jst/calendar/contextList","jst/calendar/undatedEvents","compiled/calendar/commonEventFactory","compiled/calendar/EditEventDetailsDialog","compiled/calendar/EventDataSource","compiled/jquery.kylemenu","jquery.instructure_misc_helpers","vendor/jquery.ba-tinypubsub"],function(c,d,e,f,g,h,i){var j,k;return j=function(){function e(b,e,f){var g,h;this.$holder=f,this.restoreList=a(this.restoreList,this),this.saveAndClear=a(this.saveAndClear,this),h=function(){try{return c.parseJSON(c.decodeFromHex(location.hash.substring(1)))||{}}catch(a){return{}}}(),h.show&&(this.contexts=h.show.split(",")),this.contexts||(this.contexts=e),this.contexts||(this.contexts=d.get("checked_calendar_codes")),this.contexts||(this.contexts=function(){var a,c,d,e;d=b.slice(0,10),e=[];for(a=0,c=d.length;a<c;a++)g=d[a],e.push(g.asset_string);return e}()),this.notify(),c.subscribe("Calendar/saveVisibleContextListAndClear",this.saveAndClear),c.subscribe("Calendar/restoreVisibleContextList",this.restoreList)}return e.name="VisibleContextManager",e.prototype.saveAndClear=function(){if(!this.savedContexts)return this.savedContexts=this.contexts,this.contexts=[],this.notify()},e.prototype.restoreList=function(){if(this.savedContexts)return this.contexts=this.savedContexts,this.savedContexts=null,this.notify()},e.prototype.toggle=function(a){var b;return b=c.inArray(a,this.contexts),b<0?(this.contexts.push(a),this.contexts.length>10&&this.contexts.shift):this.contexts.splice(b,1),this.notify()},e.prototype.notify=function(){var a=this;return c.publish("Calendar/visibleContextListChanged",[this.contexts]),this.$holder.find(".context_list_context").each(function(d,e){var f,g,h;return f=c(e),g=(h=f.data("context"),b.call(a.contexts,h)>=0),f.toggleClass("checked",g).toggleClass("not-checked",!g)})},e}(),k=function(a,b,d){var f,i,k,l,m;for(l=0,m=a.length;l<m;l++)i=a[l],i.can_create_stuff=i.can_create_calendar_events||i.can_create_assignments;return f=c("#context-list-holder"),f.html(e({contexts:a})),k=new j(a,b,f),f.find(".settings").kyleMenu({buttonOpts:{icons:{primary:"ui-icon-cog-with-droparrow",secondary:null}}}),f.delegate(".context_list_context","click",function(a){if(!c(a.target).closest(".settings, .actions").length)return k.toggle(c(this).data("context"))}),f.delegate(".context_list_context",{"mouseenter mouseleave":function(a){var b;return b=a.type!=="mouseleave"||!!c(this).find(".ui-menu:visible").length,c(this).toggleClass("hovering",b)},"popupopen popupclose":function(a){var b;return b=a.type==="popupopen",c(this).toggleClass("hovering",b).find(".settings").toggleClass("ui-state-active",b)}}),f.delegate(".actions a","click",function(){var b,d,e;d=c(this).parents("li[data-context]").data("context"),b=c(this).data("action");if(b==="add_event"||b==="add_assignment"){e=g(null,a),(new h(e)).show(),c('select[class="context_id"]').val(d).triggerHandler("change");if(b==="add_assignment")return c('a[href="#edit_assignment_form"]').click()}})}})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/calendar/ShowEventDetailsDialog",["jquery","i18n!calendar","compiled/util/Popover","compiled/calendar/CommonEvent","compiled/calendar/EditEventDetailsDialog","jst/calendar/eventDetails","jst/calendar/deleteItem","jst/calendar/reservationOverLimitDialog","compiled/calendar/MessageParticipantsDialog","compiled/fn/preventDefault","underscore","jquery.ajaxJSON","jquery.instructure_misc_helpers","jquery.instructure_misc_plugins","vendor/jquery.ba-tinypubsub"],function(b,c,d,e,f,g,h,i,j,k,l){var m,n,o=this;return n=function(a){return function(){return a.apply(this,[])}},m=function(){function e(b,c){this.dataSource=c,this.show=a(this.show,this),this.cancelAppointment=a(this.cancelAppointment,this),this.unreserveEvent=a(this.unreserveEvent,this),this.reserveEvent=a(this.reserveEvent,this),this.reserveSuccessCB=a(this.reserveSuccessCB,this),this.reserveErrorCB=a(this.reserveErrorCB,this),this.deleteEvent=a(this.deleteEvent,this),this.showEditDialog=a(this.showEditDialog,this),this.event=b,this.contexts=b.contexts}return e.name="ShowEventDetailsDialog",e.prototype.showEditDialog=function(){return this.popover.hide(),(new f(this.event)).show()},e.prototype.deleteEvent=function(a){var d,e=this;a==null&&(a=this.event);if(this.event.isNewEvent())return;return d=a.object.url,a.object.assignment&&(d=b.replaceTags(this.event.deleteURL,"id",this.event.object.id)),b("<div />").confirmDelete({url:d,message:b(h({message:a.deleteConfirmation,hide_reason:a.object.workflow_state!=="locked"})),dialog:{title:c.t("confirm_deletion","Confirm Deletion")},prepareData:function(a){return{cancel_reason:a.find("#cancel_reason").val()}},confirmed:function(){return e.popover.hide(),b.publish("CommonEvent/eventDeleting",a)},success:function(){return b.publish("CommonEvent/eventDeleted",a)}})},e.prototype.reserveErrorCB=function(a){var d,e,f,g,h,j=this;for(g=0,h=a.length;g<h;g++){e=a[g];if(e.message!=="participant has met per-participant limit")continue;f=!0,e.reschedulable=e.reservations.length===1,d=b(i(e)).dialog({resizable:!1,width:450,buttons:e.reschedulable?[{text:c.t("reschedule","Reschedule"),"class":"ui-button-primary",click:function(){return d.disableWhileLoading(j.reserveEvent({cancel_existing:!0}).always(function(){return d.dialog("close")}))}},{text:c.t("do_nothing","Do Nothing"),click:function(){return d.dialog("close")}}]:[{text:c.t("ok","OK"),click:function(){return d.dialog("close")}}]})}if(!f)return alert("Could not reserve event: "+a),b.publish("CommonEvent/eventSaveFailed",this.event)},e.prototype.reserveSuccessCB=function(a){return this.popover.hide(),b.publish("CommonEvent/eventSaved",this.event)},e.prototype.reserveEvent=function(a){return a==null&&(a={}),b.publish("CommonEvent/eventSaving",this.event),b.ajaxJSON(this.event.object.reserve_url,"POST",a,this.reserveSuccessCB,this.reserveErrorCB)},e.prototype.unreserveEvent=function(){var a,b,c,d,e;d=this.event.childEvents;for(b=0,c=d.length;b<c;b++){a=d[b];if((e=a.object)!=null?e.own_reservation:void 0){this.deleteEvent(a);return}}},e.prototype.cancelAppointment=function(a){var d,e,f,g=this;return e=a.data("url"),d=l.detect(this.event.calendarEvent.child_events,function(a){return a.url===e}),b("<div/>").confirmDelete({url:e,message:b(h({message:c.t("cancel_appointment","Are you sure you want to cancel your appointment with %{name}?",{name:((f=d.user)!=null?f.short_name:void 0)||d.group.name})})),dialog:{title:c.t("confirm_removal","Confirm Removal"),width:"400px",resizable:!1},prepareData:function(a){return{cancel_reason:a.find("#cancel_reason").val()}},success:function(){var c,d;g.event.object.child_events=l(g.event.object.child_events).reject(function(b){return b.url===a.data("url")}),a.remove(),d=b("#scheduler").prop("checked"),c=g.event.calendarEvent.child_events;if(!d&&c.length===0)return b.publish("CommonEvent/eventDeleted",g.event),g.popover.hide()}})},e.prototype.show=function(a){var c,e,f,h,i,l,m,o,p,q,r,s,t,u,v,w=this;e=b.extend(!0,{},this.event,{can_reserve:(l=this.event.object)!=null?l.reserve_url:void 0}),this.event.contextInfo.can_create_appointment_groups&&(e.can_reserve=!1);if((m=this.event.object)!=null?m.child_events:void 0){this.event.object.reserved&&(e.can_unreserve=!0,e.can_reserve=!1),o=this.event.object.child_events;for(h=0,i=o.length;h<i;h++)c=o[h],f={id:((p=c.user)!=null?p.id:void 0)||c.group.id,name:((q=c.user)!=null?q.short_name:void 0)||c.group.name,event_url:c.url},((r=e.reservations)!=null?r:e.reservations=[]).push(f),c.user&&((s=e.reserved_users)!=null?s:e.reserved_users=[]).push(f),c.group&&((t=e.reserved_groups)!=null?t:e.reserved_groups=[]).push(f)}return((u=this.event.object)!=null?u.available_slots:void 0)===0?(e.can_reserve=!1,e.availableSlotsText="None"):((v=this.event.object)!=null?v.available_slots:void 0)>0&&(e.availableSlotsText=this.event.object.available_slots),e.showEventLink=e.can_edit&&e.fullDetailsURL(),e.showEventLink||(e.showEventLink=e.isAppointmentGroupEvent()),this.popover=new d(a,g(e)),this.popover.el.find(".edit_event_link").click(k(this.showEditDialog)),this.popover.el.find(".delete_event_link").click(k(n(this.deleteEvent))),this.popover.el.find(".reserve_event_link").click(k(n(this.reserveEvent))),this.popover.el.find(".unreserve_event_link").click(k(this.unreserveEvent)),this.popover.el.find(".cancel_appointment_link").click(k(function(a){var c;return c=b(a.target).closest("li"),w.cancelAppointment(c)})),this.popover.el.find(".message_students").click(k(function(){return(new j({timeslot:w.event.calendarEvent})).show()}))},e}()})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/calendar/UndatedEventsList",["jquery","jst/calendar/undatedEvents","compiled/calendar/EventDataSource","compiled/calendar/ShowEventDetailsDialog","jqueryui/draggable","jquery.disableWhileLoading","vendor/jquery.ba-tinypubsub"],function(b,c,d,e){var f;return f=function(){function d(d,e){this.dataSource=e,this.eventSaved=a(this.eventSaved,this),this.eventSaving=a(this.eventSaving,this),this.visibleContextListChanged=a(this.visibleContextListChanged,this),this.clickEvent=a(this.clickEvent,this),this.show=a(this.show,this),this.load=a(this.load,this),this.div=b(d).html(c({})),this.hidden=!0,this.visibleContextList=[],b.subscribe({"CommonEvent/eventDeleting":this.eventSaving,"CommonEvent/eventDeleted":this.eventSaved,"CommonEvent/eventSaving":this.eventSaving,"CommonEvent/eventSaved":this.eventSaved,"Calendar/visibleContextListChanged":this.visibleContextListChanged}),this.div.delegate(".event","click",this.clickEvent).delegate(".undated-events-link","click",this.show)}return d.name="UndatedEventsList",d.prototype.load=function(){var a,d=this;if(this.hidden)return;return a=new b.Deferred,this.div.disableWhileLoading(a,{buttons:[".undated-events-link"],opacity:1,lines:8,length:2,width:2,radius:3}),this.dataSource.getEvents(null,null,this.visibleContextList,function(e){var f,g,h;a.resolve(),d.div.html(c({events:e}));for(g=0,h=e.length;g<h;g++)f=e[g],d.div.find("."+f.id).data("calendarEvent",f);return d.div.find(".event").draggable({revert:"invalid",revertDuration:0,helper:"clone",start:function(){return b(this).hide()},stop:function(){if(!b(this).data("calendarEvent").start)return b(this).show()}})})},d.prototype.show=function(a){return a.preventDefault(),this.hidden=!1,this.load()},d.prototype.clickEvent=function(a){var c,d;d=b(a.target).data("event-id"),c=this.dataSource.eventWithId(d);if(c)return(new e(c,this.dataSource)).show()},d.prototype.visibleContextListChanged=function(a){this.visibleContextList=a;if(!this.hidden)return this.load()},d.prototype.eventSaving=function(a){return this.div.find("."+a.id).addClass("event_pending")},d.prototype.eventSaved=function(){return this.load()},d}()})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};define("compiled/calendar/Scheduler",["jquery","underscore","i18n!calendar","jst/calendar/appointmentGroupList","jst/calendar/schedulerRightSideAdminSection","compiled/calendar/EditAppointmentGroupDialog","compiled/calendar/MessageParticipantsDialog","jst/calendar/deleteItem","jquery.instructure_date_and_time","jqueryui/dialog","jquery.instructure_misc_plugins","vendor/jquery.ba-tinypubsub","vendor/jquery.spin"],function(c,d,e,f,g,h,i,j){var k;return k=function(){function k(b,e){this.calendar=e,this.messageLinkClick=a(this.messageLinkClick,this),this.deleteLinkClick=a(this.deleteLinkClick,this),this.editLinkClick=a(this.editLinkClick,this),this.showList=a(this.showList,this),this.doneClick=a(this.doneClick,this),this.viewCalendarForGroup=a(this.viewCalendarForGroup,this),this.viewCalendarForGroupId=a(this.viewCalendarForGroupId,this),this.viewCalendarForElement=a(this.viewCalendarForElement,this),this.showEventLinkClick=a(this.showEventLinkClick,this),this.viewCalendarLinkClick=a(this.viewCalendarLinkClick,this),this.redraw=a(this.redraw,this),this.loadData=a(this.loadData,this),this.canManageAGroup=a(this.canManageAGroup,this),this.hide=a(this.hide,this),this.show=a(this.show,this),this.eventDeleted=a(this.eventDeleted,this),this.eventSaved=a(this.eventSaved,this),this.dialogCloseCB=a(this.dialogCloseCB,this),this.createClick=a(this.createClick,this),this.div=c(b),this.contexts=this.calendar.contexts,this.listDiv=this.div.find(".appointment-list"),this.div.delegate(".single_item_done_button","click",this.doneClick),this.div.delegate(".view_calendar_link","click",this.viewCalendarLinkClick),this.listDiv.delegate(".edit_link","click",this.editLinkClick),this.listDiv.delegate(".message_link","click",this.messageLinkClick),this.listDiv.delegate(".delete_link","click",this.deleteLinkClick),this.listDiv.delegate(".show_event_link","click",this.showEventLinkClick),this.canManageAGroup()&&(this.div.addClass("can-manage"),this.rightSideAdminSection=c(g()),this.rightSideAdminSection.find(".create_link").click(this.createClick),this.appointmentGroupContexts=d.filter(this.contexts,function(a){return a.can_create_appointment_groups})),c.subscribe("CommonEvent/eventSaved",this.eventSaved),c.subscribe("CommonEvent/eventDeleted",this.eventDeleted)}return k.name="Scheduler",k.prototype.createClick=function(a){var b;return a.preventDefault(),b={context_codes:[],sub_context_codes:[]},this.createDialog=new h(b,this.appointmentGroupContexts,this.dialogCloseCB),this.createDialog.show()},k.prototype.dialogCloseCB=function(a){if(a)return this.calendar.dataSource.clearCache(),this.loadData()},k.prototype.eventSaved=function(a){if(this.active)return this.calendar.dataSource.clearCache(),this.loadData()},k.prototype.eventDeleted=function(a){if(this.active)return this.calendar.dataSource.clearCache(),this.loadData()},k.prototype.toggleListMode=function(a){var b;return a?(delete this.viewingGroup,this.calendar.updateFragment({appointment_group_id:null}),this.showList(),this.canManageAGroup()?(c("#right-side .rs-section").hide(),this.rightSideAdminSection.appendTo("#right-side")):c("#right-side-wrapper").hide()):(c("#right-side-wrapper").show(),c("#right-side .rs-section").not("#undated-events, #calendar-feed").show(),(b=this.rightSideAdminSection)!=null?b.detach():void 0)},k.prototype.show=function(){return c("#undated-events, #calendar-feed").hide(),this.active=!0,this.div.show(),this.loadData(),this.toggleListMode(!0),c.publish("Calendar/saveVisibleContextListAndClear")},k.prototype.hide=function(){return c("#undated-events, #calendar-feed").show(),this.active=!1,this.div.hide(),this.toggleListMode(!1),this.calendar.displayAppointmentEvents=null,c.publish("Calendar/restoreVisibleContextList")},k.prototype.canManageAGroup=function(){var a,b,c,d;d=this.contexts;for(b=0,c=d.length;b<c;b++){a=d[b];if(a.can_create_appointment_groups)return!0}return!1},k.prototype.loadData=function(){var a=this;if(!this.loadingDeferred||this.loadingDeferred&&!this.loadingDeferred.isResolved())this.loadingDeferred=new c.Deferred;return this.groups={},this.loadingDiv==null&&(this.loadingDiv=c('<div id="scheduler-loading" />').appendTo(this.div).spin()),this.calendar.dataSource.getAppointmentGroups(this.canManageAGroup(),function(b){var c,d,e;for(d=0,e=b.length;d<e;d++)c=b[d],a.groups[c.id]=c;return a.redraw(),a.loadingDeferred.resolve()})},k.prototype.redraw=function(){var a,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t;this.loadingDiv.hide();if(this.groups){h=[],q=this.groups;for(j in q){g=q[j],g.signed_up_times=null;if(g.appointmentEvents){r=g.appointmentEvents;for(k=0,n=r.length;k<n;k++){a=r[k];if(a.object.reserved){s=a.childEvents;for(l=0,o=s.length;l<o;l++){e=s[l];if(!e.object.own_reservation)continue;g.signed_up_times==null&&(g.signed_up_times=[]),g.signed_up_times.push({id:e.id,formatted_time:e.displayTimeString()})}}}}g.signed_up=0;if(g.appointmentEvents){t=g.appointmentEvents;for(m=0,p=t.length;m<p;m++)a=t[m],a.childEvents&&(g.signed_up+=a.childEvents.length)}g.contexts=d.filter(this.contexts,function(a){var c;return c=a.asset_string,b.call(g.context_codes,c)>=0}),g.published=g.workflow_state==="active",h.push(g)}i=f({appointment_groups:h,canManageAGroup:this.canManageAGroup()}),this.listDiv.find(".list-wrapper").html(i),this.viewingGroup&&(this.viewingGroup=this.groups[this.viewingGroup.id],this.viewingGroup?(this.listDiv.find(".appointment-group-item[data-appointment-group-id='"+this.viewingGroup.id+"']").addClass("active"),this.calendar.displayAppointmentEvents=this.viewingGroup):this.toggleListMode(!0))}return c.publish("Calendar/refetchEvents")},k.prototype.viewCalendarLinkClick=function(a){return a.preventDefault(),this.viewCalendarForElement(c(a.target))},k.prototype.showEventLinkClick=function(a){var b,d,e,f,g,h,i,j,k,l;a.preventDefault(),f=this.viewCalendarForElement(c(a.target)),e=c(a.target).data("event-id");if(e){k=f.object.appointmentEvents;for(g=0,i=k.length;g<i;g++){b=k[g],l=b.object.childEvents;for(h=0,j=l.length;h<j;h++){d=l[h];if(d.id!==e)continue;this.calendar.gotoDate(d.start);return}}}},k.prototype.viewCalendarForElement=function(a){var b,c,d,e,f;return d=a.closest(".appointment-group-item"),c=d.data("appointment-group-id"),d.addClass("active"),b=(e=this.groups)!=null?e[c]:void 0,this.viewCalendarForGroup((f=this.groups)!=null?f[c]:void 0),b},k.prototype.viewCalendarForGroupId=function(a){var b=this;return this.loadData(),this.loadingDeferred.done(function(){var c;return b.viewCalendarForGroup((c=b.groups)!=null?c[a]:void 0)})},k.prototype.viewCalendarForGroup=function(a){var b=this;return this.calendar.updateFragment({appointment_group_id:a.id}),this.toggleListMode(!1),this.viewingGroup=a,this.loadingDeferred.done(function(){return b.div.addClass("showing-single"),b.calendar.calendar.show(),b.calendar.calendar.fullCalendar("changeView","agendaWeek"),b.viewingGroup.start_at?b.calendar.gotoDate(c.parseFromISO(b.viewingGroup.start_at).time):b.calendar.gotoDate(new Date),b.calendar.displayAppointmentEvents=b.viewingGroup,c.publish("Calendar/refetchEvents"),b.redraw()})},k.prototype.doneClick=function(a){return a.preventDefault(),this.toggleListMode(!0)},k.prototype.showList=function(){return this.div.removeClass("showing-single"),this.listDiv.find(".appointment-group-item").removeClass("active"),this.calendar.calendar.hide(),this.calendar.displayAppointmentEvents=null},k.prototype.editLinkClick=function(a){var b,d;a.preventDefault(),b=(d=this.groups)!=null?d[c(a.target).closest(".appointment-group-item").data("appointment-group-id")]:void 0;if(!b)return;return this.createDialog=new h(b,this.appointmentGroupContexts,this.dialogCloseCB),this.createDialog.show()},k.prototype.deleteLinkClick=function(a){var b,d,f=this;a.preventDefault(),b=(d=this.groups)!=null?d[c(a.target).closest(".appointment-group-item").data("appointment-group-id")]:void 0;if(!b)return;return c("<div />").confirmDelete({url:b.url,message:c(j({message:e.t("confirm_appointment_group_deletion","Are you sure you want to delete this appointment group?"),details:e.t("appointment_group_deletion_details","Deleting it will also delete any appointments that have been signed up for by students.")})),dialog:{title:e.t("confirm_deletion","Confirm Deletion")},prepareData:function(a){return{cancel_reason:a.find("#cancel_reason").val()}},confirmed:function(){return c(a.target).closest(".appointment-group-item").addClass("event_pending")},success:function(){return f.calendar.dataSource.clearCache(),f.loadData()}})},k.prototype.messageLinkClick=function(a){var b,d;return a.preventDefault(),b=(d=this.groups)!=null?d[c(a.target).closest(".appointment-group-item").data("appointment-group-id")]:void 0,this.messageDialog=new i({group:b,dataSource:this.calendar.dataSource}),this.messageDialog.show()},k}()})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/calendar/Calendar",["i18n!calendar","jquery","compiled/util/hsvToRgb","jst/calendar/calendarApp","compiled/calendar/EventDataSource","compiled/calendar/commonEventFactory","compiled/calendar/ShowEventDetailsDialog","compiled/calendar/EditEventDetailsDialog","compiled/calendar/Scheduler","vendor/fullcalendar","jquery.instructure_misc_helpers","jquery.instructure_misc_plugins","vendor/jquery.ba-tinypubsub","jqueryui/button"],function(b,c,d,e,f,g,h,i,j){var k;return k=function(){function m(d,f,g,h,i){var k,l,m,n,o,p,q,r,s=this;this.contexts=f,this.manageContexts=g,this.dataSource=h,this.options=i,this.dataFromDocumentHash=a(this.dataFromDocumentHash,this),this.loadView=a(this.loadView,this),this.refetchEvents=a(this.refetchEvents,this),this.ajaxEnded=a(this.ajaxEnded,this),this.ajaxStarted=a(this.ajaxStarted,this),this.visibleContextListChanged=a(this.visibleContextListChanged,this),this.eventSaveFailed=a(this.eventSaveFailed,this),this.eventSaved=a(this.eventSaved,this),this.eventSaving=a(this.eventSaving,this),this.eventDeleted=a(this.eventDeleted,this),this.eventDeleting=a(this.eventDeleting,this),this.reloadClick=a(this.reloadClick,this),this.fragmentChange=a(this.fragmentChange,this),this.drop=a(this.drop,this),this.viewDisplay=a(this.viewDisplay,this),this.eventResize=a(this.eventResize,this),this.dayClick=a(this.dayClick,this),this.eventClick=a(this.eventClick,this),this.eventDrop=a(this.eventDrop,this),this.eventAfterRender=a(this.eventAfterRender,this),this.eventRender=a(this.eventRender,this),this.getEvents=a(this.getEvents,this),this.contextCodes=function(){var a,b,c;c=[];for(a=0,b=f.length;a<b;a++)k=f[a],c.push(k.asset_string);return c}(),this.visibleContextList=[],this.displayAppointmentEvents=null,this.activateEvent=(q=this.options)!=null?q.activateEvent:void 0,this.activeAjax=0,c.subscribe({"CommonEvent/eventDeleting":this.eventDeleting,"CommonEvent/eventDeleted":this.eventDeleted,"CommonEvent/eventSaving":this.eventSaving,"CommonEvent/eventSaved":this.eventSaved,"CommonEvent/eventSaveError":this.eventSaveFailed,"Calendar/visibleContextListChanged":this.visibleContextListChanged,"EventDataSource/ajaxStarted":this.ajaxStarted,"EventDataSource/ajaxEnded":this.ajaxEnded,"Calendar/refetchEvents":this.refetchEvents}),p='\'<span class="agenda-col-wrapper">\n  <span class="day-num">\'d\'</span>\n  <span class="day-and-month">\n    <span class="day-name">\'dddd\'</span><br />\n    <span class="month-name">\'MMM\'</span>\n  </span>\n</span>\'',n={header:{left:"prev,today,next",center:"title",right:""},editable:!0,columnFormat:{month:"dddd",week:p},allDayDefault:!1,buttonText:{today:b.t("today","Today")},defaultEventMinutes:60,weekMode:"variable",slotMinutes:30,firstHour:7,droppable:!0,dropAccept:".undated_event",ignoreTimezone:!0,lazyFetching:!1,events:this.getEvents,eventRender:this.eventRender,eventAfterRender:this.eventAfterRender,eventDrop:this.eventDrop,eventClick:this.eventClick,eventResize:this.eventResize,dayClick:this.dayClick,titleFormat:{week:"MMM d[ yyyy]{ '&ndash;'[ MMM] d, yyyy}"},viewDisplay:this.viewDisplay,drop:this.drop},l=this.dataFromDocumentHash(),!l.view_start&&((r=this.options)!=null?r.viewStart:void 0)&&(l.view_start=this.options.viewStart,location.hash=c.encodeToHex(JSON.stringify(l))),l.view_start&&(m=c.fullCalendar.parseISO8601(l.view_start),m&&(n.year=m.getFullYear(),n.month=m.getMonth(),n.date=m.getDate())),this.el=c(d).html(e());if(l.view_name==="month"||l.view_name==="agendaWeek")o=l.view_name==="agendaWeek"?"week":"month",c("#"+o).click(),n.defaultView=l.view_name;l.show&&l.show!==""&&(this.visibleContextList=l.show.split(",")),this.calendar=this.el.find("div.calendar").fullCalendar(n),c(document).fragmentChange(this.fragmentChange),this.el.find("#calendar_views").buttonset().find("input").change(function(a){return s.loadView(c(a.target).attr("id"))}),this.$refresh_calendar_link=this.el.find("#refresh_calendar_link").click(this.reloadClick),this.colorizeContexts(),this.scheduler=new j(".scheduler-wrapper",this),c("html").addClass("calendar-loaded"),this.dataSource.getAppointmentGroups(!1,function(a){var b,c,d,e;c=0;for(d=0,e=a.length;d<e;d++)b=a[d],b.requiring_action&&(c+=1);return s.el.find("#calendar-header .counter-badge").toggle(c>0).text(c)}),window.setTimeout(function(){if(l.view_name==="scheduler"){c("#scheduler").click();if(l.appointment_group_id)return s.scheduler.viewCalendarForGroupId(l.appointment_group_id)}})}var f,k,l;return m.name="Calendar",m.prototype.getEvents=function(a,b,d){var e,f=this;return e=function(a){var b,c,d,e,g,h,i;c={};if(a.length>0){for(d=g=h=a.length-1;h>0?g>=0:g<=0;d=h>0?--g:++g)b=a[d],e=!0,c[b.id]?e=!1:b.isAppointmentGroupEvent()&&(f.displayAppointmentEvents?f.displayAppointmentEvents.id===((i=b.calendarEvent)!=null?i.appointment_group_id:void 0)?e=!!b.calendarEvent.reserve_url:e=!b.calendarEvent.reserve_url:b.calendarEvent.reserve_url?b.calendarEvent.child_events_count>0&&!b.calendarEvent.reserved?e=!0:e=!1:e=!0),e||a.splice(d,1),c[b.id]=!0;return a}return a},this.dataSource.getEvents(c.unfudgeDateForProfileTimezone(a),c.unfudgeDateForProfileTimezone(b),this.visibleContextList,function(a){return f.displayAppointmentEvents?f.dataSource.getEventsForAppointmentGroup(f.displayAppointmentEvents,function(b){var c,f,g,h,i;for(f=0,h=a.length;f<h;f++)c=a[f],c.removeClass("current-appointment-group");for(g=0,i=b.length;g<i;g++)c=b[g],c.addClass("current-appointment-group");return d(e(a.concat(b)))}):d(e(a))})},m.prototype.eventRender=function(a,b,d){var e;return a.isAppointmentGroupEvent()&&this.displayAppointmentEvents&&this.displayAppointmentEvents.id===a.calendarEvent.appointment_group_id&&(e="Available",a.calendarEvent.available_slots>0&&(e=""+a.calendarEvent.available_slots+" Available"),a.calendarEvent.available_slots===0&&(e="Filled"),a.calendarEvent.reserved===!0&&(e="Reserved"),c(b).find(".fc-event-title").text(e)),!0},m.prototype.eventAfterRender=function(a,b,c){var d,e;a.eventType==="assignment"&&a.isDueAtMidnight()&&b.find(".fc-event-time").remove(),a.eventType==="assignment"&&c.name==="agendaWeek"&&b.height("").find(".ui-resizable-handle").remove();if(a.eventType==="calendar_event"&&((d=this.options)!=null?d.activateEvent:void 0)&&a.id==="calendar_event_"+((e=this.options)!=null?e.activateEvent:void 0))return this.options.activateEvent=null,this.eventClick(a,{currentTarget:b,pageX:b.offset().left+parseInt(b.width()/2)},c)},m.prototype.eventDrop=function(a,b,c,d,e,f,g,h){return a.eventType==="assignment"&&a.isDueAtMidnight()&&c===0&&a.start.setMinutes(59),a.saveDates(null,e)},m.prototype.eventClick=function(a,b,c){return(new h(a)).show(b)},m.prototype.dayClick=function(a,b,c,d){var e;if(this.displayAppointmentEvents)return;return e=g(null,this.contexts),e.allDay=b,e.date=a,(new i(e)).show()},m.prototype.eventResize=function(a,b,c,d,e,f,g){return a.saveDates(null,d)},m.prototype.updateFragment=function(a){var b,d,e;b=this.dataFromDocumentHash();for(d in a)e=a[d],b[d]=e;return location.replace("#"+c.encodeToHex(JSON.stringify(b)))},m.prototype.viewDisplay=function(a){return this.updateFragment({view_start:c.dateToISO8601UTC(a.start)})},m.prototype.drop=function(a,b,d,e){var f,g;f=c(d.target),g=f.data("calendarEvent");if(g)return g.start=a,g.addClass("event_pending"),this.calendar.fullCalendar("renderEvent",g),g.saveDates(null,function(){return console.log("could not save date on undated event")})},m.prototype.fragmentChange=function(a,b){var d,e,f,g;d=this.dataFromDocumentHash(),f=(g=this.calendar)!=null?g.fullCalendar("getView"):void 0;if(!f||!!c.isEmptyObject(d))return;(d.view_name==="month"||d.view_name==="agendaWeek")&&d.view_name!==f.name&&this.calendar.fullCalendar("changeView",d.view_name);if(d.view_start&&d.view_start!==c.dateToISO8601UTC(f.start)){e=c.fullCalendar.parseISO8601(d.view_start);if(e)return this.calendar.fullCalendar("gotoDate",e)}},m.prototype.reloadClick=function(a){a.preventDefault();if(this.activeAjax===0)return this.dataSource.clearCache(),this.currentView==="scheduler"&&this.scheduler.loadData(),this.calendar.fullCalendar("refetchEvents")},m.prototype.eventDeleting=function(a){return a.addClass("event_pending"),this.calendar.fullCalendar("updateEvent",a)},m.prototype.eventDeleted=function(a){return this.calendar.fullCalendar("removeEvents",a.id)},m.prototype.eventSaving=function(a){if(!a.start)return;return a.addClass("event_pending"),a.isNewEvent()?this.calendar.fullCalendar("renderEvent",a):this.calendar.fullCalendar("updateEvent",a)},m.prototype.eventSaved=function(a){return a.removeClass("event_pending"),this.calendar.fullCalendar("refetchEvents")},m.prototype.eventSaveFailed=function(a){return a.removeClass("event_pending"),a.isNewEvent()?this.calendar.fullCalendar("removeEvents",a.id):this.calendar.fullCalendar("updateEvent",a)},m.prototype.visibleContextListChanged=function(a){return this.visibleContextList=a,this.calendar.fullCalendar("refetchEvents")},m.prototype.ajaxStarted=function(){return this.activeAjax+=1,this.$refresh_calendar_link.addClass("loading")},m.prototype.ajaxEnded=function(){this.activeAjax-=1;if(!this.activeAjax)return this.$refresh_calendar_link.removeClass("loading")},m.prototype.refetchEvents=function(){return this.calendar.fullCalendar("refetchEvents")},m.prototype.gotoDate=function(a){return this.calendar.fullCalendar("gotoDate",a)},m.prototype.loadView=function(a){return this.updateFragment({view_name:a}),a!=="scheduler"?(this.currentView=a,this.calendar.removeClass("scheduler-mode"),this.displayAppointmentEvents=null,this.scheduler.hide(),this.calendar.show(),this.calendar.fullCalendar("refetchEvents"),this.calendar.fullCalendar("changeView",a==="week"?"agendaWeek":"month")):(this.currentView="scheduler",this.calendar.addClass("scheduler-mode"),this.calendar.hide(),this.scheduler.show())},f=c("<div />").appendTo("body"),l=[43,5,205,85,289,63,230,186,115,330],k=function(a,b,c){var e;return e=d(a,b,c),"rgb("+e.join(" ,")+")"},m.prototype.colorizeContexts=function(){var a,b,c,d,e,g,h,i,j,m,n,o,p;return n=[30,96],b=n[0],a=n[1],o=[60,40],m=o[0],j=o[1],p=[70,70],i=p[0],h=p[1],d=function(){var d,f,n,o;n=this.contextCodes,o=[];for(g=d=0,f=n.length;d<f;g=++d)c=n[g],e=l[g%l.length],o.push(".group_"+c+"{           color: "+k(e,m,j)+";           border-color: "+k(e,i,h)+";           background-color: "+k(e,b,a)+";        }");return o}.call(this),f.html("<style>"+d.join("")+"</style>")},m.prototype.dataFromDocumentHash=function(){var a;a={};try{a=c.parseJSON(c.decodeFromHex(location.hash.substring(1)))||{}}catch(b){a={}}return a},m}()})}.call(this),function(){require(["jquery","compiled/calendar/Calendar","compiled/calendar/MiniCalendar","compiled/calendar/sidebar","compiled/calendar/EventDataSource","compiled/calendar/UndatedEventsList","compiled/bundles/jquery_ui_menu"],function(a,b,c,d,e,f){return this.eventDataSource=new e(ENV.CALENDAR.CONTEXTS),this.calendar=new b("#calendar-app",ENV.CALENDAR.CONTEXTS,ENV.CALENDAR.MANAGE_CONTEXTS,this.eventDataSource,{activateEvent:ENV.CALENDAR.ACTIVE_EVENT,viewStart:ENV.CALENDAR.VIEW_START}),new c("#minical",this.calendar),new f("#undated-events",this.eventDataSource),d(ENV.CALENDAR.CONTEXTS,ENV.CALENDAR.SELECTED_CONTEXTS,this.eventDataSource)})}.call(this),define("compiled/bundles/calendar2",function(){})