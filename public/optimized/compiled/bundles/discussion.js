/*!
 * jQuery UI @VERSION
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */
/*!
 * jQuery UI Widget @VERSION
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */
(function(){var a={};define("use",{version:"0.2.0",load:function(b,c,d,e){e||(e=require.rawConfig);var f=e.use&&e.use[b];if(!f)throw new TypeError("Module '"+b+"' is undefined or does not"+" have a `use` config. Make sure it exists, add a `use` config, or"+" don't use use! on it");a[b]={deps:f.deps||[],attach:f.attach},c(f.deps||[],function(){var a=arguments;c([b],function(){var b=f.attach;return e.isBuild?d():typeof b=="function"?d(b.apply(window,a)):d(window[b])})})},write:function(b,c,d){var e=a[c],f=e.deps,g={attach:null,deps:""};typeof e.attach=="function"?g.attach=e.attach.toString():g.attach="function() {return window['"+e.attach+"'];"+"}",f.length&&(g.deps="'"+f.toString().split(",").join("','")+"'"),d(["define('",b,"!",c,"', ","[",g.deps,"],",g.attach,");\n"].join(""))}})})(),function(){var a=this,b=a.Backbone,c=Array.prototype.slice,d=Array.prototype.splice,e;typeof exports!="undefined"?e=exports:e=a.Backbone={},e.VERSION="0.9.1";var f=a._;!f&&typeof require!="undefined"&&(f=require("underscore"));var g=a.jQuery||a.Zepto||a.ender;e.setDomLibrary=function(a){g=a},e.noConflict=function(){return a.Backbone=b,this},e.emulateHTTP=!1,e.emulateJSON=!1,e.Events={on:function(a,b,c){var d;a=a.split(/\s+/);var e=this._callbacks||(this._callbacks={});while(d=a.shift()){var f=e[d]||(e[d]={}),g=f.tail||(f.tail=f.next={});g.callback=b,g.context=c,f.tail=g.next={}}return this},off:function(a,b,c){var d,e,f;if(!a)delete this._callbacks;else if(e=this._callbacks){a=a.split(/\s+/);while(d=a.shift()){f=e[d],delete e[d];if(!b||!f)continue;while((f=f.next)&&f.next)if(f.callback!==b||!!c&&f.context!==c)this.on(d,f.callback,f.context);else continue}}return this},trigger:function(a){var b,d,e,f,g,h,i;if(!(e=this._callbacks))return this;h=e.all,(a=a.split(/\s+/)).push(null);while(b=a.shift()){h&&a.push({next:h.next,tail:h.tail,event:b});if(!(d=e[b]))continue;a.push({next:d.next,tail:d.tail})}i=c.call(arguments,1);while(d=a.pop()){f=d.tail,g=d.event?[d.event].concat(i):i;while((d=d.next)!==f)d.callback.apply(d.context||this,g)}return this}},e.Events.bind=e.Events.on,e.Events.unbind=e.Events.off,e.Model=function(a,b){var c;a||(a={}),b&&b.parse&&(a=this.parse(a));if(c=u(this,"defaults"))a=f.extend({},c,a);b&&b.collection&&(this.collection=b.collection),this.attributes={},this._escapedAttributes={},this.cid=f.uniqueId("c");if(!this.set(a,{silent:!0}))throw new Error("Can't create an invalid model");delete this._changed,this._previousAttributes=f.clone(this.attributes),this.initialize.apply(this,arguments)},f.extend(e.Model.prototype,e.Events,{idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;var c=this.attributes[a];return this._escapedAttributes[a]=f.escape(c==null?"":""+c)},has:function(a){return this.attributes[a]!=null},set:function(a,b,c){var d,g,h;f.isObject(a)||a==null?(d=a,c=b):(d={},d[a]=b),c||(c={});if(!d)return this;d instanceof e.Model&&(d=d.attributes);if(c.unset)for(g in d)d[g]=void 0;if(!this._validate(d,c))return!1;this.idAttribute in d&&(this.id=d[this.idAttribute]);var i=this.attributes,j=this._escapedAttributes,k=this._previousAttributes||{},l=this._setting;this._changed||(this._changed={}),this._setting=!0;for(g in d){h=d[g],f.isEqual(i[g],h)||delete j[g],c.unset?delete i[g]:i[g]=h,this._changing&&!f.isEqual(this._changed[g],h)&&(this.trigger("change:"+g,this,h,c),this._moreChanges=!0),delete this._changed[g];if(!f.isEqual(k[g],h)||f.has(i,g)!=f.has(k,g))this._changed[g]=h}return l||(!c.silent&&this.hasChanged()&&this.change(c),this._setting=!1),this},unset:function(a,b){return(b||(b={})).unset=!0,this.set(a,null,b)},clear:function(a){return(a||(a={})).unset=!0,this.set(f.clone(this.attributes),a)},fetch:function(a){a=a?f.clone(a):{};var b=this,c=a.success;return a.success=function(d,e,f){if(!b.set(b.parse(d,f),a))return!1;c&&c(b,d)},a.error=e.wrapError(a.error,b,a),(this.sync||e.sync).call(this,"read",this,a)},save:function(a,b,c){var d,g;f.isObject(a)||a==null?(d=a,c=b):(d={},d[a]=b),c=c?f.clone(c):{},c.wait&&(g=f.clone(this.attributes));var h=f.extend({},c,{silent:!0});if(d&&!this.set(d,c.wait?h:c))return!1;var i=this,j=c.success;c.success=function(a,b,e){var g=i.parse(a,e);c.wait&&(g=f.extend(d||{},g));if(!i.set(g,c))return!1;j?j(i,a):i.trigger("sync",i,a,c)},c.error=e.wrapError(c.error,i,c);var k=this.isNew()?"create":"update",l=(this.sync||e.sync).call(this,k,this,c);return c.wait&&this.set(g,h),l},destroy:function(a){a=a?f.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(this.isNew())return d();a.success=function(e){a.wait&&d(),c?c(b,e):b.trigger("sync",b,e,a)},a.error=e.wrapError(a.error,b,a);var g=(this.sync||e.sync).call(this,"delete",this,a);return a.wait||d(),g},url:function(){var a=u(this.collection,"url")||u(this,"urlRoot")||v();return this.isNew()?a:a+(a.charAt(a.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(a){if(this._changing||!this.hasChanged())return this;this._changing=!0,this._moreChanges=!0;for(var b in this._changed)this.trigger("change:"+b,this,this._changed[b],a);while(this._moreChanges)this._moreChanges=!1,this.trigger("change",this,a);return this._previousAttributes=f.clone(this.attributes),delete this._changed,this._changing=!1,this},hasChanged:function(a){return arguments.length?this._changed&&f.has(this._changed,a):!f.isEmpty(this._changed)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this._changed):!1;var b,c=!1,d=this._previousAttributes;for(var e in a){if(f.isEqual(d[e],b=a[e]))continue;(c||(c={}))[e]=b}return c},previous:function(a){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return f.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(a,b){if(b.silent||!this.validate)return!0;a=f.extend({},this.attributes,a);var c=this.validate(a,b);return c?(b&&b.error?b.error(this,c,b):this.trigger("error",this,c,b),!1):!0}}),e.Collection=function(a,b){b||(b={}),b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,{silent:!0,parse:b.parse})},f.extend(e.Collection.prototype,e.Events,{model:e.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,b){var c,e,g,h,i,j,k={},l={};b||(b={}),a=f.isArray(a)?a.slice():[a];for(c=0,g=a.length;c<g;c++){if(!(h=a[c]=this._prepareModel(a[c],b)))throw new Error("Can't add an invalid model to a collection");if(k[i=h.cid]||this._byCid[i]||(j=h.id)!=null&&(l[j]||this._byId[j]))throw new Error("Can't add the same model to a collection twice");k[i]=l[j]=h}for(c=0;c<g;c++)(h=a[c]).on("all",this._onModelEvent,this),this._byCid[h.cid]=h,h.id!=null&&(this._byId[h.id]=h);this.length+=g,e=b.at!=null?b.at:this.models.length,d.apply(this.models,[e,0].concat(a)),this.comparator&&this.sort({silent:!0});if(b.silent)return this;for(c=0,g=this.models.length;c<g;c++){if(!k[(h=this.models[c]).cid])continue;b.index=c,h.trigger("add",h,this,b)}return this},remove:function(a,b){var c,d,e,g;b||(b={}),a=f.isArray(a)?a.slice():[a];for(c=0,d=a.length;c<d;c++){g=this.getByCid(a[c])||this.get(a[c]);if(!g)continue;delete this._byId[g.id],delete this._byCid[g.cid],e=this.indexOf(g),this.models.splice(e,1),this.length--,b.silent||(b.index=e,g.trigger("remove",g,this,b)),this._removeReference(g)}return this},get:function(a){return a==null?null:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var b=f.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(b):this.models.sort(b),a.silent||this.trigger("reset",this,a),this},pluck:function(a){return f.map(this.models,function(b){return b.get(a)})},reset:function(a,b){a||(a=[]),b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);return this._reset(),this.add(a,{silent:!0,parse:b.parse}),b.silent||this.trigger("reset",this,b),this},fetch:function(a){a=a?f.clone(a):{},a.parse===undefined&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d,e,f){b[a.add?"add":"reset"](b.parse(d,f),a),c&&c(b,d)},a.error=e.wrapError(a.error,b,a),(this.sync||e.sync).call(this,"read",this,a)},create:function(a,b){var c=this;b=b?f.clone(b):{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||c.add(a,b);var d=b.success;return b.success=function(e,f,g){b.wait&&c.add(e,b),d?d(e,f):e.trigger("sync",a,f,b)},a.save(null,b),a},parse:function(a,b){return a},chain:function(){return f(this.models).chain()},_reset:function(a){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(a,b){if(a instanceof e.Model)a.collection||(a.collection=this);else{var c=a;b.collection=this,a=new this.model(c,b),a._validate(a.attributes,b)||(a=!1)}return a},_removeReference:function(a){this==a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){if(a!="add"&&a!="remove"||c==this)a=="destroy"&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments);else return}});var h=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];f.each(h,function(a){e.Collection.prototype[a]=function(){return f[a].apply(f,[this.models].concat(f.toArray(arguments)))}}),e.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};var i=/:\w+/g,j=/\*\w+/g,k=/[-[\]{}()+?.,\\^$|#\s]/g;f.extend(e.Router.prototype,e.Events,{initialize:function(){},route:function(a,b,c){return e.history||(e.history=new e.History),f.isRegExp(a)||(a=this._routeToRegExp(a)),c||(c=this[b]),e.history.route(a,f.bind(function(d){var f=this._extractParameters(a,d);c&&c.apply(this,f),this.trigger.apply(this,["route:"+b].concat(f)),e.history.trigger("route",this,b,f)},this)),this},navigate:function(a,b){e.history.navigate(a,b)},_bindRoutes:function(){if(!this.routes)return;var a=[];for(var b in this.routes)a.unshift([b,this.routes[b]]);for(var c=0,d=a.length;c<d;c++)this.route(a[c][0],a[c][1],this[a[c][1]])},_routeToRegExp:function(a){return a=a.replace(k,"\\$&").replace(i,"([^/]+)").replace(j,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}}),e.History=function(){this.handlers=[],f.bindAll(this,"checkUrl")};var l=/^[#\/]/,m=/msie [\w.]+/,n=!1;f.extend(e.History.prototype,e.Events,{interval:50,getFragment:function(a,b){if(a==null)if(this._hasPushState||b){a=window.location.pathname;var c=window.location.search;c&&(a+=c)}else a=window.location.hash;return a=decodeURIComponent(a),a.indexOf(this.options.root)||(a=a.substr(this.options.root.length)),a.replace(l,"")},start:function(a){if(n)throw new Error("Backbone.history has already been started");this.options=f.extend({},{root:"/"},this.options,a),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var b=this.getFragment(),c=document.documentMode,d=m.exec(navigator.userAgent.toLowerCase())&&(!c||c<=7);d&&(this.iframe=g('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(b)),this._hasPushState?g(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!d?g(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=b,n=!0;var e=window.location,h=e.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&h&&e.hash&&(this.fragment=e.hash.replace(l,""),window.history.replaceState({},document.title,e.protocol+"//"+e.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){g(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),n=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();b==this.fragment&&this.iframe&&(b=this.getFragment(this.iframe.location.hash));if(b==this.fragment||b==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(b),this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(a){var b=this.fragment=this.getFragment(a),c=f.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0});return c},navigate:function(a,b){if(!n)return!1;if(!b||b===!0)b={trigger:b};var c=(a||"").replace(l,"");if(this.fragment==c||this.fragment==decodeURIComponent(c))return;this._hasPushState?(c.indexOf(this.options.root)!=0&&(c=this.options.root+c),this.fragment=c,window.history[b.replace?"replaceState":"pushState"]({},document.title,c)):this._wantsHashChange?(this.fragment=c,this._updateHash(window.location,c,b.replace),this.iframe&&c!=this.getFragment(this.iframe.location.hash)&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,c,b.replace))):window.location.assign(this.options.root+a),b.trigger&&this.loadUrl(a)},_updateHash:function(a,b,c){c?a.replace(a.toString().replace(/(javascript:|#).*$/,"")+"#"+b):a.hash=b}}),e.View=function(a){this.cid=f.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()};var o=/^(\S+)\s*(.*)$/,p=["model","collection","el","id","attributes","className","tagName"];f.extend(e.View.prototype,e.Events,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(a,b,c){var d=document.createElement(a);return b&&g(d).attr(b),c&&g(d).html(c),d},setElement:function(a,b){return this.$el=g(a),this.el=this.$el[0],b!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=u(this,"events")))return;this.undelegateEvents();for(var b in a){var c=a[b];f.isFunction(c)||(c=this[a[b]]);if(!c)throw new Error('Event "'+a[b]+'" does not exist');var d=b.match(o),e=d[1],g=d[2];c=f.bind(c,this),e+=".delegateEvents"+this.cid,g===""?this.$el.bind(e,c):this.$el.delegate(g,e,c)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=f.extend({},this.options,a));for(var b=0,c=p.length;b<c;b++){var d=p[b];a[d]&&(this[d]=a[d])}this.options=a},_ensureElement:function(){if(!this.el){var a=u(this,"attributes")||{};this.id&&(a.id=this.id),this.className&&(a["class"]=this.className),this.setElement(this.make(this.tagName,a),!1)}else this.setElement(this.el,!1)}});var q=function(a,b){var c=t(this,a,b);return c.extend=this.extend,c};e.Model.extend=e.Collection.extend=e.Router.extend=e.View.extend=q;var r={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};e.sync=function(a,b,c){var d=r[a],h={type:d,dataType:"json"};return c.url||(h.url=u(b,"url")||v()),!c.data&&b&&(a=="create"||a=="update")&&(h.contentType="application/json",h.data=JSON.stringify(b.toJSON())),e.emulateJSON&&(h.contentType="application/x-www-form-urlencoded",h.data=h.data?{model:h.data}:{}),e.emulateHTTP&&(d==="PUT"||d==="DELETE")&&(e.emulateJSON&&(h.data._method=d),h.type="POST",h.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",d)}),h.type!=="GET"&&!e.emulateJSON&&(h.processData=!1),g.ajax(f.extend(h,c))},e.wrapError=function(a,b,c){return function(d,e){e=d===b?e:d,a?a(b,e,c):b.trigger("error",b,e,c)}};var s=function(){},t=function(a,b,c){var d;return b&&b.hasOwnProperty("constructor")?d=b.constructor:d=function(){a.apply(this,arguments)},f.extend(d,a),s.prototype=a.prototype,d.prototype=new s,b&&f.extend(d.prototype,b),c&&f.extend(d,c),d.prototype.constructor=d,d.__super__=a.prototype,d},u=function(a,b){return!a||!a[b]?null:f.isFunction(a[b])?a[b]():a[b]},v=function(){throw new Error('A "url" property or function must be specified')}}.call(this),define("vendor/backbone",function(){}),define("use!vendor/backbone",["underscore","jquery"],function(a,b){return Backbone}),function(){define("compiled/backbone-ext/Backbone.syncWithMultipart",["use!vendor/backbone","underscore"],function(a,b){return a.syncWithoutMultipart=a.sync,a.syncWithMultipart=function(a,c,d){var e,f,g,h,i,j,k,l;return j="file_upload_iframe_"+(new Date).getTime(),f=$("<iframe id='"+j+"' name='"+j+"' ></iframe>").hide(),i={create:"POST",update:"PUT","delete":"DELETE",read:"GET"}[a],k=function(a,c){var d;return d=b.map(a,function(a,c){var d,e;if(b.isElement(a))return e=$(a),e.after(e.clone(!0)),a;if(!b.isEmpty(a)&&(b.isArray(a)||typeof a=="object"))return k(a,c);if(!(""+c).match(/^_/)&&a!=null&&typeof a!="object"&&typeof a!="function")return d=$("<input/>",{name:c,value:a}),d[0]}),b.flatten(d)},e=$("<form enctype='multipart/form-data' target='"+j+"' action='"+((l=d.url)!=null?l:c.url())+"' method='POST'>\n  <input type='hidden' name='_method' value='"+i+"' />\n  <input type='hidden' name='authenticity_token' value='"+ENV.AUTHENTICITY_TOKEN+"' />\n</form>").hide(),e.prepend(function(){var a,b,d,e;d=k(c),e=[];for(a=0,b=d.length;a<b;a++)h=d[a],h&&e.push(h);return e}()),$(document.body).prepend(f,e),g=function(){var a,b,c;return a=(f[0].contentDocument||f[0].contentWindow.document).body,b=$.parseJSON($(a).text()),b=(c=b.objects)!=null?c:b,a.className==="error"?typeof d.error=="function"&&d.error(b):typeof d.success=="function"&&d.success(b),f.remove(),e.remove()},f[0].onreadystatechange=function(){if(this.readyState==="complete")return g()},f[0].onload=g,e[0].submit()},a.sync=function(b,c,d){return(d!=null?d.multipart:void 0)?a.syncWithMultipart.apply(this,arguments):a.syncWithoutMultipart.apply(this,arguments)}})}.call(this),function(){define("compiled/backbone-ext/Model/computedAttributes",["use!vendor/backbone","underscore"],function(a,b){return b.extend(a.Model.prototype,{initialize:function(){if(this.computedAttributes!=null)return this._configureComputedAttributes()},_configureComputedAttributes:function(){var a,c=this;return a=function(a){return c.set(a,c[a]())},b.each(this.computedAttributes,function(d){var e;return typeof d=="string"?a(d):(a(d.name),e=b.map(d.deps,function(a){return"change:"+a}).join(" "),c.bind(e,function(){return a(d.name)}))})}}),a.Model})}.call(this),function(){define("compiled/backbone-ext/Model/dateAttributes",["use!vendor/backbone","underscore"],function(a,b){var c;return c=a.Model.prototype.parse,a.Model.prototype.parse=function(){var a;return a=c.apply(this,arguments),b.each(this.dateAttributes,function(b){if(a[b])return a[b]=Date.parse(a[b])}),a},a.Model})}.call(this),function(){define("compiled/backbone-ext/Model",["use!vendor/backbone","compiled/backbone-ext/Model/computedAttributes","compiled/backbone-ext/Model/dateAttributes"],function(a){return a.Model})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a},d=[].slice;define("compiled/backbone-ext/View",["use!vendor/backbone","underscore"],function(b,e){return b.View=function(b){function f(){return this.renderView=a(this.renderView,this),f.__super__.constructor.apply(this,arguments)}return c(f,b),f.name="View",f.prototype.views=!1,f.prototype.render=function(a){return a==null&&(a={}),this.options.views&&this.renderViews(),a.noFilter!==!0&&this.filter(),this},f.prototype.filter=function(){var a=this;return this.$("[data-bind]").each(function(){return a.createBinding.apply(a,arguments)})},f.prototype.renderViews=function(){return e.each(this.options.views,this.renderView)},f.prototype.renderView=function(a,b){var c;return c=this.$("."+b).first(),a.$el=c,a.el=c[0],a.delegateEvents(),a.render()},f.prototype.createBinding=function(a,b){var c,d,e=this;return c=$(b),d=c.data("bind"),this.model.bind("change:"+d,function(a,b){return c.html(b)})},f.mixin=function(){var a,b,c,f,g,h;c=1>arguments.length?[]:d.call(arguments,0);for(g=0,h=c.length;g<h;g++){b=c[g];for(a in b)f=b[a],a==="events"?e.extend(this.prototype[a],f):this.prototype[a]=f}return this},f}(b.View),b.View})}.call(this),define("Backbone",["use!vendor/backbone","compiled/backbone-ext/Backbone.syncWithMultipart","compiled/backbone-ext/Model","compiled/backbone-ext/View"],function(a){return a.noConflict()}),function(){define("compiled/discussions/app",[],function(){return{}})}.call(this),define("translations/discussions",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),function(){define("compiled/discussions/findParticipant",["i18n!discussions","compiled/discussions/app"],function(a,b){var c,d;return c={avatar_image_url:null,display_name:a.t("uknown_author","Unknown Author"),id:null},d=function(a){var d,e;return d=(e=b.topicView.discussion)!=null?e.participants.get(a):void 0,d!=null?d.toJSON():a===ENV.DISCUSSION.CURRENT_USER.id?ENV.DISCUSSION.CURRENT_USER:c}})}.call(this),define("translations/discussions.entry_collection_view",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("vendor/ui.selectmenu",["jquery","vendor/jquery.scrollTo","jqueryui/widget"],function(a){a.widget("ui.selectmenu",{getter:"value",version:"1.9",eventPrefix:"selectmenu",options:{transferClasses:!0,appendTo:"body",typeAhead:1e3,style:"dropdown",positionOptions:{my:"left top",at:"left bottom",offset:null},width:null,menuWidth:null,handleWidth:26,maxHeight:null,icons:null,format:null,escapeHtml:!1,bgImage:function(){}},_create:function(){var b=this,c=this.options,d=(this.element.attr("id")||"ui-selectmenu-"+Math.random().toString(16).slice(2,10)).replace(":","\\:");this.ids=[d,d+"-button",d+"-menu"],this._safemouseup=!0,this.isOpen=!1,this.newelement=a("<a />",{"class":this.widgetBaseClass+" ui-widget ui-state-default ui-corner-all",id:this.ids[1],role:"button",href:"#nogo",tabindex:this.element.attr("disabled")?1:0,"aria-haspopup":!0,"aria-owns":this.ids[2]}),this.newelementWrap=a("<span />").append(this.newelement).insertAfter(this.element);var e=this.element.attr("tabindex");e&&this.newelement.attr("tabindex",e),this.newelement.data("selectelement",this.element),this.selectmenuIcon=a('<span class="'+this.widgetBaseClass+'-icon ui-icon"></span>').prependTo(this.newelement),this.newelement.prepend('<span class="'+b.widgetBaseClass+'-status" />'),this.element.bind({"click.selectmenu":function(a){b.newelement.focus(),a.preventDefault()}}),this.newelement.bind("mousedown.selectmenu",function(a){return b._toggle(a,!0),c.style=="popup"&&(b._safemouseup=!1,setTimeout(function(){b._safemouseup=!0},300)),!1}).bind("click.selectmenu",function(){return!1}).bind("keydown.selectmenu",function(c){var d=!1;switch(c.keyCode){case a.ui.keyCode.ENTER:d=!0;break;case a.ui.keyCode.SPACE:b._toggle(c);break;case a.ui.keyCode.UP:c.altKey?b.open(c):b._moveSelection(-1);break;case a.ui.keyCode.DOWN:c.altKey?b.open(c):b._moveSelection(1);break;case a.ui.keyCode.LEFT:b._moveSelection(-1);break;case a.ui.keyCode.RIGHT:b._moveSelection(1);break;case a.ui.keyCode.TAB:d=!0;break;case a.ui.keyCode.PAGE_UP:case a.ui.keyCode.HOME:b.index(0);break;case a.ui.keyCode.PAGE_DOWN:case a.ui.keyCode.END:b.index(b._optionLis.length);break;default:d=!0}return d}).bind("keypress.selectmenu",function(a){return a.which>0&&b._typeAhead(a.which,"mouseup"),!0}).bind("mouseover.selectmenu",function(){c.disabled||a(this).addClass("ui-state-hover")}).bind("mouseout.selectmenu",function(){c.disabled||a(this).removeClass("ui-state-hover")}).bind("focus.selectmenu",function(){c.disabled||a(this).addClass("ui-state-focus")}).bind("blur.selectmenu",function(){c.disabled||a(this).removeClass("ui-state-focus")}),a(document).bind("mousedown.selectmenu-"+this.ids[0],function(a){b.isOpen&&b.close(a)}),this.element.bind("click.selectmenu",function(){b._refreshValue()}).bind("focus.selectmenu",function(){b.newelement&&b.newelement[0].focus()}),c.width||(c.width=this.element.outerWidth()),this.newelement.width(c.width),this.element.hide(),this.list=a("<ul />",{"class":"ui-widget ui-widget-content","aria-hidden":!0,role:"listbox","aria-labelledby":this.ids[1],id:this.ids[2]}),this.listWrap=a("<div />",{"class":b.widgetBaseClass+"-menu"}).append(this.list).appendTo(c.appendTo),this.list.bind("keydown.selectmenu",function(c){var d=!1;switch(c.keyCode){case a.ui.keyCode.UP:c.altKey?b.close(c,!0):b._moveFocus(-1);break;case a.ui.keyCode.DOWN:c.altKey?b.close(c,!0):b._moveFocus(1);break;case a.ui.keyCode.LEFT:b._moveFocus(-1);break;case a.ui.keyCode.RIGHT:b._moveFocus(1);break;case a.ui.keyCode.HOME:b._moveFocus(":first");break;case a.ui.keyCode.PAGE_UP:b._scrollPage("up");break;case a.ui.keyCode.PAGE_DOWN:b._scrollPage("down");break;case a.ui.keyCode.END:b._moveFocus(":last");break;case a.ui.keyCode.ENTER:case a.ui.keyCode.SPACE:b.close(c,!0),a(c.target).parents("li:eq(0)").trigger("mouseup");break;case a.ui.keyCode.TAB:d=!0,b.close(c,!0),a(c.target).parents("li:eq(0)").trigger("mouseup");break;case a.ui.keyCode.ESCAPE:b.close(c,!0);break;default:d=!0}return d}).bind("keypress.selectmenu",function(a){return a.which>0&&b._typeAhead(a.which,"focus"),!0}).bind("mousedown.selectmenu mouseup.selectmenu",function(){return!1}),a(window).bind("resize.selectmenu-"+this.ids[0],a.proxy(b.close,this))},_init:function(){var b=this,c=this.options,d=[];this.element.find("option").each(function(){var e=a(this);d.push({value:e.attr("value"),text:b._formatText(e.text()),selected:e.attr("selected"),disabled:e.attr("disabled"),classes:e.attr("class"),typeahead:e.attr("typeahead"),parentOptGroup:e.parent("optgroup"),bgImage:c.bgImage.call(e)})});var e=b.options.style=="popup"?" ui-state-active":"";this.list.html("");if(d.length)for(var f=0;f<d.length;f++){var g={role:"presentation"};d[f].disabled&&(g["class"]=this.namespace+"-state-disabled");var h={html:d[f].text||"&nbsp;",href:"#nogo",tabindex:-1,role:"option","aria-selected":!1};d[f].disabled&&(h["aria-disabled"]=d[f].disabled),d[f].typeahead&&(h.typeahead=d[f].typeahead);var i=a("<a/>",h),j=a("<li/>",g).append(i).data("index",f).addClass(d[f].classes).data("optionClasses",d[f].classes||"").bind("mouseup.selectmenu",function(c){if(b._safemouseup&&!b._disabled(c.currentTarget)&&!b._disabled(a(c.currentTarget).parents("ul>li."+b.widgetBaseClass+"-group "))){var d=a(this).data("index")!=b._selectedIndex();b.index(a(this).data("index")),b.select(c),d&&b.change(c),b.close(c,!0)}return!1}).bind("click.selectmenu",function(){return!1}).bind("mouseover.selectmenu focus.selectmenu",function(c){!a(c.currentTarget).hasClass(b.namespace+"-state-disabled")&&!a(c.currentTarget).parent("ul").parent("li").hasClass(b.namespace+"-state-disabled")&&(b._selectedOptionLi().addClass(e),b._focusedOptionLi().removeClass(b.widgetBaseClass+"-item-focus ui-state-hover"),a(this).removeClass("ui-state-active").addClass(b.widgetBaseClass+"-item-focus ui-state-hover"))}).bind("mouseout.selectmenu blur.selectmenu",function(){a(this).is(b._selectedOptionLi().selector)&&a(this).addClass(e),a(this).removeClass(b.widgetBaseClass+"-item-focus ui-state-hover")});if(d[f].parentOptGroup.length){var k=b.widgetBaseClass+"-group-"+this.element.find("optgroup").index(d[f].parentOptGroup);this.list.find("li."+k).length?this.list.find("li."+k+":last ul").append(j):a(' <li role="presentation" class="'+b.widgetBaseClass+"-group "+k+(d[f].parentOptGroup.attr("disabled")?" "+this.namespace+'-state-disabled" aria-disabled="true"':'"')+'><span class="'+b.widgetBaseClass+'-group-label">'+d[f].parentOptGroup.attr("label")+"</span><ul></ul></li> ").appendTo(this.list).find("ul").append(j)}else j.appendTo(this.list);if(c.icons)for(var l in c.icons)if(j.is(c.icons[l].find)){j.data("optionClasses",d[f].classes+" "+b.widgetBaseClass+"-hasIcon").addClass(b.widgetBaseClass+"-hasIcon");var m=c.icons[l].icon||"";j.find("a:eq(0)").prepend('<span class="'+b.widgetBaseClass+"-item-icon ui-icon "+m+'"></span>'),d[f].bgImage&&j.find("span").css("background-image",d[f].bgImage)}}else a('<li role="presentation"><a href="#nogo" tabindex="-1" role="option"></a></li>').appendTo(this.list);var n=c.style=="dropdown";this.newelement.toggleClass(b.widgetBaseClass+"-dropdown",n).toggleClass(b.widgetBaseClass+"-popup",!n),this.list.toggleClass(b.widgetBaseClass+"-menu-dropdown ui-corner-bottom",n).toggleClass(b.widgetBaseClass+"-menu-popup ui-corner-all",!n).find("li:first").toggleClass("ui-corner-top",!n).end().find("li:last").addClass("ui-corner-bottom"),this.selectmenuIcon.toggleClass("ui-icon-triangle-1-s",n).toggleClass("ui-icon-triangle-2-n-s",!n);if(c.transferClasses){var o=this.element.attr("class")||"";this.newelement.add(this.list).addClass(o)}c.style=="dropdown"?this.list.width(c.menuWidth?c.menuWidth:c.width):this.list.width(c.menuWidth?c.menuWidth:c.width-c.handleWidth),this.list.css("height","auto");var p=this.listWrap.height(),q=a(window).height(),r=c.maxHeight?Math.min(c.maxHeight,q):q/3;p>r&&this.list.height(r),this._optionLis=this.list.find("li:not(."+b.widgetBaseClass+"-group)"),this.element.attr("disabled")?this.disable():this.enable(),this.index(this._selectedIndex()),this._selectedOptionLi().addClass(this.widgetBaseClass+"-item-focus"),clearTimeout(this.refreshTimeout),this.refreshTimeout=window.setTimeout(function(){b._refreshPosition()},200)},destroy:function(){this.element.removeData(this.widgetName).removeClass(this.widgetBaseClass+"-disabled"+" "+this.namespace+"-state-disabled").removeAttr("aria-disabled").unbind(".selectmenu"),a(window).unbind(".selectmenu-"+this.ids[0]),a(document).unbind(".selectmenu-"+this.ids[0]),this.newelementWrap.remove(),this.listWrap.remove(),this.element.unbind(".selectmenu").show(),a.Widget.prototype.destroy.apply(this,arguments)},_typeAhead:function(a,b){var c=this,d=String.fromCharCode(a).toLowerCase(),e=null,f=null;c._typeAhead_timer&&(window.clearTimeout(c._typeAhead_timer),c._typeAhead_timer=undefined),c._typeAhead_chars=(c._typeAhead_chars===undefined?"":c._typeAhead_chars).concat(d),c._typeAhead_chars.length<2||c._typeAhead_chars.substr(-2,1)===d&&c._typeAhead_cycling?(c._typeAhead_cycling=!0,e=d):(c._typeAhead_cycling=!1,e=c._typeAhead_chars);var g=(b!=="focus"?this._selectedOptionLi().data("index"):this._focusedOptionLi().data("index"))||0;for(var h=0;h<this._optionLis.length;h++){var i=this._optionLis.eq(h).text().substr(0,e.length).toLowerCase();if(i===e)if(c._typeAhead_cycling){f===null&&(f=h);if(h>g){f=h;break}}else f=h}f!==null&&this._optionLis.eq(f).find("a").trigger(b),c._typeAhead_timer=window.setTimeout(function(){c._typeAhead_timer=undefined,c._typeAhead_chars=undefined,c._typeAhead_cycling=undefined},c.options.typeAhead)},_uiHash:function(){var b=this.index();return{index:b,option:a("option",this.element).get(b),value:this.element[0].value}},open:function(a){var b=this,c=this.options;if(b.newelement.attr("aria-disabled")!="true"){b._closeOthers(a),b.newelement.addClass("ui-state-active"),b.listWrap.appendTo(c.appendTo),b.list.attr("aria-hidden",!1),b.listWrap.addClass(b.widgetBaseClass+"-open");var d=this._selectedOptionLi();c.style=="dropdown"?b.newelement.removeClass("ui-corner-all").addClass("ui-corner-top"):this.list.css("left",-5e3).scrollTop(this.list.scrollTop()+d.position().top-this.list.outerHeight()/2+d.outerHeight()/2).css("left","auto"),b._refreshPosition();var e=d.find("a");e.length&&e[0].focus(),b.isOpen=!0,b._trigger("open",a,b._uiHash())}},close:function(a,b){this.newelement.is(".ui-state-active")&&(this.newelement.removeClass("ui-state-active"),this.listWrap.removeClass(this.widgetBaseClass+"-open"),this.list.attr("aria-hidden",!0),this.options.style=="dropdown"&&this.newelement.removeClass("ui-corner-top").addClass("ui-corner-all"),b&&this.newelement.focus(),this.isOpen=!1,this._trigger("close",a,this._uiHash()))},change:function(a){this.element.trigger("change"),this._trigger("change",a,this._uiHash())},select:function(a){if(this._disabled(a.currentTarget))return!1;this._trigger("select",a,this._uiHash())},widget:function(){return this.listWrap.add(this.newelementWrap)},_closeOthers:function(b){a("."+this.widgetBaseClass+".ui-state-active").not(this.newelement).each(function(){a(this).data("selectelement").selectmenu("close",b)}),a("."+this.widgetBaseClass+".ui-state-hover").trigger("mouseout")},_toggle:function(a,b){this.isOpen?this.close(a,b):this.open(a)},_formatText:function(b){return this.options.format?b=this.options.format(b):this.options.escapeHtml&&(b=a("<div />").text(b).html()),b},_selectedIndex:function(){return this.element[0].selectedIndex},_selectedOptionLi:function(){return this._optionLis.eq(this._selectedIndex())},_focusedOptionLi:function(){return this.list.find("."+this.widgetBaseClass+"-item-focus")},_moveSelection:function(a,b){if(!this.options.disabled){var c=parseInt(this._selectedOptionLi().data("index")||0,10),d=c+a;d<0&&(d=0),d>this._optionLis.size()-1&&(d=this._optionLis.size()-1);if(d===b)return!1;this._optionLis.eq(d).hasClass(this.namespace+"-state-disabled")?(a>0?++a:--a,this._moveSelection(a,d)):this._optionLis.eq(d).trigger("mouseover").trigger("mouseup")}},_moveFocus:function(a,b){if(!isNaN(a))var c=parseInt(this._focusedOptionLi().data("index")||0,10),d=c+a;else var d=parseInt(this._optionLis.filter(a).data("index"),10);d<0&&(d=0),d>this._optionLis.size()-1&&(d=this._optionLis.size()-1);if(d===b)return!1;var e=this.widgetBaseClass+"-item-"+Math.round(Math.random()*1e3);this._focusedOptionLi().find("a:eq(0)").attr("id",""),this._optionLis.eq(d).hasClass(this.namespace+"-state-disabled")?(a>0?++a:--a,this._moveFocus(a,d)):this._optionLis.eq(d).find("a:eq(0)").attr("id",e).focus(),this.list.attr("aria-activedescendant",e)},_scrollPage:function(a){var b=Math.floor(this.list.outerHeight()/this._optionLis.first().outerHeight());b=a=="up"?-b:b,this._moveFocus(b)},_setOption:function(a,b){this.options[a]=b,a=="disabled"&&(b&&this.close(),this.element.add(this.newelement).add(this.list)[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+this.namespace+"-state-disabled").attr("aria-disabled",b))},disable:function(a,b){typeof a=="undefined"?this._setOption("disabled",!0):b=="optgroup"?this._disableOptgroup(a):this._disableOption(a)},enable:function(a,b){typeof a=="undefined"?this._setOption("disabled",!1):b=="optgroup"?this._enableOptgroup(a):this._enableOption(a)},_disabled:function(b){return a(b).hasClass(this.namespace+"-state-disabled")},_disableOption:function(a){var b=this._optionLis.eq(a);b&&(b.addClass(this.namespace+"-state-disabled").find("a").attr("aria-disabled",!0),this.element.find("option").eq(a).attr("disabled","disabled"))},_enableOption:function(a){var b=this._optionLis.eq(a);b&&(b.removeClass(this.namespace+"-state-disabled").find("a").attr("aria-disabled",!1),this.element.find("option").eq(a).removeAttr("disabled"))},_disableOptgroup:function(a){var b=this.list.find("li."+this.widgetBaseClass+"-group-"+a);b&&(b.addClass(this.namespace+"-state-disabled").attr("aria-disabled",!0),this.element.find("optgroup").eq(a).attr("disabled","disabled"))},_enableOptgroup:function(a){var b=this.list.find("li."+this.widgetBaseClass+"-group-"+a);b&&(b.removeClass(this.namespace+"-state-disabled").attr("aria-disabled",!1),this.element.find("optgroup").eq(a).removeAttr("disabled"))},index:function(b){if(!arguments.length)return this._selectedIndex();if(!this._disabled(a(this._optionLis[b])))this.element[0].selectedIndex=b,this._refreshValue();else return!1},value:function(a){if(arguments.length)this.element[0].value=a,this._refreshValue();else return this.element[0].value},_refreshValue:function(){var a=this.options.style=="popup"?" ui-state-active":"",b=this.widgetBaseClass+"-item-"+Math.round(Math.random()*1e3);this.list.find("."+this.widgetBaseClass+"-item-selected").removeClass(this.widgetBaseClass+"-item-selected"+a).find("a").attr("aria-selected","false").attr("id",""),this._selectedOptionLi().addClass(this.widgetBaseClass+"-item-selected"+a).find("a").attr("aria-selected","true").attr("id",b);var c=this.newelement.data("optionClasses")?this.newelement.data("optionClasses"):"",d=this._selectedOptionLi().data("optionClasses")?this._selectedOptionLi().data("optionClasses"):"";this.newelement.removeClass(c).data("optionClasses",d).addClass(d).find("."+this.widgetBaseClass+"-status").html(this._selectedOptionLi().find("a:eq(0)").html()),this.list.attr("aria-activedescendant",b)},_refreshPosition:function(){var a=this.options;if(a.style=="popup"&&!a.positionOptions.offset)var b=this._selectedOptionLi(),c="0 "+(this.list.offset().top-b.offset().top-(this.newelement.outerHeight()+b.outerHeight())/2);this.listWrap.zIndex(this.element.zIndex()+1).position({of:a.positionOptions.of||this.newelement,my:a.positionOptions.my,at:a.positionOptions.at,offset:a.positionOptions.offset||c,collision:a.positionOptions.collision||a.style=="popup"?"fit":"flip"})}})}),define("translations/discussions.entry",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/discussions.entry_content",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/discussions.deleted_entry",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("vendor/jquery.ui.core-1.9",["jquery","jqueryui/core"],function(a,b){function c(b,c){var e=b.nodeName.toLowerCase();if("area"===e){var f=b.parentNode,g=f.name,h;return!b.href||!g||f.nodeName.toLowerCase()!=="map"?!1:(h=a("img[usemap=#"+g+"]")[0],!!h&&d(h))}return(/input|select|textarea|button|object/.test(e)?!b.disabled:"a"==e?b.href||c:c)&&d(b)}function d(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}a.ui=a.ui||{};if(a.ui.version)return;a.extend(a.ui,{version:"@VERSION",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({_focus:a.fn.focus,focus:function(b,c){return typeof b=="number"?this.each(function(){var d=this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;return a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length){var d=a(this[0]),e,f;while(d.length&&d[0]!==document){e=d.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){f=parseInt(d.css("zIndex"),10);if(!isNaN(f)&&f!==0)return f}d=d.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0,d&&(c-=parseFloat(a.curCSS(b,"border"+this+"Width",!0))||0),e&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)}),c}var f=d==="Width"?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return typeof b!="number"?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),a.support.minHeight=c.offsetHeight===100,a.support.selectstart="onselectstart"in c,b.removeChild(c).style.display="none"}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e=a.ui[b].prototype;for(var f in d)e.plugins[f]=e.plugins[f]||[],e.plugins[f].push([c,d[f]])},call:function(a,b,c){var d=a.plugins[b];if(!d||!a.element[0].parentNode)return;for(var e=0;e<d.length;e++)a.options[d[e][0]]&&d[e][1].apply(a.element,c)}},contains:a.contains,hasScroll:function(b,c){if(a(b).css("overflow")==="hidden")return!1;var d=c&&c==="left"?"scrollLeft":"scrollTop",e=!1;return b[d]>0?!0:(b[d]=1,e=b[d]>0,b[d]=0,e)},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&a.ui.isOverAxis(c,e,g)}})}),define("vendor/jquery.ui.widget-1.9",["jquery","jqueryui/widget"],function(a,b){var c=Array.prototype.slice,d=a.cleanData;a.cleanData=function(b){for(var c=0,e;(e=b[c])!=null;c++)a(e).triggerHandler("remove");d(b)},a.widget=function(b,d,e){var f=b.split(".")[0],g;b=b.split(".")[1],g=f+"-"+b,e||(e=d,d=a.Widget),a.expr[":"][g]=function(c){return!!a.data(c,b)},a[f]=a[f]||{},a[f][b]=a.extend(function(c,d){if(!this._createWidget)return new a[f][b](c,d);arguments.length&&this._createWidget(c,d)},a[f][b],{version:e.version});var h=new d;h.options=a.widget.extend({},h.options),a.each(e,function(b,f){a.isFunction(f)&&(e[b]=function(){var a=function(a){return d.prototype[a].apply(this,c.call(arguments,1))},b=function(a,b){return d.prototype[a].apply(this,b)};return function(){var c=this._super,d=this._superApply,e;return this._super=a,this._superApply=b,e=f.apply(this,arguments),this._super=c,this._superApply=d,e}}())}),a[f][b].prototype=a.widget.extend(h,{namespace:f,widgetName:b,widgetEventPrefix:b,widgetBaseClass:g},e),a.widget.bridge(b,a[f][b])},a.widget.extend=function(d){var e=c.call(arguments,1),f=0,g=e.length,h,i;for(;f<g;f++)for(h in e[f])i=e[f][h],e[f].hasOwnProperty(h)&&i!==b&&(d[h]=a.isPlainObject(i)?a.widget.extend({},d[h],i):i);return d},a.widget.bridge=function(d,e){a.fn[d]=function(f){var g=typeof f=="string",h=c.call(arguments,1),i=this;return f=!g&&h.length?a.widget.extend.apply(null,[f].concat(h)):f,g?this.each(function(){var c=a.data(this,d);if(!c)return console.log("WARNING, this will break with new jqueryui: cannot call methods on "+d+" prior to initialization; "+"attempted to call method '"+f+"'");if(!a.isFunction(c[f])||f.charAt(0)==="_")return a.error("no such method '"+f+"' for "+d+" widget instance");var e=c[f].apply(c,h);if(e!==c&&e!==b)return i=e&&e.jquery?i.pushStack(e.get()):e,!1}):this.each(function(){var b=a.data(this,d);b?b.option(f||{})._init():e(f,this)}),i}},a.Widget=function(b,c){if(!this._createWidget)return new a[namespace][name](b,c);arguments.length&&this._createWidget(b,c)},a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,c){c=a(c||this.defaultElement||this)[0],this.element=a(c),this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),c!==this&&(a.data(c,this.widgetName,this),this._bind({remove:"destroy"})),this._create(),this._trigger("create"),this._init()},_getCreateOptions:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled"),this.bindings.unbind("."+this.widgetName),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e=c,f,g,h;if(arguments.length===0)return a.widget.extend({},this.options);if(typeof c=="string"){e={},f=c.split("."),c=f.shift();if(f.length){g=e[c]=a.widget.extend({},this.options[c]);for(h=0;h<f.length-1;h++)g[f[h]]=g[f[h]]||{},g=g[f[h]];c=f.pop();if(d===b)return g[c]===b?null:g[c];g[c]=d}else{if(d===b)return this.options[c]===b?null:this.options[c];e[c]=d}}return this._setOptions(e),this},_setOptions:function(b){var c=this;return a.each(b,function(a,b){c._setOption(a,b)}),this},_setOption:function(a,b){return this.options[a]=b,a==="disabled"&&(this.widget().toggleClass(this.widgetBaseClass+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_bind:function(b,c){c?(b=a(b),this.bindings=this.bindings.add(b)):(c=b,b=this.element);var d=this;a.each(c,function(c,e){b.bind(c+"."+d.widgetName,function(){if(d.options.disabled===!0||a(this).hasClass("ui-state-disabled"))return;return(typeof e=="string"?d[e]:e).apply(d,arguments)})})},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._bind(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._bind(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e=this.options[b],f;c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),d=d||{};if(c.originalEvent)for(var g=a.event.props.length,h;g;)h=a.event.props[--g],c[h]=c.originalEvent[h];return this.element.trigger(c,d),f=a.isArray(d)?[c].concat(d):[c,d],!(a.isFunction(e)&&e.apply(this.element[0],f)===!1||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){typeof e=="string"&&(e={effect:e});var g,h=e?e===!0||typeof e=="number"?c:e.effect||c:b;e=e||{},typeof e=="number"&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&(a.effects.effect[h]||a.uiBackCompat!==!1&&a.effects[h])?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}}),a.uiBackCompat!==!1&&(a.Widget.prototype._getCreateOptions=function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]})}),define("vendor/jquery.ui.menu-1.9",["jquery","jqueryui/autocomplete","vendor/jquery.ui.core-1.9","vendor/jquery.ui.widget-1.9"],function(a){var b=0;a.widget("ui.menu",{version:"@VERSION",defaultElement:"<ul>",delay:150,options:{position:{my:"left top",at:"right top"}},_create:function(){var c=this;this.activeMenu=this.element,this.menuId=this.element.attr("id")||"ui-menu-"+b++,this.element.find(".ui-icon").length&&this.element.addClass("ui-menu-icons"),this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({id:this.menuId,role:"menu"}).bind("click.menu",function(b){var d=a(b.target).closest(".ui-menu-item:has(a)");if(c.options.disabled)return!1;if(!d.length)return;(!c.active||c.active[0]!==d[0])&&c.focus(b,d),c.select(b)}).bind("mouseover.menu",function(b){if(c.options.disabled)return;var d=a(b.target).closest(".ui-menu-item");d.length&&(d.siblings().children(".ui-state-active").removeClass("ui-state-active"),c.focus(b,d))}).bind("mouseout.menu",function(b){if(c.options.disabled)return;var d=a(b.target).closest(".ui-menu-item");d.length&&c.blur(b)}).bind("focus.menu",function(b){if(c.options.disabled)return;c.focus(b,a(b.target).children(".ui-menu-item:first"))}).bind("blur.menu",function(a){if(c.options.disabled)return;c.collapseAll(a)}),this.refresh(),this.element.attr("tabIndex",0).bind("keydown.menu",function(b){if(c.options.disabled)return;switch(b.keyCode){case a.ui.keyCode.PAGE_UP:c.previousPage(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.PAGE_DOWN:c.nextPage(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.HOME:c._move("first","first",b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.END:c._move("last","last",b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.UP:c.previous(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.DOWN:c.next(b),b.preventDefault(),b.stopImmediatePropagation();break;case a.ui.keyCode.LEFT:c.collapse(b)&&b.stopImmediatePropagation(),b.preventDefault();break;case a.ui.keyCode.RIGHT:c.expand(b)&&b.stopImmediatePropagation(),b.preventDefault();break;case a.ui.keyCode.ENTER:c.active.children("a[aria-haspopup='true']").length?c.expand(b)&&b.stopImmediatePropagation():(c.select(b),b.stopImmediatePropagation()),b.preventDefault();break;case a.ui.keyCode.ESCAPE:c.collapse(b)&&b.stopImmediatePropagation(),b.preventDefault();break;default:b.stopPropagation(),clearTimeout(c.filterTimer);var d,e=c.previousFilter||"",f=String.fromCharCode(b.keyCode),g=!1;f==e?g=!0:f=e+f;function h(a){return a.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}d=c.activeMenu.children(".ui-menu-item").filter(function(){return(new RegExp("^"+h(f),"i")).test(a(this).children("a").text())}),d=g&&d.index(c.active.next())!=-1?c.active.nextAll(".ui-menu-item"):d,d.length||(f=String.fromCharCode(b.keyCode),d=c.activeMenu.children(".ui-menu-item").filter(function(){return(new RegExp("^"+h(f),"i")).test(a(this).children("a").text())})),d.length?(c.focus(b,d),d.length>1?(c.previousFilter=f,c.filterTimer=setTimeout(function(){delete c.previousFilter},1e3)):delete c.previousFilter):delete c.previousFilter}}),this._bind(document,{click:function(b){a(b.target).closest(".ui-menu").length||this.collapseAll(b)}})},_destroy:function(){this.element.removeAttr("aria-activedescendant").find("ul").andSelf().removeClass("ui-menu ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("tabIndex").removeAttr("aria-labelledby").removeAttr("aria-expanded").removeAttr("aria-hidden").show(),this.element.find(".ui-menu-item").unbind(".menu").removeClass("ui-menu-item").removeAttr("role").children("a").removeClass("ui-corner-all ui-state-hover").removeAttr("tabIndex").removeAttr("role").removeAttr("aria-haspopup").removeAttr("id").children(".ui-icon").remove()},refresh:function(){var b=this,c=this.element.find("ul:not(.ui-menu)").addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr("role","menu").hide().attr("aria-hidden","true").attr("aria-expanded","false"),d=c.add(this.element).children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role","presentation");d.children("a").addClass("ui-corner-all").attr("tabIndex",-1).attr("role","menuitem").attr("id",function(a){return b.element.attr("id")+"-"+a}),c.each(function(){var b=a(this),c=b.prev("a");c.attr("aria-haspopup","true").prepend('<span class="ui-menu-icon ui-icon ui-icon-carat-1-e"></span>'),b.attr("aria-labelledby",c.attr("id"))})},focus:function(b,c){var d,e=this;this.blur(b);if(this._hasScroll()){var f=parseFloat(a.curCSS(this.activeMenu[0],"borderTopWidth",!0))||0,g=parseFloat(a.curCSS(this.activeMenu[0],"paddingTop",!0))||0,h=c.offset().top-this.activeMenu.offset().top-f-g,i=this.activeMenu.scrollTop(),j=this.activeMenu.height(),k=c.height();h<0?this.activeMenu.scrollTop(i+h):h+k>j&&this.activeMenu.scrollTop(i+h-j+k)}this.active=c.first().children("a").addClass("ui-state-focus").end(),e.element.attr("aria-activedescendant",e.active.children("a").attr("id")),this.active.parent().closest(".ui-menu-item").children("a:first").addClass("ui-state-active"),e.timer=setTimeout(function(){e._close()},e.delay),d=a(">ul",c),d.length&&/^mouse/.test(b.type)&&e._startOpening(d),this.activeMenu=c.parent(),this._trigger("focus",b,{item:c})},blur:function(a){if(!this.active)return;clearTimeout(this.timer),this.active.children("a").removeClass("ui-state-focus"),this.active=null,this._trigger("blur",a,{item:this.active})},_startOpening:function(a){clearTimeout(this.timer);if(a.attr("aria-hidden")!=="true")return;var b=this;b.timer=setTimeout(function(){b._close(),b._open(a)},b.delay)},_open:function(b){clearTimeout(this.timer),this.element.find(".ui-menu").not(b.parents()).hide().attr("aria-hidden","true");var c=a.extend({},{of:this.active},a.type(this.options.position)=="function"?this.options.position(this.active):this.options.position);b.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(c)},collapseAll:function(a){this.element.find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active"),this.blur(a),this.activeMenu=this.element},_close:function(){this.active.parent().find("ul").hide().attr("aria-hidden","true").attr("aria-expanded","false").end().find("a.ui-state-active").removeClass("ui-state-active")},collapse:function(a){var b=this.active&&this.active.parents("li:not(.ui-menubar-item)").first();if(b&&b.length)return this.active.parent().attr("aria-hidden","true").attr("aria-expanded","false").hide(),this.focus(a,b),!0},expand:function(a){var b=this,c=this.active&&this.active.children("ul").children("li").first();if(c&&c.length)return this._open(c.parent()),setTimeout(function(){b.focus(a,c)},20),!0},next:function(a){this._move("next","first",a)},previous:function(a){this._move("prev","last",a)},first:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},last:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_move:function(a,b,c){if(!this.active){this.focus(c,this.activeMenu.children(".ui-menu-item")[b]());return}var d;a==="first"||a==="last"?d=this.active[a==="first"?"prevAll":"nextAll"](".ui-menu-item").eq(-1):d=this.active[a+"All"](".ui-menu-item").eq(0),d.length?this.focus(c,d):this.focus(c,this.activeMenu.children(".ui-menu-item")[b]())},nextPage:function(b){if(this._hasScroll()){if(!this.active){this.focus(b,this.activeMenu.children(".ui-menu-item").first());return}if(this.last())return;var c=this.active.offset().top,d=this.element.height(),e;this.active.nextAll(".ui-menu-item").each(function(){return e=a(this),a(this).offset().top-c-d<0}),this.focus(b,e)}else this.focus(b,this.activeMenu.children(".ui-menu-item")[this.active?"last":"first"]())},previousPage:function(b){if(this._hasScroll()){if(!this.active){this.focus(b,this.activeMenu.children(".ui-menu-item").first());return}if(this.first())return;var c=this.active.offset().top,d=this.element.height(),e;this.active.prevAll(".ui-menu-item").each(function(){return e=a(this),a(this).offset().top-c+d>0}),this.focus(b,e)}else this.focus(b,this.activeMenu.children(".ui-menu-item").first())},_hasScroll:function(){return this.element.height()<this.element.prop("scrollHeight")},select:function(a){var b={item:this.active};this.collapseAll(a),this._trigger("select",a,b)}})}),define("jquery.ui.menu.inputmenu",["jquery","vendor/jquery.ui.menu-1.9"],function(a,b){var c=a.ui.menu.prototype,d=c.refresh;a.extend(c,{refresh:function(){d.call(this);var b=this,c=this.element.find("li.ui-menu-item"),e=!1;this.element.bind("click.menu",function(a){(new RegExp(/^a$/i)).test(a.target.tagName)||a.preventDefault()});var f=0;this.element.find("input[type='checkbox'], input[type='radio']").each(function(){var b=a(this).closest("label");b.length&&(a(this).insertBefore(b),a(this).attr("id")||a(this).attr("id","ui-input-"+f++),b.attr("for",a(this).attr("id")))}),c.children("a").each(function(b,c){var d=a(c),f=d.parent();d.children().is("input[type='checkbox'], input[type='radio']")&&(d.closest("ul").addClass("ui-menu-icons"),d.children("input[type='checkbox']").is(":checked")?(d.prepend('<span class="ui-icon ui-icon-check"></span>'),f.attr({role:"menuitemcheckbox","aria-checked":"true"})):d.children("input[type='radio']").is(":checked")?(d.prepend('<span class="ui-icon ui-icon-radio-on"></span>'),f.attr({role:"menuitemradio","aria-checked":"true"})):d.children("input[type='radio']").length?(d.prepend('<span class="ui-icon ui-icon-radio-off"></span>'),f.attr({role:"menuitemradio","aria-checked":"false"})):f.attr({role:"menuitemcheckbox","aria-checked":"false"}),d.children().is("input[type='radio']")&&f.attr("radio-group",d.children("input[type='radio']").attr("name")),f.prev().length&&!f.prev().children("a").length?(f.prev().addClass("ui-state-disabled").html("<span class='ui-menu-input-group'>"+f.prev().text()+"</span>").bind("click.menu",!1).after('<li class="ui-menu-item"><hr /></li>'),e=!0):f.prev().length&&!f.prev().children("a").children().is("input[type='checkbox'], input[type='radio']")&&f.before("<li><hr /></li>"),e&&f.next().length&&!f.next().children("a").children().is("input[type='checkbox'], input[type='radio']")?(f.after("<li><hr /></li>"),e=!1):f.next().length&&!f.next().children("a").children().is("input[type='checkbox'], input[type='radio']")&&f.after("<li><hr /></li>"),d.children("input[type='checkbox'], input[type='radio']").hide())}),c.bind("keydown.menu",function(c){c.keyCode===a.ui.keyCode.SPACE&&(b.active.children("a").children().is("input[type='checkbox'], input[type='radio']")&&(b.select(c),c.stopImmediatePropagation()),c.preventDefault())})},select:function(b){var c={item:this.active};this.active.children("a").children().is("input[type='checkbox']")&&(this.active.attr("aria-checked")==="false"?(this.active.children("a").prepend('<span class="ui-icon ui-icon-check"></span>'),this.active.attr("aria-checked","true"),this.active.children("a").children("input[type='checkbox']").prop("checked","checked").trigger("change")):this.active.attr("aria-checked")==="true"&&(this.active.children("a").children("span.ui-icon-check").remove(),this.active.attr("aria-checked","false"),this.active.children("a").children("input[type='checkbox']").removeAttr("checked").trigger("change"))),this.active.children("a").children().is("input[type='radio']")&&this.active.attr("aria-checked")==="false"&&(this.active.children("a").children("span.ui-icon-radio-off").toggleClass("ui-icon-radio-on ui-icon-radio-off"),this.active.attr("aria-checked","true"),this.active.children("a").children("input[type='radio']").prop("checked","checked").trigger("change"),this.active.siblings("[radio-group="+a(this.active).attr("radio-group")+"]").each(function(){a(this).attr("aria-checked","false"),a(this).children("a").children("span.ui-icon-radio-on").toggleClass("ui-icon-radio-on ui-icon-radio-off"),a(this).children("a").children("input[type='radio']").removeAttr("checked")})),this.active.children("a").children().is("input[type='checkbox'], input[type='radio']")||this.collapseAll(),this._trigger("select",b,c)}})}),define("vendor/jquery.ui.position-1.9",["jquery"],function(a,b){a.ui=a.ui||{};var c=/left|center|right/,d=/top|center|bottom/,e=/[+-]\d+%?/,f=/^\w+/,g=/%$/,h="center",i=a.fn.position;a.position={scrollbarWidth:function(){var b,c,d=a("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),e=d.children()[0];return a("body").append(d),b=e.offsetWidth,d.css("overflow","scroll"),c=e.offsetWidth,b===c&&(c=d[0].clientWidth),d.remove(),b-c},getScrollInfo:function(b){var c=b[0],d=b.height()<c.scrollHeight,e=b.width()<c.scrollWidth,f=a.position.scrollbarWidth();return{height:d?f:0,width:e?f:0}}},a.fn.position=function(b){if(!b||!b.of)return i.apply(this,arguments);b=a.extend({},b);var j=a(b.of),k=a(b.within||window),l=j[0],m=(b.collision||"flip").split(" "),n={},o,p,q,r;return l.nodeType===9?(p=j.width(),q=j.height(),r={top:0,left:0}):a.isWindow(l)?(p=j.width(),q=j.height(),r={top:j.scrollTop(),left:j.scrollLeft()}):l.preventDefault?(b.at="left top",p=q=0,r={top:b.of.pageY,left:b.of.pageX}):(p=j.outerWidth(),q=j.outerHeight(),r=j.offset()),a.each(["my","at"],function(){var a=(b[this]||"").split(" "),g,i;a.length===1&&(a=c.test(a[0])?a.concat([h]):d.test(a[0])?[h].concat(a):[h,h]),a[0]=c.test(a[0])?a[0]:h,a[1]=d.test(a[1])?a[1]:h,g=e.exec(a[0]),i=e.exec(a[1]),n[this]=[g?g[0]:0,i?i[0]:0],b[this]=[f.exec(a[0])[0],f.exec(a[1])[0]]}),m.length===1&&(m[1]=m[0]),b.at[0]==="right"?r.left+=p:b.at[0]===h&&(r.left+=p/2),b.at[1]==="bottom"?r.top+=q:b.at[1]===h&&(r.top+=q/2),o=[parseInt(n.at[0],10)*(g.test(n.at[0])?p/100:1),parseInt(n.at[1],10)*(g.test(n.at[1])?q/100:1)],r.left+=o[0],r.top+=o[1],this.each(function(){var c=a(this),d=c.outerWidth(),e=c.outerHeight(),f=parseInt(a.curCSS(this,"marginLeft",!0))||0,i=parseInt(a.curCSS(this,"marginTop",!0))||0,j=a.position.getScrollInfo(k),l=d+f+(parseInt(a.curCSS(this,"marginRight",!0))||0)+j.width,s=e+i+(parseInt(a.curCSS(this,"marginBottom",!0))||0)+j.height,t=a.extend({},r),u=[parseInt(n.my[0],10)*(g.test(n.my[0])?c.outerWidth()/100:1),parseInt(n.my[1],10)*(g.test(n.my[1])?c.outerHeight()/100:1)],v;b.my[0]==="right"?t.left-=d:b.my[0]===h&&(t.left-=d/2),b.my[1]==="bottom"?t.top-=e:b.my[1]===h&&(t.top-=e/2),t.left+=u[0],t.top+=u[1],t.left=Math.round(t.left),t.top=Math.round(t.top),v={left:t.left-f,top:t.top-i},a.each(["left","top"],function(f,g){a.ui.position[m[f]]&&a.ui.position[m[f]][g](t,{targetWidth:p,targetHeight:q,elemWidth:d,elemHeight:e,collisionPosition:v,collisionWidth:l,collisionHeight:s,offset:[o[0]+u[0],o[1]+u[1]],my:b.my,at:b.at,within:k,elem:c})}),a.fn.bgiframe&&c.bgiframe(),c.offset(a.extend(t,{using:b.using}))})},a.ui.position={fit:{left:function(b,c){var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?e.scrollLeft():d.offset().left,h=f?e.width():d.outerWidth(),i=g-c.collisionPosition.left,j=c.collisionPosition.left+c.collisionWidth-h-g;c.collisionWidth>h||i>0?b.left+=i:j>0?b.left-=j:b.left=Math.max(b.left-c.collisionPosition.left,b.left)},top:function(b,c){var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?e.scrollTop():d.offset().top,h=f?e.height():d.outerHeight(),i=g-c.collisionPosition.top,j=c.collisionPosition.top+c.collisionHeight-h-g;c.collisionHeight>h||i>0?b.top+=i:j>0?b.top-=j:b.top=Math.max(b.top-c.collisionPosition.top,b.top)}},flip:{left:function(b,c){if(c.at[0]===h)return;c.elem.removeClass("ui-flipped-left ui-flipped-right");var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?0:d.offset().left,i=f?d.width():d.outerWidth(),j=c.collisionPosition.left-g,k=c.collisionPosition.left+c.collisionWidth-i-g,l=c.my[0]==="left",m=c.my[0]==="left"?-c.elemWidth:c.my[0]==="right"?c.elemWidth:0,n=c.at[0]==="left"?c.targetWidth:-c.targetWidth,o=-2*c.offset[0];if(j<0||k>0)c.elem.addClass("ui-flipped-"+(j<0?"right":"left")),b.left+=m+n+o},top:function(b,c){if(c.at[1]===h)return;c.elem.removeClass("ui-flipped-top ui-flipped-bottom");var d=c.within,e=a(window),f=a.isWindow(c.within[0]),g=f?0:d.offset().top,i=f?d.height():d.outerHeight(),j=c.collisionPosition.top-g,k=c.collisionPosition.top+c.collisionHeight-i-g,l=c.my[1]==="top",m=l?-c.elemHeight:c.my[1]==="bottom"?c.elemHeight:0,n=c.at[1]==="top"?c.targetHeight:-c.targetHeight,o=-2*c.offset[1];if(j<0||k>0)c.elem.addClass("ui-flipped-"+(j<0?"bottom":"top")),b.top+=m+n+o}}},a.uiBackCompat!==!1&&function(a){var c=a.fn.position;a.fn.position=function(d){if(!d||!d.offset)return c.call(this,d);var e=d.offset.split(" "),f=d.at.split(" ");return e.length===1&&(e[1]=e[0]),/^\d/.test(e[0])&&(e[0]="+"+e[0]),/^\d/.test(e[1])&&(e[1]="+"+e[1]),f.length===1&&(/left|center|right/.test(f[0])?f[1]="center":(f[1]=f[0],f[0]="center")),c.call(this,a.extend(d,{at:f[0]+e[0]+" "+f[1]+e[1],offset:b}))}}(a)}),define("vendor/jquery.ui.popup-1.9",["jquery","vendor/jquery.ui.core-1.9","vendor/jquery.ui.widget-1.9","vendor/jquery.ui.position-1.9"],function(a,b,c,d){var e=0;a.widget("ui.popup",{version:"@VERSION",options:{position:{my:"left top",at:"left bottom"}},_create:function(){this.options.trigger||(this.options.trigger=this.element.prev()),this.element.attr("id")||(this.element.attr("id","ui-popup-"+e++),this.generatedId=!0),this.element.attr("role")||(this.element.attr("role","dialog"),this.generatedRole=!0),this.options.trigger.attr("aria-haspopup","true").attr("aria-owns",this.element.attr("id")),this.element.addClass("ui-popup"),this.close(),this._bind(this.options.trigger,{keydown:function(b){this.options.trigger.is("a:ui-button")&&b.keyCode==a.ui.keyCode.SPACE&&b.preventDefault(),b.keyCode==a.ui.keyCode.SPACE&&this.options.trigger.is("a:not(:ui-button)")&&this.options.trigger.trigger("click",b),b.keyCode==a.ui.keyCode.DOWN&&(b.preventDefault(),this.options.trigger.trigger("click",b))},click:function(a){a.preventDefault();if(this.isOpen)return;var b=this;clearTimeout(this.closeTimer),setTimeout(function(){b.open(a)},1)}}),this.element.is(":ui-menu")||this._bind({keydown:function(b){if(b.keyCode!==a.ui.keyCode.TAB)return;var c=a(":tabbable",this.element),d=c.first(),e=c.last();b.target===e[0]&&!b.shiftKey?(d.focus(1),b.preventDefault()):b.target===d[0]&&b.shiftKey&&(e.focus(1),b.preventDefault())}}),this._bind({focusout:function(a){var b=this;b.closeTimer=setTimeout(function(){b.close(a)},100)},focusin:function(a){clearTimeout(this.closeTimer)}}),this._bind({keyup:function(b){b.keyCode==a.ui.keyCode.ESCAPE&&this.element.is(":visible")&&(this.close(b),this.options.trigger.focus())}}),this._bind(document,{click:function(b){this.isOpen&&!a(b.target).closest(".ui-popup").length&&this.close(b)}})},_destroy:function(){this.element.show().removeClass("ui-popup").removeAttr("aria-hidden").removeAttr("aria-expanded").unbind("keypress.ui-popup"),this.options.trigger.removeAttr("aria-haspopup").removeAttr("aria-owns"),this.generatedId&&this.element.removeAttr("id"),this.generatedRole&&this.element.removeAttr("role")},open:function(b){var c=a.extend({},{of:this.options.trigger},this.options.position);this.element.show().attr("aria-hidden","false").attr("aria-expanded","true").position(c);if(this.element.is(":ui-menu"))this.element.menu("focus",b,this.element.children("li").first()),this.element.focus();else{var d=this.element.find(":tabbable");this.removeTabIndex=!1,d.length||(this.element.is(":tabbable")||(this.element.attr("tabindex","0"),this.removeTabIndex=!0),d=d.add(this.element[0])),d.first().focus(1)}this.options.trigger.attr("tabindex",-1),this.isOpen=!0,this._trigger("open",b)},close:function(a){this.element.hide().attr("aria-hidden","true").attr("aria-expanded","false"),this.options.trigger.attr("tabindex",0),this.removeTabIndex&&this.element.removeAttr("tabindex"),this.isOpen=!1,this._trigger("close",a)}})}),define("vendor/jquery.ui.button-1.9",["jquery","jqueryui/button","vendor/jquery.ui.core-1.9","vendor/jquery.ui.widget-1.9"],function(a,b){var c,d,e,f,g="ui-button ui-widget ui-state-default ui-corner-all",h="ui-state-hover ui-state-active ",i="ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only",j=function(){var b=a(this).find(":ui-button");setTimeout(function(){b.button("refresh")},1)},k=function(b){var c=b.name,d=b.form,e=a([]);return c&&(d?e=a(d).find("[name='"+c+"']"):e=a("[name='"+c+"']",b.ownerDocument).filter(function(){return!this.form})),e};a.widget("ui.button",{version:"@VERSION",defaultElement:"<button>",options:{disabled:null,text:!0,label:null,icons:{primary:null,secondary:null}},_create:function(){this.element.closest("form").unbind("reset.button").bind("reset.button",j),typeof this.options.disabled!="boolean"&&(this.options.disabled=this.element.prop("disabled")),this._determineButtonType(),this.hasTitle=!!this.buttonElement.attr("title");var b=this,h=this.options,i=this.type==="checkbox"||this.type==="radio",l="ui-state-hover"+(i?"":" ui-state-active"),m="ui-state-focus";h.label===null&&(h.label=this.buttonElement.html()),this.element.is(":disabled")&&(h.disabled=!0),this.buttonElement.addClass(g).attr("role","button").bind("mouseenter.button",function(){if(h.disabled)return;a(this).addClass("ui-state-hover"),this===c&&a(this).addClass("ui-state-active")}).bind("mouseleave.button",function(){if(h.disabled)return;a(this).removeClass(l)}).bind("click.button",function(a){h.disabled&&(a.preventDefault(),a.stopImmediatePropagation())}),this.element.bind("focus.button",function(){b.buttonElement.addClass(m)}).bind("blur.button",function(){b.buttonElement.removeClass(m)}),i&&(this.element.bind("change.button",function(){if(f)return;b.refresh()}),this.buttonElement.bind("mousedown.button",function(a){if(h.disabled)return;f=!1,d=a.pageX,e=a.pageY}).bind("mouseup.button",function(a){if(h.disabled)return;if(d!==a.pageX||e!==a.pageY)f=!0})),this.type==="checkbox"?this.buttonElement.bind("click.button",function(){if(h.disabled||f)return!1;a(this).toggleClass("ui-state-active"),b.buttonElement.attr("aria-pressed",b.element[0].checked)}):this.type==="radio"?this.buttonElement.bind("click.button",function(){if(h.disabled||f)return!1;a(this).addClass("ui-state-active"),b.buttonElement.attr("aria-pressed","true");var c=b.element[0];k(c).not(c).map(function(){return a(this).button("widget")[0]}).removeClass("ui-state-active").attr("aria-pressed","false")}):(this.buttonElement.bind("mousedown.button",function(){if(h.disabled)return!1;a(this).addClass("ui-state-active"),c=this,a(document).one("mouseup",function(){c=null})}).bind("mouseup.button",function(){if(h.disabled)return!1;a(this).removeClass("ui-state-active")}).bind("keydown.button",function(b){if(h.disabled)return!1;(b.keyCode==a.ui.keyCode.SPACE||b.keyCode==a.ui.keyCode.ENTER)&&a(this).addClass("ui-state-active")}).bind("keyup.button",function(){a(this).removeClass("ui-state-active")}),this.buttonElement.is("a")&&this.buttonElement.keyup(function(b){b.keyCode===a.ui.keyCode.SPACE&&a(this).click()})),this._setOption("disabled",h.disabled),this._resetButton()},_determineButtonType:function(){this.element.is(":checkbox")?this.type="checkbox":this.element.is(":radio")?this.type="radio":this.element.is("input")?this.type="input":this.type="button";if(this.type==="checkbox"||this.type==="radio"){var a=this.element.parents().last(),b="label[for="+this.element.attr("id")+"]";this.buttonElement=a.find(b),this.buttonElement.length||(a=a.length?a.siblings():this.element.siblings(),this.buttonElement=a.filter(b),this.buttonElement.length||(this.buttonElement=a.find(b))),this.element.addClass("ui-helper-hidden-accessible");var c=this.element.is(":checked");c&&this.buttonElement.addClass("ui-state-active"),this.buttonElement.prop("aria-pressed",c)}else this.buttonElement=this.element},widget:function(){return this.buttonElement},_destroy:function(){this.element.removeClass("ui-helper-hidden-accessible"),this.buttonElement.removeClass(g+" "+h+" "+i).removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()),this.hasTitle||this.buttonElement.removeAttr("title")},_setOption:function(a,b){this._super("_setOption",a,b);if(a==="disabled"){b?this.element.prop("disabled",!0):this.element.prop("disabled",!1);return}this._resetButton()},refresh:function(){var b=this.element.is(":disabled");b!==this.options.disabled&&this._setOption("disabled",b),this.type==="radio"?k(this.element[0]).each(function(){a(this).is(":checked")?a(this).button("widget").addClass("ui-state-active").attr("aria-pressed","true"):a(this).button("widget").removeClass("ui-state-active").attr("aria-pressed","false")}):this.type==="checkbox"&&(this.element.is(":checked")?this.buttonElement.addClass("ui-state-active").attr("aria-pressed","true"):this.buttonElement.removeClass("ui-state-active").attr("aria-pressed","false"))},_resetButton:function(){if(this.type==="input"){this.options.label&&this.element.val(this.options.label);return}var b=this.buttonElement.removeClass(i),c=a("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(b.empty()).text(),d=this.options.icons,e=d.primary&&d.secondary,f=[];d.primary||d.secondary?(this.options.text&&f.push("ui-button-text-icon"+(e?"s":d.primary?"-primary":"-secondary")),d.primary&&b.prepend("<span class='ui-button-icon-primary ui-icon "+d.primary+"'></span>"),d.secondary&&b.append("<span class='ui-button-icon-secondary ui-icon "+d.secondary+"'></span>"),this.options.text||(f.push(e?"ui-button-icons-only":"ui-button-icon-only"),this.hasTitle||b.attr("title",c))):f.push("ui-button-text-only"),b.addClass(f.join(" "))}}),a.ui.button.version="@VERSION",a.widget("ui.buttonset",{options:{items:":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create:function(){this.element.addClass("ui-buttonset")},_init:function(){this.refresh()},_setOption:function(a,b){a==="disabled"&&this.buttons.button("option",a,b),this._super("_setOption",a,b)},refresh:function(){var b=this.element.css("direction")==="ltr";this.buttons=this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(b?"ui-corner-left":"ui-corner-right").end().filter(":last").addClass(b?"ui-corner-right":"ui-corner-left").end().end()},_destroy:function(){this.element.removeClass("ui-buttonset"),this.buttons.map(function(){return a(this).button("widget")[0]}).removeClass("ui-corner-left ui-corner-right").end().button("destroy")}})}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/jquery.kylemenu",["jquery","jquery.ui.menu.inputmenu","vendor/jquery.ui.popup-1.9","vendor/jquery.ui.button-1.9"],function(b,c,d,e){var f;return f=function(){function c(d,e){this.keepButtonActive=a(this.keepButtonActive,this),this.onClose=a(this.onClose,this),this.close=a(this.close,this),this.onOpen=a(this.onOpen,this);var f,g,h,i=this;this.$trigger=b(d).data("kyleMenu",this),this.opts=b.extend(!0,{},c.defaults,e),this.opts.noButton||(this.$trigger.button(this.opts.buttonOpts),this.$trigger.bind("mouseleave.button",this.keepButtonActive)),this.$menu=this.$trigger.next().menu(this.opts.menuOpts).popup(this.opts.popupOpts).addClass("ui-kyle-menu use-css-transitions-for-show-hide"),this.opts.appendMenuTo&&(f=this.$menu.data("popup"),h=f.open,g=this,f.open=function(){return g.$menu.appendTo(g.opts.appendMenuTo),h.apply(this,arguments)},this.$placeholder=b('<span style="display:none;">').insertAfter(this.$menu),this.$menu.bind("click",function(){var a;return(a=i.$placeholder).trigger.apply(a,arguments)})),this.$menu.bind({menuselect:this.close,popupopen:this.onOpen,popupclose:this.onClose})}return c.name="KyleMenu",c.prototype.onOpen=function(a){return this.adjustCarat(a),this.$menu.addClass("ui-state-open")},c.prototype.open=function(){return this.$menu.popup("open")},c.prototype.close=function(){return this.$menu.popup("close").removeClass("ui-state-open")},c.prototype.onClose=function(){return this.opts.appendMenuTo&&this.$menu.insertBefore(this.$placeholder),this.$trigger.removeClass("ui-state-active"),this.$menu.removeClass("ui-state-open")},c.prototype.keepButtonActive=function(){if(this.$menu.is(".ui-state-open"))return this.$trigger.addClass("ui-state-active")},c.prototype.adjustCarat=function(a){var c,d,e,f,g;return(g=this.$carat)!=null&&g.remove(),this.$trigger.addClass("ui-state-active"),f=this.$trigger.outerWidth(),e=this.$trigger.offset().left-this.$menu.offset().left,c=a.pageX-this.$trigger.offset().left,d=Math.min(Math.max(6,c),f-6)+e,this.$carat=b('<span class="ui-menu-carat"><span /></span>').css("left",d).prependTo(this.$menu),this.$menu.css("-webkit-transform-origin-x",d+"px")},c.defaults={popupOpts:{position:{my:"center top",at:"center bottom",offset:"0 10px",within:"#main",collision:"fit"}},buttonOpts:{icons:{primary:"ui-icon-home",secondary:"ui-icon-droparrow"}}},c}(),b.fn.kyleMenu=function(a){return this.each(function(){if(!b(this).data().kyleMenu)return new f(this,a)})},b(document).delegate(".al-trigger","click",function(a){var c,d,e;c=b(this),d={buttonOpts:{icons:{primary:null,secondary:null}}};if(!c.data("kyleMenu"))return a.preventDefault(),e=b.extend(d,c.data("kyleMenuOptions")),(new f(c,e)).open()}),f})}.call(this),define("translations/discussions.reply_form",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/discussions.reply",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/discussions.reply_attachment",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/rubrics",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),function(){define("compiled/widget/assignmentRubricDialog",["i18n!rubrics","jquery","jqueryui/dialog","vendor/jquery.ba-tinypubsub"],function(a,b){var c;return c={initTriggers:function(){var a;if(a=b(".rubric_dialog_trigger"))return this.noRubricExists=a.data("noRubricExists"),this.url=a.data("url"),a.click(function(a){return a.preventDefault(),c.openDialog()})},initDialog:function(){return this.dialogInited=!0,this.$dialog=b("<div><h4>"+a.t("loading","Loading...")+"</h4></div>").dialog({title:a.t("titles.assignment_rubric_details","Assignment Rubric Details"),width:600,modal:!1,resizable:!0,autoOpen:!1}),b.get(this.url,function(a){c.$dialog.html(b(a).show());if(c.noRubricExists)return b.subscribe("edit_rubric/initted",function(){return c.$dialog.find(".button.add_rubric_link").click()})})},openDialog:function(){return this.dialogInited||this.initDialog(),this.$dialog.dialog("open")}}})}.call(this),define("translations/discussions.participant",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),function(){var a={}.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};define("compiled/discussions/Participant",["Backbone","i18n!discussions.participant"],function(a,c){var d;return d=function(a){function d(){return d.__super__.constructor.apply(this,arguments)}return b(d,a),d.name="Participant",d.prototype.defaults={avatar_image_url:"",display_name:c.t("anonymous_user","Anonymous"),id:null},d}(a.Model)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};define("compiled/discussions/ParticipantCollection",["Backbone","compiled/discussions/Participant"],function(a,c){var d;return d=function(a){function d(){return d.__super__.constructor.apply(this,arguments)}return b(d,a),d.name="ParticipantCollection",d.prototype.model=c,d}(a.Collection)})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/util/BackoffPoller",["jquery","jquery.ajaxJSON"],function(b){var c;return c=function(){function c(b,c,d){var e,f,g,h,i;this.url=b,this.handler=c,d==null&&(d={}),this.handle=a(this.handle,this),this.poll=a(this.poll,this),this.baseInterval=(e=d.baseInterval)!=null?e:1e3,this.backoffFactor=(f=d.backoffFactor)!=null?f:1.5,this.maxAttempts=(g=d.maxAttempts)!=null?g:8,this.handleErrors=(h=d.handleErrors)!=null?h:!1,this.initialDelay=(i=d.initialDelay)!=null?i:!0}return c.name="BackoffPoller",c.prototype.start=function(){return this.running?this.reset():this.nextPoll(!0),this},c.prototype.then=function(a){return this.callbacks==null&&(this.callbacks=[]),this.callbacks.push(a)},c.prototype.reset=function(){return this.nextInterval=this.baseInterval,this.attempts=0},c.prototype.stop=function(a){var b,c,d,e;a==null&&(a=!1),this.running&&clearTimeout(this.running),delete this.running;if(a&&this.callbacks){e=this.callbacks;for(c=0,d=e.length;c<d;c++)b=e[c],b()}return delete this.callbacks},c.prototype.poll=function(){var a=this;return this.running=!0,this.attempts++,b.ajaxJSON(this.url,"GET",{},this.handle,function(b,c){return a.handleErrors?a.handle(b,c):a.stop()})},c.prototype.handle=function(a,b){switch(this.handler(a,b)){case"continue":return this.nextPoll();case"reset":return this.nextPoll(!0);case"stop":return this.stop(!0);default:return this.stop()}},c.prototype.nextPoll=function(a){a==null&&(a=!1);if(a){this.reset();if(!this.initialDelay)return this.poll()}else this.nextInterval=parseInt(this.nextInterval*this.backoffFactor);return this.attempts<this.maxAttempts?this.running=setTimeout(this.poll,this.nextInterval):this.stop()},c}()})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};define("compiled/discussions/Topic",["Backbone","compiled/util/BackoffPoller"],function(a,c){var d;return d=function(a){function d(){return d.__super__.constructor.apply(this,arguments)}return b(d,a),d.name="Topic",d.prototype.defaults={participants:[],unread_entries:[],view:null,new_entries:[]},d.prototype.url=ENV.DISCUSSION.ROOT_URL+"?include_new_entries=1",d.prototype.fetch=function(a){var b,d=this;return a==null&&(a={}),b=new c(this.url,function(b,c){return c.status===503?"continue":c.status!==200?"abort":(d.set(d.parse(b,200,c)),typeof a.success=="function"&&a.success(d,b),"stop")},{handleErrors:!0,initialDelay:!1,baseInterval:2e3,maxAttempts:12,backoffFactor:1.6}),b.start()},d.prototype.initialize=function(){return d.__super__.initialize.apply(this,arguments),this.cid="discussion_topic"},d}(a.Model)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};define("compiled/discussions/Entry",["compiled/discussions/app","jquery","underscore","Backbone","compiled/discussions/findParticipant","jquery.ajaxJSON"],function(a,c,d,e,f){var g;return g=function(a){function g(){return g.__super__.constructor.apply(this,arguments)}return b(g,a),g.name="Entry",g.prototype.defaults={id:null,parent_id:null,message:null,user_id:null,read_state:"read",created_at:null,updated_at:null,deleted:!1,attachment:null,replies:[],parent_cid:null,collapsedView:!1,canAttach:ENV.DISCUSSION.PERMISSIONS.CAN_ATTACH,focused:!1},g.prototype.computedAttributes=["author","editor","canModerate","allowsSideComments","hideRepliesOnCollapse","speedgraderUrl",{name:"canReply",deps:["parent_id"]},{name:"summary",deps:["message"]}],g.prototype.read=function(){return""+ENV.DISCUSSION.ENTRY_ROOT_URL+"?ids[]="+this.get("id")},g.prototype.create=function(){var a;return a=this.get("parent_id"),a===null?ENV.DISCUSSION.ROOT_REPLY_URL:ENV.DISCUSSION.REPLY_URL.replace(/:entry_id/,a)},g.prototype["delete"]=function(){return ENV.DISCUSSION.DELETE_URL.replace(/:id/,this.get("id"))},g.prototype.update=function(){return ENV.DISCUSSION.DELETE_URL.replace(/:id/,this.get("id"))},g.prototype.sync=function(a,b,c){return c==null&&(c={}),c.url=this[a](),e.sync(a,this,c)},g.prototype.parse=function(a){return d.isArray(a)?a[0]:a},g.prototype.author=function(){return this.get("deleted")?{}:f(this.get("user_id"))},g.prototype.canModerate=function(){var a;return a=this.get("user_id")===ENV.DISCUSSION.CURRENT_USER.id,a||ENV.DISCUSSION.PERMISSIONS.MODERATE},g.prototype.canReply=function(){return ENV.DISCUSSION.PERMISSIONS.CAN_REPLY?ENV.DISCUSSION.THREADED?!0:!1:!1},g.prototype.editor=function(){var a;if(a=this.get("editor_id"))return f(a)},g.prototype.speedgraderUrl=function(){if(ENV.DISCUSSION.SPEEDGRADER_URL_TEMPLATE)return ENV.DISCUSSION.SPEEDGRADER_URL_TEMPLATE.replace(/%22%3Astudent_id%22/,this.get("user_id"))},g.prototype.summary=function(){return this.escapeDiv||(this.escapeDiv=c("<div/>")),this.escapeDiv.html(this.get("message")).text()},g.prototype.allowsSideComments=function(){var a;return a=this.get("deleted"),!ENV.DISCUSSION.THREADED&&ENV.DISCUSSION.PERMISSIONS.CAN_REPLY&&this.get("parent_id")===null&&!a},g.prototype.hideRepliesOnCollapse=function(){return!ENV.DISCUSSION.THREADED&&this.get("parent_id")===null},g.prototype.markAsRead=function(){var a;return this.set("read_state","read"),a=ENV.DISCUSSION.MARK_READ_URL.replace(/:id/,this.get("id")),c.ajaxJSON(a,"PUT")},g}(e.Model)})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};define("compiled/discussions/EntryCollection",["Backbone","compiled/discussions/Entry"],function(a,c){var d;return d=function(a){function d(){return d.__super__.constructor.apply(this,arguments)}return b(d,a),d.name="EntryCollection",d.prototype.model=c,d}(a.Collection)})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/discussions/MarkAsReadWatcher",["Backbone","i18n!discussions","underscore","jquery","jquery.ajaxJSON"],function(b,c,d,e){var f,g,h;return g=2e3,f=100,h=function(){function h(b){var c=this;this.view=b,this.markAsRead=a(this.markAsRead,this),h.unread.push(this),this.view.model.bind("change:collapsedView",function(a,b){c.ignore=b;if(b)return c.clearTimer()})}var b,c=this;return h.name="MarkAsReadWatcher",h.unread=[],h.prototype.createTimer=function(){return this.timer||(this.timer=setTimeout(this.markAsRead,g))},h.prototype.clearTimer=function(){return clearTimeout(this.timer),delete this.timer},h.prototype.markAsRead=function(){return this.view.model.markAsRead(),h.unread=d(h.unread).without(this),h.trigger("markAsRead",this.view.model)},b=e(window),h.init=function(){return b.bind("scroll resize",this.checkForVisibleEntries),this.checkForVisibleEntries()},h.checkForVisibleEntries=d.throttle(function(){var a,c,d,e,f,g,i,j;f=b.scrollTop(),a=f+b.height(),j=h.unread;for(g=0,i=j.length;g<i;g++){c=j[g];if(c.ignore)continue;e=c.view.$el.offset().top,d=e<a&&e+c.view.$el.height()>f,c[d?"createTimer":"clearTimer"]()}},f),h}.call(this),d.extend(h,b.Events)})}.call(this),function(){define("compiled/editor/EditorToggle",["i18n!editor","jquery","tinymce.editor_box"],function(a,b){var c;return c=function(){function c(a,c){this.el=a,this.options=b.extend({},this.options,c),this.textArea=this.createTextArea(),this.done=this.createDone(),this.content=this.getContent(),this.editing=!1}return c.name="EditorToggle",c.prototype.options={doneText:a.t("done_as_in_finished","Done")},c.prototype.toggle=function(){return this.editing?this.display():this.edit()},c.prototype.edit=function(){return this.textArea.val(this.getContent()),this.textArea.insertBefore(this.el),this.el.detach(),this.done.insertAfter(this.textArea),this.textArea.editorBox(),this.editing=!0},c.prototype.display=function(){return this.content=this.textArea._justGetCode(),this.textArea.val(this.content),this.el.html(this.content),this.el.insertBefore(this.textArea),this.textArea._removeEditor(),this.textArea.detach(),this.done.detach(),this.textArea.attr("id",""),this.editing=!1},c.prototype.getContent=function(){return b.trim(this.el.html())},c.prototype.createTextArea=function(){return b("<textarea/>").css("width","100%").addClass("editor-toggle")},c.prototype.createDone=function(){var a=this;return b("<a/>").html(this.options.doneText).addClass("button edit-html-done edit_html_done").click(function(){return a.display()})},c}()})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define("compiled/discussions/EntryEditor",["i18n!editor","jquery","compiled/editor/EditorToggle"],function(b,d,e){var f;return f=function(e){function f(b){this.view=b,this.onSaveError=a(this.onSaveError,this),this.onSaveSuccess=a(this.onSaveSuccess,this),f.__super__.constructor.call(this,this.view.$(".message:first")),this.cancelButton=this.createCancelButton(),this.done.addClass("small-button")}return c(f,e),f.name="EntryEditor",f.prototype.display=function(a){f.__super__.display.apply(this,arguments),this.cancelButton.detach();if((a!=null?a.cancel:void 0)!==!0)return this.view.model.save({messageNotification:b.t("saving","Saving..."),message:this.content},{success:this.onSaveSuccess,error:this.onSaveError})},f.prototype.createCancelButton=function(){var a=this;return d("<a/>").html(b.t("cancel","Cancel")).attr("href","javascript:").addClass("cancel_button").click(function(){return a.display({cancel:!0})})},f.prototype.edit=function(){return f.__super__.edit.apply(this,arguments),this.cancelButton.insertAfter(this.done)},f.prototype.getContent=function(){return this.view.model.get("message")},f.prototype.onSaveSuccess=function(){return this.view.model.set("messageNotification","")},f.prototype.onSaveError=function(){return this.view.model.set({messageNotification:b.t("save_failed","Failed to save, please try again later")}),this.edit()},f}(e)})}.call(this),define("jst/discussions/EntryCollectionView",["compiled/handlebars_helpers","i18n!discussions.entry_collection_view"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["discussions/EntryCollectionView"]=b(function(a,b,c,d,e){function n(a,b){var d="",e,f,g,h;d+='\n  <span class="add_root_reply">&#8593; <a href="*">',e="Add Reply to Topic",f="add_reply_to_topic",g={},h="discussions.EntryCollectionView",g.scope=h,h=c.t||a.t,i={},i.hash=g,typeof h===k?e=h.call(a,f,e,i):h===m?e=l.call(a,"t",f,e,i):e=h;if(e||e===0)d+=e;return d+="</a></span>\n",d}c=c||a.helpers;var f="",g,h,i,j=this,k="function",l=c.helperMissing,m=void 0;f+='<ul class="discussion-entries"></ul>\n\n',g=c.showReplyButton||b.showReplyButton,h=c["if"],i=j.program(1,n,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;return f+="\n\n",f}),c["discussions/EntryCollectionView"]}),define("jst/discussions/_entry_content",["compiled/handlebars_helpers","i18n!discussions.entry_content"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["discussions/_entry_content"]=b(function(a,b,c,d,e){function q(a,b){var d;return d=c.parent_cid||a.parent_cid,typeof d===m?d=d.call(a,{hash:{}}):d===o&&(d=n.call(a,"parent_cid",{hash:{}})),p(d)}function r(a,b){return"content"}function s(a,b){var d="",e,f,g,h;d+='\n          <li><a data-event="edit" href="#"><span class="ui-icon ui-icon-pencil" />',e="Edit",f="edit",g={},h="discussions.entry_content",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;d+='</a></li>\n          <li><a data-event="remove" href="#"><span class="ui-icon ui-icon-trash" />',e="Delete",f="delete",g={},h="discussions.entry_content",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;return d+="</a></li>\n        ",d}function t(a,b){var d="",e,f,g,h;d+='\n          <li><a href="',e=c.speedgraderUrl||a.speedgraderUrl,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"speedgraderUrl",{hash:{}})),d+=p(e)+'"><span class="ui-icon ui-icon-check" />',e="Open in SpeedGrader",f="open_in_speedgrader",g={},h="discussions.entry_content",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;return d+="</a></li>\n        ",d}function u(a,b){return"unknown"}function v(a,b){var d,e;return d=c.author||a.author,d=d===null||d===undefined||d===!1?d:d.url,e=c["if"],k=l.program(12,w,b),k.hash={},k.fn=k,k.inverse=l.noop,d=e.call(a,d,k),d||d===0?d:""}function w(a,b){var d="",e;return d+=' href="',e=c.author||a.author,e=e===null||e===undefined||e===!1?e:e.url,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"author.url",{hash:{}})),d+=p(e)+'" ',d}function x(a,b){var d;return d=c.author||a.author,d=d===null||d===undefined||d===!1?d:d.display_name,typeof d===m?d=d.call(a,{hash:{}}):d===o&&(d=n.call(a,"author.display_name",{hash:{}})),p(d)}function y(a,b){var d,e,f,g;return d="Unknown Author",e="unknown_author",f={},g="discussions.entry_content",f.scope=g,g=c.t||a.t,k={},k.hash=f,typeof g===m?d=g.call(a,e,d,k):g===o?d=n.call(a,"t",e,d,k):d=g,d||d===0?d:""}function z(a,b){var d="",e,f;d+='\n    <div class="discussion-fyi">This comment was edited by <a ',e=c.editor||a.editor,e=e===null||e===undefined||e===!1?e:e.url,f=c["if"],k=l.program(19,A,b),k.hash={},k.fn=k,k.inverse=l.noop,e=f.call(a,e,k);if(e||e===0)d+=e;return d+=">",e=c.editor||a.editor,e=e===null||e===undefined||e===!1?e:e.display_name,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"editor.display_name",{hash:{}})),d+=p(e)+"</a></div>\n  ",d}function A(a,b){var d="",e;return d+=' href="',e=c.editor||a.editor,e=e===null||e===undefined||e===!1?e:e.url,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"editor.url",{hash:{}})),d+=p(e)+'" ',d}function B(a,b){var d="",e,f;d+='\n    <div class="comment_attachments">\n      ',e=c.attachments||a.attachments,f=c.each,k=l.program(22,C,b),k.hash={},k.fn=k,k.inverse=l.noop,e=f.call(a,e,k);if(e||e===0)d+=e;return d+="\n    </div>\n  ",d}function C(a,b){var d="",e,f;return d+='\n        <div><a href="',e=c.url||a.url,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"url",{hash:{}})),d+=p(e)+'" class="',e=c["content-type"]||a["content-type"],f=c.mimeClass||a.mimeClass,typeof f===m?e=f.call(a,e,{hash:{}}):f===o?e=n.call(a,"mimeClass",e,{hash:{}}):e=f,d+=p(e)+'" title="',e=c.filename||a.filename,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"filename",{hash:{}})),d+=p(e)+'">',e=c.display_name||a.display_name,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"display_name",{hash:{}})),d+=p(e)+"</a></div>\n      ",d}function D(a,b){var e="",f;e+="\n  ",f=a,f=l.invokePartial(d["discussions/reply_form"],"discussions/reply_form",f,c,d);if(f||f===0)e+=f;return e+="\n",e}c=c||a.helpers,d=d||a.partials;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0,p=this.escapeExpression;f+='<header class="discussion-section admin-link-hover-area ',g=c.read_state||b.read_state,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"read_state",{hash:{}})),f+=p(g)+' clearfix" data-event="toggleCollapsed">\n  <div class="discussion-read-state tooltip">\n    <span class="tooltip_wrap unread">\n      <span class="tooltip_text">',g="Unread",h="unread",i={},j="discussions.entry_content",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</span>\n    </span>\n    <span class="tooltip_wrap just_read">\n      <span class="tooltip_text">',g="Just Read",h="just_read",i={},j="discussions.entry_content",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+="</span>\n    </span>\n  </div>\n  ",g=c.author||b.author,g=l.invokePartial(d.avatar,"avatar",g,c,d);if(g||g===0)f+=g;f+='\n  <div class="discussion-header-content right-of-avatar">\n    <div class="hide-if-collapsed admin-links">\n      <button class="al-trigger" data-event="openMenu"><span class="al-trigger-inner">',g="Manage",h="manage",i={},j="discussions.entry_content",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</span></button>\n      <ul class="al-options">\n        <li><a href="#',g=c.parent_cid||b.parent_cid,h=c["if"],k=l.program(1,q,e),k.hash={},k.fn=k,k.inverse=l.program(3,r,e),g=h.call(b,g,k);if(g||g===0)f+=g;f+='"><span class="ui-icon ui-icon-arrowreturnthick-1-w" />',g="Go To Parent",h="go_to_parent",i={},j="discussions.entry_content",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+="</a></li>\n        ",g=c.canModerate||b.canModerate,h=c["if"],k=l.program(5,s,e),k.hash={},k.fn=k,k.inverse=l.noop,g=h.call(b,g,k);if(g||g===0)f+=g;f+="\n        ",g=c.speedgraderUrl||b.speedgraderUrl,h=c["if"],k=l.program(7,t,e),k.hash={},k.fn=k,k.inverse=l.noop,g=h.call(b,g,k);if(g||g===0)f+=g;f+='\n      </ul>\n    </div>\n    <div class="discussion-header-right">\n      <div class="discussion-pubdate">',g=c.updated_at||b.updated_at,h={},i=!0,h.pubdate=i,i=c.friendlyDatetime||b.friendlyDatetime,k={},k.hash=h,typeof i===m?g=i.call(b,g,k):i===o?g=n.call(b,"friendlyDatetime",g,k):g=i,f+=p(g)+'</div>\n    </div>\n    <h2 class="discussion-title">\n      <a class="author ',g=c.author||b.author,g=g===null||g===undefined||g===!1?g:g.id,h=c.unless,k=l.program(9,u,e),k.hash={},k.fn=k,k.inverse=l.noop,g=h.call(b,g,k);if(g||g===0)f+=g;f+='" title="',g="Author's name",h="authors_name",i={},j="discussions.entry_content",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='" ',g=c.author||b.author,h=c["if"],k=l.program(11,v,e),k.hash={},k.fn=k,k.inverse=l.noop,g=h.call(b,g,k);if(g||g===0)f+=g;f+=' class="author">',g=c.author||b.author,h=c["if"],k=l.program(14,x,e),k.hash={},k.fn=k,k.inverse=l.program(16,y,e),g=h.call(b,g,k);if(g||g===0)f+=g;f+='</a>\n    </h2>\n    <h1 class="show-if-collapsed discussion-subtitle summary ellipsis">',g=c.summary||b.summary,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"summary",{hash:{}})),f+=p(g)+'</h1>\n  </div>\n</header>\n<div class="discussion-section hide-if-collapsed message_wrapper">\n  <span class="message-notification" data-bind="messageNotification"></span>\n  <div data-bind="message" class="message user_content">',g=c.message||b.message,h=c.convertNativeToMediaCommentThumnail||b.convertNativeToMediaCommentThumnail,typeof h===m?g=h.call(b,g,{hash:{}}):h===o?g=n.call(b,"convertNativeToMediaCommentThumnail",g,{hash:{}}):g=h,f+=p(g)+"</div>\n  ",g=c.editor||b.editor,h=c["if"],k=l.program(18,z,e),k.hash={},k.fn=k,k.inverse=l.noop,g=h.call(b,g,k);if(g||g===0)f+=g;f+="\n  ",g=c.attachments||b.attachments,h=c["if"],k=l.program(21,B,e),k.hash={},k.fn=k,k.inverse=l.noop,g=h.call(b,g,k);if(g||g===0)f+=g;f+="\n</div>\n",g=c.canReply||b.canReply,h=c["if"],k=l.program(24,D,e),k.hash={},k.fn=k,k.inverse=l.noop,g=h.call(b,g,k);if(g||g===0)f+=g;return f+="\n",f}),a.registerPartial("discussions/entry_content",c["discussions/_entry_content"]),c["discussions/_entry_content"]}),define("jst/discussions/_deleted_entry",["compiled/handlebars_helpers","i18n!discussions.deleted_entry"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["discussions/_deleted_entry"]=b(function(a,b,c,d,e){function q(a,b){return"admin-link-hover-area"}c=c||a.helpers;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0,p=this.escapeExpression;f+='<header class="',g=c.hideRepliesOnCollapse||b.hideRepliesOnCollapse,h=c["if"],k=l.program(1,q,e),k.hash={},k.fn=k,k.inverse=l.noop,g=h.call(b,g,k);if(g||g===0)f+=g;f+=" discussion-section ",g=c.read_state||b.read_state,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"read_state",{hash:{}})),f+=p(g)+'" data-event="toggleCollapsed">\n  <div class="discussion-header-content right-of-avatar">\n    <h1 class="discussion-title">',g="This entry has been deleted",h="deleted",i={},j="discussions.deleted_entry",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;return f+="</h1>\n  </div>\n</header>\n\n",f}),a.registerPartial("discussions/deleted_entry",c["discussions/_deleted_entry"]),c["discussions/_deleted_entry"]}),define("jst/discussions/entry_with_replies",["compiled/handlebars_helpers"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["discussions/entry_with_replies"]=b(function(a,b,c,d,e){function o(a,b){var e="",f;e+="\n      ",f=a,f=j.invokePartial(d["discussions/deleted_entry"],"discussions/deleted_entry",f,c,d);if(f||f===0)e+=f;return e+="\n    ",e}function p(a,b){var e="",f;e+="\n      ",f=a,f=j.invokePartial(d["discussions/entry_content"],"discussions/entry_content",f,c,d);if(f||f===0)e+=f;return e+="\n    ",e}function q(a,b){var e="",f;e+='\n  <div class="add-side-comment-wrap">\n    ',f=a,f=j.invokePartial(d["discussions/reply_form"],"discussions/reply_form",f,c,d);if(f||f===0)e+=f;return e+="\n  </div>\n",e}c=c||a.helpers,d=d||a.partials;var f="",g,h,i,j=this,k="function",l=c.helperMissing,m=void 0,n=this.escapeExpression;f+='<article class="discussion_entry can_be_marked_as_read ',g=c.read_state||b.read_state,typeof g===k?g=g.call(b,{hash:{}}):g===m&&(g=l.call(b,"read_state",{hash:{}})),f+=n(g)+'" data-mark-read-url="',g=c.mark_read_url||b.mark_read_url,typeof g===k?g=g.call(b,{hash:{}}):g===m&&(g=l.call(b,"mark_read_url",{hash:{}})),f+=n(g)+'">\n  <div class="entry_content">\n    ',g=c.deleted||b.deleted,h=c["if"],i=j.program(1,o,e),i.hash={},i.fn=i,i.inverse=j.program(3,p,e),g=h.call(b,g,i);if(g||g===0)f+=g;f+='\n  </div>\n</article>\n<div class="replies"></div>\n',g=c.allowsSideComments||b.allowsSideComments,h=c["if"],i=j.program(5,q,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;return f+="\n\n\n",f}),c["discussions/entry_with_replies"]}),define("jst/_avatar",["compiled/handlebars_helpers"],function(a){var b=a.template,c=a.templates=a.templates||{};return c._avatar=b(function(a,b,c,d,e){function o(a,b){var d="",e,f;d+="\n  <a ",e=c.url||a.url,f=c["if"],i=j.program(2,p,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;d+=' class="avatar" ',e=c.display_name||a.display_name,f=c["if"],i=j.program(4,q,b),i.hash={},i.fn=i,i.inverse=j.noop,e=f.call(a,e,i);if(e||e===0)d+=e;return d+='><img src="',e=c.avatar_image_url||a.avatar_image_url,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"avatar_image_url",{hash:{}})),d+=n(e)+'" alt="',e=c.display_name||a.display_name,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"display_name",{hash:{}})),d+=n(e)+'"></a>\n',d}function p(a,b){var d="",e;return d+=' href="',e=c.url||a.url,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"url",{hash:{}})),d+=n(e)+'" ',d}function q(a,b){var d="",e;return d+=' title="',e=c.display_name||a.display_name,typeof e===k?e=e.call(a,{hash:{}}):e===m&&(e=l.call(a,"display_name",{hash:{}})),d+=n(e)+'" ',d}c=c||a.helpers;var f="",g,h,i,j=this,k="function",l=c.helperMissing,m=void 0,n=this.escapeExpression;g=c.avatar_image_url||b.avatar_image_url,h=c["if"],i=j.program(1,o,e),i.hash={},i.fn=i,i.inverse=j.noop,g=h.call(b,g,i);if(g||g===0)f+=g;return f+="\n",f}),a.registerPartial("avatar",c._avatar),c._avatar}),define("jst/discussions/_reply_form",["compiled/handlebars_helpers","i18n!discussions.reply_form"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["discussions/_reply_form"]=b(function(a,b,c,d,e){function q(a,b){var d="",e,f,g,h;d+="\n        ",e="Add a side comment...",f="add_side_comment",g={},h="discussions.reply_form",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;return d+="\n      ",d}function r(a,b){var d="",e,f,g,h;d+="\n        ",e="Write a reply...",f="write_a_reply",g={},h="discussions.reply_form",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;return d+="\n      ",d}function s(a,b){var d="",e,f,g,h;d+='\n          <a href="#" class="discussion-reply-add-attachment" data-event="addReplyAttachment">',e="Attach",f="attach_file",g={},h="discussions.reply_form",g.scope=h,h=c.t||a.t,k={},k.hash=g,typeof h===m?e=h.call(a,f,e,k):h===o?e=n.call(a,"t",f,e,k):e=h;if(e||e===0)d+=e;return d+="</a>\n        ",d}c=c||a.helpers;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0,p=this.escapeExpression;f+='<form class="discussion-section hide-if-collapsed discussion-reply-form">\n  <span class="notification" data-bind="notification"></span>\n  <a class="discussion-reply-label hide-if-replying" data-event="addReply" href="#">\n    <label for="reply_message_for_',g=c.id||b.id,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"id",{hash:{}})),f+=p(g)+'">\n      ',g=c.allowsSideComments||b.allowsSideComments,h=c["if"],k=l.program(1,q,e),k.hash={},k.fn=k,k.inverse=l.program(3,r,e),g=h.call(b,g,k);if(g||g===0)f+=g;f+='\n    </label>\n  </a>\n  <div class="show-if-replying">\n    <textarea class="reply-textarea" id="reply_message_for_',g=c.id||b.id,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"id",{hash:{}})),f+=p(g)+'"></textarea>\n\n    <div class="clearfix">\n      <div class="discussion-reply-buttons">\n        <button class="button small-button" type="submit">',g="Post Response",h="post_response",i={},j="discussions.reply_form",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</button>\n        <a href="javascript:" class="cancel_button">',g="Cancel",h="cancel",i={},j="discussions.reply_form",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</a>\n      </div>\n\n      <div class="discussion-reply-attachments-container">\n        <ul class="discussion-reply-attachments"></ul>\n        ',g=c.canAttach||b.canAttach,h=c["if"],k=l.program(5,s,e),k.hash={},k.fn=k,k.inverse=l.noop,g=h.call(b,g,k);if(g||g===0)f+=g;return f+="\n      </div>\n    </div>\n  </div>\n</form>\n",f}),a.registerPartial("discussions/reply_form",c["discussions/_reply_form"]),c["discussions/_reply_form"]}),define("jst/discussions/_reply_attachment",["compiled/handlebars_helpers","i18n!discussions.reply_attachment"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["discussions/_reply_attachment"]=b(function(a,b,c,d,e){c=c||a.helpers;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0;f+='<li>\n  <input name="attachment" type="file">\n  <a href="#" data-event="removeReplyAttachment">',g="remove",h="remove_attachment",i={},j="discussions.reply_attachment",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;return f+="</a>\n</li>\n",f}),a.registerPartial("discussions/reply_attachment",c["discussions/_reply_attachment"]),c["discussions/_reply_attachment"]}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/discussions/Reply",["Backbone","underscore","i18n!discussions.reply","jquery","compiled/discussions/Entry","str/htmlEscape","jst/discussions/_reply_attachment","compiled/fn/preventDefault","tinymce.editor_box"],function(b,c,d,e,f,g,h,i){var j;return j=function(){function b(b,c){this.view=b,this.options=c!=null?c:{},this.onPostReplyError=a(this.onPostReplyError,this),this.onPostReplySuccess=a(this.onPostReplySuccess,this),this.submit=a(this.submit,this),this.hideNotification=a(this.hideNotification,this),this.hide=a(this.hide,this),this.el=this.view.$(".discussion-reply-label:first"),this.showWhileEditing=this.el.next(),this.textarea=this.showWhileEditing.find(".reply-textarea"),this.form=this.el.closest("form").submit(i(this.submit)),this.form.find(".cancel_button").click(this.hide),this.form.delegate(".alert .close","click",i(this.hideNotification)),this.editing=!1}return b.name="Reply",b.prototype.toggle=function(){return this.editing?this.hide():this.edit()},b.prototype.edit=function(){var a=this;return this.form.addClass("replying"),this.textarea.editorBox(),this.el.hide(),setTimeout(function(){return a.textarea.editorBox("focus")}),this.editing=!0,this.trigger("edit",this)},b.prototype.hide=function(){return this.content=this.textarea._justGetCode(),this.textarea._removeEditor(),this.form.removeClass("replying"),this.textarea.val(this.content),this.el.show(),this.editing=!1,this.trigger("hide",this)},b.prototype.hideNotification=function(){return this.view.model.set("notification","")},b.prototype.submit=function(){var a;return this.hide(),this.textarea._setContentCode(""),this.view.model.set("notification","<div class='alert alert-info'>"+d.t("saving_reply","Saving reply...")+"</div>"),a=new f(this.getModelAttributes()),a.save(null,{success:this.onPostReplySuccess,error:this.onPostReplyError,multipart:a.get("attachment")}),this.hide(),this.removeAttachments(),this.el.hide()},b.prototype.getModelAttributes=function(){var a;return a=(new Date).getTime(),{summary:e("<div/>").html(this.content).text(),message:this.content,parent_cid:this.options.topLevel?null:this.view.model.cid,parent_id:this.options.topLevel?null:this.view.model.get("id"),user_id:ENV.current_user_id,created_at:a,updated_at:a,collapsedView:!1,attachment:this.form.find("input[type=file]")[0]}},b.prototype.onPostReplySuccess=function(a){var b,c;return(typeof (c=this.options).added=="function"?!c.added():!void 0)&&this.view.collection.add(a),this.view.model.get("allowsSideComments")?b="":b="<div class='alert alert-success'><a class='close' data-dismiss='alert'></a>"+d.t("reply_saved","Reply saved, *go to your reply*",{wrapper:"<a href='#"+a.cid+"' data-event='goToReply'>$1</a>"})+"</div>",this.view.model.set("notification",b),this.el.show()},b.prototype.onPostReplyError=function(a){return this.view.model.set("notification","<div class='alert alert-info'>"+d.t("error_saving_reply","*An error occured*, please post your reply again later",{wrapper:"<strong>$1</strong>"})+"</div>"),this.textarea.val(a.get("message")),this.edit()},b.prototype.addAttachment=function(a){return this.form.find("ul.discussion-reply-attachments").append(h()),this.form.find("a.discussion-reply-add-attachment").hide()},b.prototype.removeAttachment=function(a){return a.closest("ul.discussion-reply-attachments li").remove(),this.form.find("a.discussion-reply-add-attachment").show()},b.prototype.removeAttachments=function(){return this.form.find("ul.discussion-reply-attachments").empty()},b}(),c.extend(j.prototype,b.Events),j})}.call(this),function(){define("compiled/util/wikiSidebarWithMultipleEditors",["wikiSidebar","tinymce.editor_box","compiled/tinymce"],function(a){return $.subscribe("editorBox/focus",function(b){return a.inited||a.init(),a.show(),a.attachToEditor(b)}),$.subscribe("editorBox/removeAll",function(){return a.hide()})})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define("compiled/discussions/EntryView",["require","i18n!discussions.entry","Backbone","underscore","compiled/discussions/EntryCollection","jst/discussions/_entry_content","jst/discussions/_deleted_entry","jst/discussions/entry_with_replies","compiled/discussions/Reply","compiled/discussions/EntryEditor","compiled/discussions/MarkAsReadWatcher","str/htmlEscape","vendor/jquery.ba-tinypubsub","compiled/jquery.kylemenu","jst/_avatar","jst/discussions/_reply_form"],function(b,d,e,f,g,h,i,j,k,l,m,n,o,p){var q,r;return r=o.publish,q=function(b){function e(){return this.onReadState=a(this.onReadState,this),this.onCollapsedView=a(this.onCollapsedView,this),e.__super__.constructor.apply(this,arguments)}return c(e,b),e.name="EntryView",e.instances=[],e.prototype.tagName="li",e.prototype.className="entry",e.prototype.initialize=function(){var a,b=this;return e.__super__.initialize.apply(this,arguments),a=this.model.get("id"),e.instances[a]=this,this.model.bind("change:id",function(a,c){return b.$el.attr("data-id",c)}),this.model.bind("change:collapsedView",this.onCollapsedView),this.model.bind("change:read_state",this.onReadState),this.render(),this.model.bind("change:deleted",function(a,c){return b.$(".discussion_entry:first").toggleClass("deleted-discussion-entry",c)}),this.model.get("deleted")&&this.$(".discussion_entry:first").addClass("deleted-discussion-entry"),this.toggleCollapsedClass(),this.createReplies()},e.prototype.onCollapsedView=function(a,b){var c;this.toggleCollapsedClass();if(this.model.get("hideRepliesOnCollapse"))return c=this.$(".replies, .add-side-comment-wrap"),b?c.hide():c.show()},e.prototype.onReadState=function(a,b){return b==="unread"&&this.markAsReadWatcher==null&&(this.markAsReadWatcher=new m(this)),this.$("article:first").toggleClass("unread",b==="unread")},e.prototype.fetchFullEntry=function(){return this.model.set("message",d.t("loading","loading...")),this.model.fetch()},e.prototype.toggleCollapsedClass=function(){var a;return a=this.model.get("collapsedView"),this.$el.children(".discussion_entry").toggleClass("collapsed",!!a).toggleClass("expanded",!a)},e.prototype.render=function(){return this.$el.html(j(this.model.toJSON())),this.$el.attr("data-id",this.model.get("id")),this.$el.attr("id",this.model.cid),r("userContent/change"),e.__super__.render.apply(this,arguments)},e.prototype.openMenu=function(a,b){if(!this.menu)return this.createMenu(b)},e.prototype.createMenu=function(a){var b;return b={appendMenuTo:"body",buttonOpts:{icons:{primary:null,secondary:null}}},this.menu=new p(a,b),this.menu.open()},e.prototype.createReplies=function(){},e.prototype.remove=function(){var a;return this.model.set("collapsedView",!0),a=i(this.model.toJSON()),this.$(".entry_content:first").html(a),this.model.destroy()},e.prototype.edit=function(){return this.editor==null&&(this.editor=new l(this)),this.editor.edit()},e.prototype.toggleCollapsed=function(a,b){return this.model.set("collapsedView",!this.model.get("collapsedView"))},e.prototype.addReply=function(a,b){return this.reply==null&&(this.reply=new k(this)),this.model.set("notification",""),this.reply.edit()},e.prototype.addReplyAttachment=function(a,b){return this.reply.addAttachment(b)},e.prototype.removeReplyAttachment=function(a,b){return this.reply.removeAttachment(b)},e.prototype.goToReply=function(a,b){},e}(e.View),b(["compiled/discussions/EntryCollectionView"],function(a){return q.prototype.createReplies=function(){var b,c,d=this;return b=this.$el.find(".replies"),this.collection=new g,this.view=new a({$el:b,collection:this.collection}),c=this.model.get("replies"),f.each(c,function(a){return a.parent_cid=d.model.cid}),this.collection.reset(this.model.get("replies"))}}),q})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define("compiled/discussions/EntryCollectionView",["Backbone","compiled/discussions/EntryView","jst/discussions/EntryCollectionView"],function(b,d,e){var f;return f=function(b){function f(){return this.addAll=a(this.addAll,this),this.add=a(this.add,this),f.__super__.constructor.apply(this,arguments)}return c(f,b),f.name="EntryCollectionView",f.prototype.initialize=function(a){return this.$el=a.$el,this.collection=a.collection,this.collection.bind("reset",this.addAll),this.collection.bind("add",this.add),this.render()},f.prototype.render=function(){var a;return a=e(this.options),this.$el.html(a),this.cacheElements()},f.prototype.cacheElements=function(){return this.list=this.$el.children(".discussion-entries")},f.prototype.add=function(a){var b;return b=new d({model:a}),this.list.append(b.el)},f.prototype.addAll=function(){return this.collection.each(this.add)},f}(b.View)})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define("compiled/discussions/EntriesView",["underscore","jquery","Backbone","compiled/discussions/EntryCollection","compiled/discussions/EntryCollectionView","compiled/discussions/EntryView","compiled/discussions/ParticipantCollection","compiled/discussions/MarkAsReadWatcher","jst/discussions/_reply_form","vendor/ui.selectmenu"],function(b,d,e,f,g,h,i,j,k,l){var m;return m=function(e){function k(){return this.onFetchSuccess=a(this.onFetchSuccess,this),this.onMarkAsRead=a(this.onMarkAsRead,this),this.initParticipants=a(this.initParticipants,this),this.initEntries=a(this.initEntries,this),k.__super__.constructor.apply(this,arguments)}return c(k,e),k.name="EntriesView",k.prototype.events={"click .entry":"handleEntryEvent"},k.prototype.initialize=function(){return this.$el=d("#discussion_subentries"),this.participants=new i,this.model.bind("change:participants",this.initParticipants),this.collection=new f,this.model.bind("change:view",this.initEntries),j.on("markAsRead",this.onMarkAsRead),this.model.fetch({success:this.onFetchSuccess})},k.prototype.initEntries=function(a,b){return this.collectionView=new g({$el:this.$el,collection:this.collection,showReplyButton:ENV.DISCUSSION.PERMISSIONS.CAN_REPLY}),this.collection.reset(b),this.updateFromNewEntries(),this.setUnreadEntries(),j.init()},k.prototype.updateFromNewEntries=function(){var a,c=this;return a=this.model.get("new_entries"),b.each(a,function(a){var b;return b=h.instances[a.id],b?b.model.set(a):(b=h.instances[a.parent_id]||c,b.collection.add(a))})},k.prototype.setUnreadEntries=function(){var a;return a=this.model.get("unread_entries"),b.each(a,function(a){return h.instances[a].model.set("read_state","unread")})},k.prototype.initParticipants=function(a,b){return this.participants.reset(b)},k.prototype.onMarkAsRead=function(a){var c,d;return d=this.model.get("unread_entries"),c=a.get("id"),this.model.set("unread_entries",b.without(d,c))},k.prototype.onFetchSuccess=function(){return this.model.trigger("fetchSuccess",this.model)},k.prototype.handleEntryEvent=function(a){var b,c,e,f,g;b=d(a.target).closest("[data-event]");if(!b.length)return;return f=b.data("event"),g=d(a.currentTarget),c=g.data("id"),e=h.instances[c],e[f](a,b),!1},k}(e.View)})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define("compiled/discussions/TopicView",["i18n!discussions","Backbone","underscore","compiled/discussions/Topic","compiled/discussions/EntriesView","compiled/discussions/EntryView","jst/discussions/_reply_form","compiled/discussions/Reply","compiled/widget/assignmentRubricDialog","compiled/util/wikiSidebarWithMultipleEditors","jquery.instructure_misc_helpers"],function(b,d,e,f,g,h,i,j,k){var l;return l=function(d){function e(){return this.onUnreadChange=a(this.onUnreadChange,this),this.initEntries=a(this.initEntries,this),e.__super__.constructor.apply(this,arguments)}return c(e,d),e.name="TopicView",e.prototype.events={"click #discussion_topic .discussion-reply-form [data-event]":"handleEvent","change .view_switcher":"switchView","click .add_root_reply":"addRootReply"},e.prototype.initialize=function(){return this.$el=$("#main"),this.model.set("id",ENV.DISCUSSION.TOPIC.ID),this.model.cid="main",this.model.set("canAttach",ENV.DISCUSSION.PERMISSIONS.CAN_ATTACH),this.render(),ENV.DISCUSSION.INITIAL_POST_REQUIRED||this.initEntries(),this.initViewSwitcher(),$(document.body).is(".with-right-side")&&$.scrollSidebar(),k.initTriggers(),this.disableNextUnread(),this.$el.toggleClass("side_comment_discussion",!ENV.DISCUSSION.THREADED)},e.prototype.cacheElements=function(){return this.$addRootReply=this.$(".add_root_reply")},e.prototype.initEntries=function(){var a=this;return this.discussion?!1:(this.discussion=new g({model:new f}),this.collection=this.discussion.collection,this.discussion.model.bind("change:unread_entries",this.onUnreadChange),this.discussion.model.bind("fetchSuccess",function(){var b;return b=a.discussion.model.get("unread_entries"),a.setNextUnread(b),a.cacheElements()}),this.trigger("initEntries",this))},e.prototype.onUnreadChange=function(a,c){return this.model.set("unreadCount",c.length),this.model.set("unreadText",b.t("unread_count_tooltip",{zero:"No unread replies",one:"1 unread reply",other:"%{count} unread replies"},{count:c.length})),this.setNextUnread(c)},e.prototype.setNextUnread=function(a){var b,c,d;if(a.length===0){this.disableNextUnread();return}return d=this.discussion.$(".can_be_marked_as_read.unread:first"),c=d.parent(),b=c.attr("id"),this.$("#jump_to_next_unread").removeClass("disabled").attr("href","#"+b)},e.prototype.disableNextUnread=function(){return this.$("#jump_to_next_unread").addClass("disabled").removeAttr("href")},e.prototype.addReply=function(a){var b=this;return a.preventDefault(),this.reply==null&&(this.reply=new j(this,{topLevel:!0,added:this.initEntries}),this.reply.on("edit",function(){var a;return(a=b.$addRootReply)!=null?a.hide():void 0}),this.reply.on("hide",function(){var a;return(a=b.$addRootReply)!=null?a.show():void 0})),this.model.set("notification",""),this.reply.edit()},e.prototype.addReplyAttachment=h.prototype.addReplyAttachment,e.prototype.removeReplyAttachment=h.prototype.removeReplyAttachment,e.prototype.handleEvent=function(a){var b,c;return b=$(a.currentTarget),c=b.data("event"),typeof this[c]=="function"?this[c](a,b):void 0},e.prototype.render=function(){var a;return ENV.DISCUSSION.PERMISSIONS.CAN_REPLY&&(a=i(this.model.toJSON()),this.$(".entry_content:first").append(a)),e.__super__.render.apply(this,arguments)},e.prototype.initViewSwitcher=function(){return this.$(".view_switcher").show().selectmenu({icons:[{find:".collapsed-view"},{find:".unread-view"},{find:".expanded-view"}]})},e.prototype.switchView=function(a){var b,c;return b=$(a.currentTarget),c=b.val(),this[c+"View"]()},e.prototype.collapsedView=function(){var a,b,c,d;c=h.instances,d=[];for(a in c)b=c[a],d.push(b.model.set("collapsedView",!0));return d},e.prototype.expandedView=function(){var a,b,c,d;c=h.instances,d=[];for(a in c)b=c[a],d.push(b.model.set("collapsedView",!1));return d},e.prototype.unreadView=function(){var a,b,c,d,e;d=h.instances,e=[];for(b in d)c=d[b],a=c.model.get("read_state")==="read",e.push(c.model.set("collapsedView",a));return e},e.prototype.addRootReply=function(a){var b,c;return b=this.$(a.currentTarget),c=$("#discussion_topic .discussion-reply-form"),this.addReply(a),$("html, body").animate({scrollTop:c.offset().top-100})},e}(d.View)})}.call(this),function(){require(["Backbone","compiled/discussions/app","compiled/discussions/TopicView","compiled/discussions/ParticipantCollection"],function(a,b,c,d){return this.app=b,$(function(){return b.topicView=new c({model:new a.Model})})})}.call(this),define("compiled/bundles/discussion",function(){})