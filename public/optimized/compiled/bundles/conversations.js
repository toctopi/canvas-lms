define("translations/conversations",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{es:{buttons:{cancel:"Cancelar"},conversations:{notes_to_self:"Mon√≥logo"}}}})}),define("translations/conversations_intro",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/slideshow",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/conversations.conversations_pane",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),define("translations/conversations.conversations_list",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),function(){define("compiled/jquery/scrollIntoView",["jquery"],function(a){return a.fn.scrollIntoView=function(b){var c,d,e,f,g,h;b==null&&(b={}),c=this.offsetParent(),e=c.scrollTop(),d=e+c.height(),g=this[0].offsetTop,f=g+a(this[0]).outerHeight();if((h=b.ignore)!=null?h.border:void 0)g+=parseInt(a(this[0]).css("border-top-width").replace("px","")),f-=parseInt(a(this[0]).css("border-bottom-width").replace("px",""));if(g<e||b.toTop)return c.scrollTop(g);if(f>d)return c.scrollTop(f-c.height())}})}.call(this),function(){var a={};define("use",{version:"0.2.0",load:function(b,c,d,e){e||(e=require.rawConfig);var f=e.use&&e.use[b];if(!f)throw new TypeError("Module '"+b+"' is undefined or does not"+" have a `use` config. Make sure it exists, add a `use` config, or"+" don't use use! on it");a[b]={deps:f.deps||[],attach:f.attach},c(f.deps||[],function(){var a=arguments;c([b],function(){var b=f.attach;return e.isBuild?d():typeof b=="function"?d(b.apply(window,a)):d(window[b])})})},write:function(b,c,d){var e=a[c],f=e.deps,g={attach:null,deps:""};typeof e.attach=="function"?g.attach=e.attach.toString():g.attach="function() {return window['"+e.attach+"'];"+"}",f.length&&(g.deps="'"+f.toString().split(",").join("','")+"'"),d(["define('",b,"!",c,"', ","[",g.deps,"],",g.attach,");\n"].join(""))}})}(),function(){var a=this,b=a.Backbone,c=Array.prototype.slice,d=Array.prototype.splice,e;typeof exports!="undefined"?e=exports:e=a.Backbone={},e.VERSION="0.9.1";var f=a._;!f&&typeof require!="undefined"&&(f=require("underscore"));var g=a.jQuery||a.Zepto||a.ender;e.setDomLibrary=function(a){g=a},e.noConflict=function(){return a.Backbone=b,this},e.emulateHTTP=!1,e.emulateJSON=!1,e.Events={on:function(a,b,c){var d;a=a.split(/\s+/);var e=this._callbacks||(this._callbacks={});while(d=a.shift()){var f=e[d]||(e[d]={}),g=f.tail||(f.tail=f.next={});g.callback=b,g.context=c,f.tail=g.next={}}return this},off:function(a,b,c){var d,e,f;if(!a)delete this._callbacks;else if(e=this._callbacks){a=a.split(/\s+/);while(d=a.shift()){f=e[d],delete e[d];if(!b||!f)continue;while((f=f.next)&&f.next)if(f.callback!==b||!!c&&f.context!==c)this.on(d,f.callback,f.context);else continue}}return this},trigger:function(a){var b,d,e,f,g,h,i;if(!(e=this._callbacks))return this;h=e.all,(a=a.split(/\s+/)).push(null);while(b=a.shift()){h&&a.push({next:h.next,tail:h.tail,event:b});if(!(d=e[b]))continue;a.push({next:d.next,tail:d.tail})}i=c.call(arguments,1);while(d=a.pop()){f=d.tail,g=d.event?[d.event].concat(i):i;while((d=d.next)!==f)d.callback.apply(d.context||this,g)}return this}},e.Events.bind=e.Events.on,e.Events.unbind=e.Events.off,e.Model=function(a,b){var c;a||(a={}),b&&b.parse&&(a=this.parse(a));if(c=u(this,"defaults"))a=f.extend({},c,a);b&&b.collection&&(this.collection=b.collection),this.attributes={},this._escapedAttributes={},this.cid=f.uniqueId("c");if(!this.set(a,{silent:!0}))throw new Error("Can't create an invalid model");delete this._changed,this._previousAttributes=f.clone(this.attributes),this.initialize.apply(this,arguments)},f.extend(e.Model.prototype,e.Events,{idAttribute:"id",initialize:function(){},toJSON:function(){return f.clone(this.attributes)},get:function(a){return this.attributes[a]},escape:function(a){var b;if(b=this._escapedAttributes[a])return b;var c=this.attributes[a];return this._escapedAttributes[a]=f.escape(c==null?"":""+c)},has:function(a){return this.attributes[a]!=null},set:function(a,b,c){var d,g,h;f.isObject(a)||a==null?(d=a,c=b):(d={},d[a]=b),c||(c={});if(!d)return this;d instanceof e.Model&&(d=d.attributes);if(c.unset)for(g in d)d[g]=void 0;if(!this._validate(d,c))return!1;this.idAttribute in d&&(this.id=d[this.idAttribute]);var i=this.attributes,j=this._escapedAttributes,k=this._previousAttributes||{},l=this._setting;this._changed||(this._changed={}),this._setting=!0;for(g in d){h=d[g],f.isEqual(i[g],h)||delete j[g],c.unset?delete i[g]:i[g]=h,this._changing&&!f.isEqual(this._changed[g],h)&&(this.trigger("change:"+g,this,h,c),this._moreChanges=!0),delete this._changed[g];if(!f.isEqual(k[g],h)||f.has(i,g)!=f.has(k,g))this._changed[g]=h}return l||(!c.silent&&this.hasChanged()&&this.change(c),this._setting=!1),this},unset:function(a,b){return(b||(b={})).unset=!0,this.set(a,null,b)},clear:function(a){return(a||(a={})).unset=!0,this.set(f.clone(this.attributes),a)},fetch:function(a){a=a?f.clone(a):{};var b=this,c=a.success;return a.success=function(d,e,f){if(!b.set(b.parse(d,f),a))return!1;c&&c(b,d)},a.error=e.wrapError(a.error,b,a),(this.sync||e.sync).call(this,"read",this,a)},save:function(a,b,c){var d,g;f.isObject(a)||a==null?(d=a,c=b):(d={},d[a]=b),c=c?f.clone(c):{},c.wait&&(g=f.clone(this.attributes));var h=f.extend({},c,{silent:!0});if(d&&!this.set(d,c.wait?h:c))return!1;var i=this,j=c.success;c.success=function(a,b,e){var g=i.parse(a,e);c.wait&&(g=f.extend(d||{},g));if(!i.set(g,c))return!1;j?j(i,a):i.trigger("sync",i,a,c)},c.error=e.wrapError(c.error,i,c);var k=this.isNew()?"create":"update",l=(this.sync||e.sync).call(this,k,this,c);return c.wait&&this.set(g,h),l},destroy:function(a){a=a?f.clone(a):{};var b=this,c=a.success,d=function(){b.trigger("destroy",b,b.collection,a)};if(this.isNew())return d();a.success=function(e){a.wait&&d(),c?c(b,e):b.trigger("sync",b,e,a)},a.error=e.wrapError(a.error,b,a);var g=(this.sync||e.sync).call(this,"delete",this,a);return a.wait||d(),g},url:function(){var a=u(this.collection,"url")||u(this,"urlRoot")||v();return this.isNew()?a:a+(a.charAt(a.length-1)=="/"?"":"/")+encodeURIComponent(this.id)},parse:function(a,b){return a},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return this.id==null},change:function(a){if(this._changing||!this.hasChanged())return this;this._changing=!0,this._moreChanges=!0;for(var b in this._changed)this.trigger("change:"+b,this,this._changed[b],a);while(this._moreChanges)this._moreChanges=!1,this.trigger("change",this,a);return this._previousAttributes=f.clone(this.attributes),delete this._changed,this._changing=!1,this},hasChanged:function(a){return arguments.length?this._changed&&f.has(this._changed,a):!f.isEmpty(this._changed)},changedAttributes:function(a){if(!a)return this.hasChanged()?f.clone(this._changed):!1;var b,c=!1,d=this._previousAttributes;for(var e in a){if(f.isEqual(d[e],b=a[e]))continue;(c||(c={}))[e]=b}return c},previous:function(a){return!arguments.length||!this._previousAttributes?null:this._previousAttributes[a]},previousAttributes:function(){return f.clone(this._previousAttributes)},isValid:function(){return!this.validate(this.attributes)},_validate:function(a,b){if(b.silent||!this.validate)return!0;a=f.extend({},this.attributes,a);var c=this.validate(a,b);return c?(b&&b.error?b.error(this,c,b):this.trigger("error",this,c,b),!1):!0}}),e.Collection=function(a,b){b||(b={}),b.comparator&&(this.comparator=b.comparator),this._reset(),this.initialize.apply(this,arguments),a&&this.reset(a,{silent:!0,parse:b.parse})},f.extend(e.Collection.prototype,e.Events,{model:e.Model,initialize:function(){},toJSON:function(){return this.map(function(a){return a.toJSON()})},add:function(a,b){var c,e,g,h,i,j,k={},l={};b||(b={}),a=f.isArray(a)?a.slice():[a];for(c=0,g=a.length;c<g;c++){if(!(h=a[c]=this._prepareModel(a[c],b)))throw new Error("Can't add an invalid model to a collection");if(k[i=h.cid]||this._byCid[i]||(j=h.id)!=null&&(l[j]||this._byId[j]))throw new Error("Can't add the same model to a collection twice");k[i]=l[j]=h}for(c=0;c<g;c++)(h=a[c]).on("all",this._onModelEvent,this),this._byCid[h.cid]=h,h.id!=null&&(this._byId[h.id]=h);this.length+=g,e=b.at!=null?b.at:this.models.length,d.apply(this.models,[e,0].concat(a)),this.comparator&&this.sort({silent:!0});if(b.silent)return this;for(c=0,g=this.models.length;c<g;c++){if(!k[(h=this.models[c]).cid])continue;b.index=c,h.trigger("add",h,this,b)}return this},remove:function(a,b){var c,d,e,g;b||(b={}),a=f.isArray(a)?a.slice():[a];for(c=0,d=a.length;c<d;c++){g=this.getByCid(a[c])||this.get(a[c]);if(!g)continue;delete this._byId[g.id],delete this._byCid[g.cid],e=this.indexOf(g),this.models.splice(e,1),this.length--,b.silent||(b.index=e,g.trigger("remove",g,this,b)),this._removeReference(g)}return this},get:function(a){return a==null?null:this._byId[a.id!=null?a.id:a]},getByCid:function(a){return a&&this._byCid[a.cid||a]},at:function(a){return this.models[a]},sort:function(a){a||(a={});if(!this.comparator)throw new Error("Cannot sort a set without a comparator");var b=f.bind(this.comparator,this);return this.comparator.length==1?this.models=this.sortBy(b):this.models.sort(b),a.silent||this.trigger("reset",this,a),this},pluck:function(a){return f.map(this.models,function(b){return b.get(a)})},reset:function(a,b){a||(a=[]),b||(b={});for(var c=0,d=this.models.length;c<d;c++)this._removeReference(this.models[c]);return this._reset(),this.add(a,{silent:!0,parse:b.parse}),b.silent||this.trigger("reset",this,b),this},fetch:function(a){a=a?f.clone(a):{},a.parse===undefined&&(a.parse=!0);var b=this,c=a.success;return a.success=function(d,e,f){b[a.add?"add":"reset"](b.parse(d,f),a),c&&c(b,d)},a.error=e.wrapError(a.error,b,a),(this.sync||e.sync).call(this,"read",this,a)},create:function(a,b){var c=this;b=b?f.clone(b):{},a=this._prepareModel(a,b);if(!a)return!1;b.wait||c.add(a,b);var d=b.success;return b.success=function(e,f,g){b.wait&&c.add(e,b),d?d(e,f):e.trigger("sync",a,f,b)},a.save(null,b),a},parse:function(a,b){return a},chain:function(){return f(this.models).chain()},_reset:function(a){this.length=0,this.models=[],this._byId={},this._byCid={}},_prepareModel:function(a,b){if(a instanceof e.Model)a.collection||(a.collection=this);else{var c=a;b.collection=this,a=new this.model(c,b),a._validate(a.attributes,b)||(a=!1)}return a},_removeReference:function(a){this==a.collection&&delete a.collection,a.off("all",this._onModelEvent,this)},_onModelEvent:function(a,b,c,d){if(a!="add"&&a!="remove"||c==this)a=="destroy"&&this.remove(b,d),b&&a==="change:"+b.idAttribute&&(delete this._byId[b.previous(b.idAttribute)],this._byId[b.id]=b),this.trigger.apply(this,arguments);else return}});var h=["forEach","each","map","reduce","reduceRight","find","detect","filter","select","reject","every","all","some","any","include","contains","invoke","max","min","sortBy","sortedIndex","toArray","size","first","initial","rest","last","without","indexOf","shuffle","lastIndexOf","isEmpty","groupBy"];f.each(h,function(a){e.Collection.prototype[a]=function(){return f[a].apply(f,[this.models].concat(f.toArray(arguments)))}}),e.Router=function(a){a||(a={}),a.routes&&(this.routes=a.routes),this._bindRoutes(),this.initialize.apply(this,arguments)};var i=/:\w+/g,j=/\*\w+/g,k=/[-[\]{}()+?.,\\^$|#\s]/g;f.extend(e.Router.prototype,e.Events,{initialize:function(){},route:function(a,b,c){return e.history||(e.history=new e.History),f.isRegExp(a)||(a=this._routeToRegExp(a)),c||(c=this[b]),e.history.route(a,f.bind(function(d){var f=this._extractParameters(a,d);c&&c.apply(this,f),this.trigger.apply(this,["route:"+b].concat(f)),e.history.trigger("route",this,b,f)},this)),this},navigate:function(a,b){e.history.navigate(a,b)},_bindRoutes:function(){if(!this.routes)return;var a=[];for(var b in this.routes)a.unshift([b,this.routes[b]]);for(var c=0,d=a.length;c<d;c++)this.route(a[c][0],a[c][1],this[a[c][1]])},_routeToRegExp:function(a){return a=a.replace(k,"\\$&").replace(i,"([^/]+)").replace(j,"(.*?)"),new RegExp("^"+a+"$")},_extractParameters:function(a,b){return a.exec(b).slice(1)}}),e.History=function(){this.handlers=[],f.bindAll(this,"checkUrl")};var l=/^[#\/]/,m=/msie [\w.]+/,n=!1;f.extend(e.History.prototype,e.Events,{interval:50,getFragment:function(a,b){if(a==null)if(this._hasPushState||b){a=window.location.pathname;var c=window.location.search;c&&(a+=c)}else a=window.location.hash;return a=decodeURIComponent(a),a.indexOf(this.options.root)||(a=a.substr(this.options.root.length)),a.replace(l,"")},start:function(a){if(n)throw new Error("Backbone.history has already been started");this.options=f.extend({},{root:"/"},this.options,a),this._wantsHashChange=this.options.hashChange!==!1,this._wantsPushState=!!this.options.pushState,this._hasPushState=!!(this.options.pushState&&window.history&&window.history.pushState);var b=this.getFragment(),c=document.documentMode,d=m.exec(navigator.userAgent.toLowerCase())&&(!c||c<=7);d&&(this.iframe=g('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow,this.navigate(b)),this._hasPushState?g(window).bind("popstate",this.checkUrl):this._wantsHashChange&&"onhashchange"in window&&!d?g(window).bind("hashchange",this.checkUrl):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.fragment=b,n=!0;var e=window.location,h=e.pathname==this.options.root;if(this._wantsHashChange&&this._wantsPushState&&!this._hasPushState&&!h)return this.fragment=this.getFragment(null,!0),window.location.replace(this.options.root+"#"+this.fragment),!0;this._wantsPushState&&this._hasPushState&&h&&e.hash&&(this.fragment=e.hash.replace(l,""),window.history.replaceState({},document.title,e.protocol+"//"+e.host+this.options.root+this.fragment));if(!this.options.silent)return this.loadUrl()},stop:function(){g(window).unbind("popstate",this.checkUrl).unbind("hashchange",this.checkUrl),clearInterval(this._checkUrlInterval),n=!1},route:function(a,b){this.handlers.unshift({route:a,callback:b})},checkUrl:function(a){var b=this.getFragment();b==this.fragment&&this.iframe&&(b=this.getFragment(this.iframe.location.hash));if(b==this.fragment||b==decodeURIComponent(this.fragment))return!1;this.iframe&&this.navigate(b),this.loadUrl()||this.loadUrl(window.location.hash)},loadUrl:function(a){var b=this.fragment=this.getFragment(a),c=f.any(this.handlers,function(a){if(a.route.test(b))return a.callback(b),!0});return c},navigate:function(a,b){if(!n)return!1;if(!b||b===!0)b={trigger:b};var c=(a||"").replace(l,"");if(this.fragment==c||this.fragment==decodeURIComponent(c))return;this._hasPushState?(c.indexOf(this.options.root)!=0&&(c=this.options.root+c),this.fragment=c,window.history[b.replace?"replaceState":"pushState"]({},document.title,c)):this._wantsHashChange?(this.fragment=c,this._updateHash(window.location,c,b.replace),this.iframe&&c!=this.getFragment(this.iframe.location.hash)&&(b.replace||this.iframe.document.open().close(),this._updateHash(this.iframe.location,c,b.replace))):window.location.assign(this.options.root+a),b.trigger&&this.loadUrl(a)},_updateHash:function(a,b,c){c?a.replace(a.toString().replace(/(javascript:|#).*$/,"")+"#"+b):a.hash=b}}),e.View=function(a){this.cid=f.uniqueId("view"),this._configure(a||{}),this._ensureElement(),this.initialize.apply(this,arguments),this.delegateEvents()};var o=/^(\S+)\s*(.*)$/,p=["model","collection","el","id","attributes","className","tagName"];f.extend(e.View.prototype,e.Events,{tagName:"div",$:function(a){return this.$el.find(a)},initialize:function(){},render:function(){return this},remove:function(){return this.$el.remove(),this},make:function(a,b,c){var d=document.createElement(a);return b&&g(d).attr(b),c&&g(d).html(c),d},setElement:function(a,b){return this.$el=g(a),this.el=this.$el[0],b!==!1&&this.delegateEvents(),this},delegateEvents:function(a){if(!a&&!(a=u(this,"events")))return;this.undelegateEvents();for(var b in a){var c=a[b];f.isFunction(c)||(c=this[a[b]]);if(!c)throw new Error('Event "'+a[b]+'" does not exist');var d=b.match(o),e=d[1],g=d[2];c=f.bind(c,this),e+=".delegateEvents"+this.cid,g===""?this.$el.bind(e,c):this.$el.delegate(g,e,c)}},undelegateEvents:function(){this.$el.unbind(".delegateEvents"+this.cid)},_configure:function(a){this.options&&(a=f.extend({},this.options,a));for(var b=0,c=p.length;b<c;b++){var d=p[b];a[d]&&(this[d]=a[d])}this.options=a},_ensureElement:function(){if(!this.el){var a=u(this,"attributes")||{};this.id&&(a.id=this.id),this.className&&(a["class"]=this.className),this.setElement(this.make(this.tagName,a),!1)}else this.setElement(this.el,!1)}});var q=function(a,b){var c=t(this,a,b);return c.extend=this.extend,c};e.Model.extend=e.Collection.extend=e.Router.extend=e.View.extend=q;var r={create:"POST",update:"PUT","delete":"DELETE",read:"GET"};e.sync=function(a,b,c){var d=r[a],h={type:d,dataType:"json"};return c.url||(h.url=u(b,"url")||v()),!c.data&&b&&(a=="create"||a=="update")&&(h.contentType="application/json",h.data=JSON.stringify(b.toJSON())),e.emulateJSON&&(h.contentType="application/x-www-form-urlencoded",h.data=h.data?{model:h.data}:{}),e.emulateHTTP&&(d==="PUT"||d==="DELETE")&&(e.emulateJSON&&(h.data._method=d),h.type="POST",h.beforeSend=function(a){a.setRequestHeader("X-HTTP-Method-Override",d)}),h.type!=="GET"&&!e.emulateJSON&&(h.processData=!1),g.ajax(f.extend(h,c))},e.wrapError=function(a,b,c){return function(d,e){e=d===b?e:d,a?a(b,e,c):b.trigger("error",b,e,c)}};var s=function(){},t=function(a,b,c){var d;return b&&b.hasOwnProperty("constructor")?d=b.constructor:d=function(){a.apply(this,arguments)},f.extend(d,a),s.prototype=a.prototype,d.prototype=new s,b&&f.extend(d.prototype,b),c&&f.extend(d,c),d.prototype.constructor=d,d.__super__=a.prototype,d},u=function(a,b){return!a||!a[b]?null:f.isFunction(a[b])?a[b]():a[b]},v=function(){throw new Error('A "url" property or function must be specified')}}.call(this),define("vendor/backbone",function(){}),define("use!vendor/backbone",["underscore","jquery"],function(a,b){return Backbone}),function(){define("compiled/backbone-ext/Backbone.syncWithMultipart",["use!vendor/backbone","underscore"],function(a,b){return a.syncWithoutMultipart=a.sync,a.syncWithMultipart=function(a,c,d){var e,f,g,h,i,j,k,l;return j="file_upload_iframe_"+(new Date).getTime(),f=$("<iframe id='"+j+"' name='"+j+"' ></iframe>").hide(),i={create:"POST",update:"PUT","delete":"DELETE",read:"GET"}[a],k=function(a,c){var d;return d=b.map(a,function(a,c){var d,e;if(b.isElement(a))return e=$(a),e.after(e.clone(!0)),a;if(!b.isEmpty(a)&&(b.isArray(a)||typeof a=="object"))return k(a,c);if(!(""+c).match(/^_/)&&a!=null&&typeof a!="object"&&typeof a!="function")return d=$("<input/>",{name:c,value:a}),d[0]}),b.flatten(d)},e=$("<form enctype='multipart/form-data' target='"+j+"' action='"+((l=d.url)!=null?l:c.url())+"' method='POST'>\n  <input type='hidden' name='_method' value='"+i+"' />\n  <input type='hidden' name='authenticity_token' value='"+ENV.AUTHENTICITY_TOKEN+"' />\n</form>").hide(),e.prepend(function(){var a,b,d,e;d=k(c),e=[];for(a=0,b=d.length;a<b;a++)h=d[a],h&&e.push(h);return e}()),$(document.body).prepend(f,e),g=function(){var a,b,c;return a=(f[0].contentDocument||f[0].contentWindow.document).body,b=$.parseJSON($(a).text()),b=(c=b.objects)!=null?c:b,a.className==="error"?typeof d.error=="function"&&d.error(b):typeof d.success=="function"&&d.success(b),f.remove(),e.remove()},f[0].onreadystatechange=function(){if(this.readyState==="complete")return g()},f[0].onload=g,e[0].submit()},a.sync=function(b,c,d){return(d!=null?d.multipart:void 0)?a.syncWithMultipart.apply(this,arguments):a.syncWithoutMultipart.apply(this,arguments)}})}.call(this),function(){define("compiled/backbone-ext/Model/computedAttributes",["use!vendor/backbone","underscore"],function(a,b){return b.extend(a.Model.prototype,{initialize:function(){if(this.computedAttributes!=null)return this._configureComputedAttributes()},_configureComputedAttributes:function(){var a,c=this;return a=function(a){return c.set(a,c[a]())},b.each(this.computedAttributes,function(d){var e;return typeof d=="string"?a(d):(a(d.name),e=b.map(d.deps,function(a){return"change:"+a}).join(" "),c.bind(e,function(){return a(d.name)}))})}}),a.Model})}.call(this),function(){define("compiled/backbone-ext/Model/dateAttributes",["use!vendor/backbone","underscore"],function(a,b){var c;return c=a.Model.prototype.parse,a.Model.prototype.parse=function(){var a;return a=c.apply(this,arguments),b.each(this.dateAttributes,function(b){if(a[b])return a[b]=Date.parse(a[b])}),a},a.Model})}.call(this),function(){define("compiled/backbone-ext/Model",["use!vendor/backbone","compiled/backbone-ext/Model/computedAttributes","compiled/backbone-ext/Model/dateAttributes"],function(a){return a.Model})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a},d=[].slice;define("compiled/backbone-ext/View",["use!vendor/backbone","underscore"],function(b,e){return b.View=function(b){function f(){return this.renderView=a(this.renderView,this),f.__super__.constructor.apply(this,arguments)}return c(f,b),f.name="View",f.prototype.views=!1,f.prototype.render=function(a){return a==null&&(a={}),this.options.views&&this.renderViews(),a.noFilter!==!0&&this.filter(),this},f.prototype.filter=function(){var a=this;return this.$("[data-bind]").each(function(){return a.createBinding.apply(a,arguments)})},f.prototype.renderViews=function(){return e.each(this.options.views,this.renderView)},f.prototype.renderView=function(a,b){var c;return c=this.$("."+b).first(),a.$el=c,a.el=c[0],a.delegateEvents(),a.render()},f.prototype.createBinding=function(a,b){var c,d,e=this;return c=$(b),d=c.data("bind"),this.model.bind("change:"+d,function(a,b){return c.html(b)})},f.mixin=function(){var a,b,c,f,g,h;c=1>arguments.length?[]:d.call(arguments,0);for(g=0,h=c.length;g<h;g++){b=c[g];for(a in b)f=b[a],a==="events"?e.extend(this.prototype[a],f):this.prototype[a]=f}return this},f}(b.View),b.View})}.call(this),define("Backbone",["use!vendor/backbone","compiled/backbone-ext/Backbone.syncWithMultipart","compiled/backbone-ext/Model","compiled/backbone-ext/View"],function(a){return a.noConflict()}),define("translations/conversations.conversation_item",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{}})}),function(){var a=[].slice;define("compiled/util/shortcut",[],function(){return function(){var b,c,d,e,f,g,h;b=arguments[0],e=arguments[1],d=3>arguments.length?[]:a.call(arguments,2),h=[];for(f=0,g=d.length;f<g;f++)c=d[f],h.push(function(a){return b.prototype[a]=function(){return this[e][a].apply(this[e],arguments)}}(c));return h}})}.call(this),define("translations/lib.text_helper",["i18nObj","jquery"],function(a,b){b.extend(!0,a,{translations:{es:{lib:{text_helper:{quoted_text_toggle:"mostrar texto citado"}}}}})}),function(){define("compiled/str/TextHelper",["i18n!lib.text_helper","str/htmlEscape"],function(a,b){var c,d,e;return c="LINK-PLACEHOLDER",d=/\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?¬´¬ª‚Äú‚Äù‚Äò‚Äô]))|(LINK-PLACEHOLDER)/gi,e={quoteClump:function(b){return"<div class='quoted_text_holder'>        <a href='#' class='show_quoted_text_link'>"+a.t("quoted_text_toggle","show quoted text")+"</a>        <div class='quoted_text' style='display: none;'>          "+b.join("\n")+"        </div>      </div>"},formatMessage:function(a){var f,g,h,i,j,k,l;h=[],i=[],a=a.replace(d,function(a,d){var e;return i.push(a===c?c:(e=a,e.slice(0,4)==="www"?e="http://"+e:void 0,e=encodeURI(e).replace(/'/g,"%27"),h.push(e),"<a href='"+b(e)+"'>"+b(a)+"</a>")),c}),a=b(a),a=a.replace(new RegExp(c,"g"),function(a,b){return i.shift()}),a=a.replace(/\n/g,"<br />\n"),j=[],k=[],l=a.split("\n");for(f in l)g=l[f],g.match(/^(&gt;|>)/)?k.push(g):(k.length&&j.push(e.quoteClump(k)),k=[],j.push(g));return k.length&&j.push(e.quoteClump(k)),a=j.join("\n")}}})}.call(this),define("vendor/jquery.elastic",["jquery"],function(a){a.fn.extend({elastic:function(b){var c=a.extend({},b),d=["paddingTop","paddingRight","paddingBottom","paddingLeft","borderLeftWidth","borderLeftStyle","borderRightWidth","borderRightStyle","fontSize","lineHeight","fontFamily","width","fontWeight"];return this.each(function(){function b(a,b){var c=Math.floor(parseInt(a,10));f.height()!=c&&f.css({height:c+"px",overflow:b})}function e(){var d=f.val().replace(/&/g,"&amp;").replace(/  /g,"&nbsp;").replace(/<|>/g,"&gt;").replace(/\n/g,"<br />"),e=g.html().replace(/<br>/ig,"<br />");if(d+"&nbsp;"!=e){g[0].innerHTML=d+"&nbsp;",g.width(f.width());var k=g.height();if(Math.abs(k+h-f.height())>3){var l=k+h;l<j?l>i?b(l,"hidden"):b(i,"hidden"):b(j,"auto"),a.isFunction(c.callback)&&c.callback()}}}if(this.type!="textarea")return!1;var f=a(this),g=a("<div />").css({position:"absolute",display:"none","word-wrap":"break-word"}).prependTo(f.parent()),h=parseInt(f.css("line-height"),10)||parseInt(f.css("font-size"),"10"),i=parseInt(f.css("height"),10)||h*3,j=parseInt(f.css("max-height"),10)||Number.MAX_VALUE,k=0;j<0&&(j=Number.MAX_VALUE),a.each(d,function(a,b){g.css(b,f.css(b))}),f.css({overflow:"hidden"}).bind("keyup change cut paste",e).bind("input paste",function(a){setTimeout(e,250)}),e()})}})}),function(){var a=[].slice;define("compiled/util/ScrollableListDataSource",["jquery","jquery.ajaxJSON"],function(b){return function(){function c(a,b){var c,d,e,f,g,h,i,j,k;this.list=a,this.pageOffset=(c=b.pageOffset)!=null?c:1,this.perPage=(d=b.perPage)!=null?d:25,this.pageKey=(e=b.pageKey)!=null?e:"page",this.perPageKey=(f=b.perPageKey)!=null?f:"per_page",this.itemIdsKey=(g=b.itemIdsKey)!=null?g:"item_ids",this.itemsKey=(h=b.itemsKey)!=null?h:"items",this.sortKey=(i=b.sortKey)!=null?i:"id",this.sortDir=(j=b.sortDir)!=null?j:"asc",this.params=(k=b.params)!=null?k:{},this.baseUrl=b.baseUrl,this.model=b.model}return c.prototype.load=function(a,b){return this.initialized=!0,a.sortKey!=null&&(this.sortKey=a.sortKey),a.params!=null&&(this.params=a.params),this.itemIds=null,this.items=[],this.pages=[],this.resetRequests(),this.fetchPage(0,b)},c.prototype.addItem=function(a){return this._addItem(this.modelize(a)),this.recompute()},c.prototype.updateItems=function(a){var b,c,d,e;a=this.modelize(a),b=a.length<=1;for(d=0,e=a.length;d<e;d++)c=a[d],c.get("visible")?this.itemMap[c.id]!=null?this._updateItem(c,b):this._addItem(c,b):this._removeItem(c,b);return this.recompute(!b)},c.prototype.removeItem=function(a){return this._removeItem(this.modelize(a)),this.recompute()},c.prototype.modelize=function(a){var b,c,d,e,f,g=this;c=function(a){return a=new g.model(a),a.list=g.list,a};if(a.length){f=[];for(d=0,e=a.length;d<e;d++)b=a[d],f.push(c(b));return f}return c(a)},c.prototype.positionOrReload=function(a,b){var c;return c=this.positionFor(a,b),c!=null&&!this.deferredPositionChecks?c:(this.deferredPositionChecks==null&&(this.deferredPositionChecks=[]),this.deferredPositionChecks.push(a.id),null)},c.prototype.positionFor=function(a,b){var c,d,e,f,g,h=this;c=this.sortDir==="asc"?function(a,b){return a.get(h.sortKey)<b.get(h.sortKey)}:function(a,b){return a.get(h.sortKey)>b.get(h.sortKey)};for(d=f=0,g=this.items.length-1;0>g?f>g:f<g;d=0>g?--f:++f)if(this.items[d]){e=b===d&&a.id===this.items[d].id&&a.get(this.sortKey)===this.items[d].get(this.sortKey);if(e||c(a,this.items[d]))return d>1&&!this.items[d-1]?null:d}if(this.items.length===this.itemIds.length||this.itemIds.length===0)return this.itemIds.length},c.prototype.refreshList=function(){var a,b,c,d,e;e=[];for(b=c=0,d=this.pages.length;0>d?c>d:c<d;b=0>d?--c:++c){if(this.pages[b]!=="loaded")continue;a=b*this.perPage,e.push(this.list.replaceItems(a,this.items.slice(a,Math.min(a+this.perPage,this.itemIds.length)),this.itemIds.length))}return e},c.prototype.fetchRange=function(a,b){var c,d,e,f;b==null&&(b=a);if(!this.itemIds)return[];e=Math.floor(a/this.perPage),c=Math.floor(b/this.perPage),c=Math.min(c,Math.floor(this.itemIds.length/this.perPage));for(d=f=e;e>c?f>=c:f<=c;d=e>c?--f:++f)this.pages[d]||this.fetchPage(d);return this.requests},c.prototype.fetchPage=function(a,c){var d,e,f=this;return d=b.extend({},this.params),d[this.perPageKey]=this.perPage,d[this.pageKey]=a+this.pageOffset,this.pages[a]="loading",(e=this.requests[a])!=null&&e.abort(),this.requests[a]=b.ajaxJSON(this.baseUrl,"GET",d,function(b){var d,e;return delete f.requests[a],e=f.modelize(b[f.itemsKey]),d=b[f.itemIdsKey],f.fetchedPage(a,d,e),typeof c=="function"?c(d.length):void 0})},c.prototype.fetchedPage=function(b,c,d){var e,f,g,h,i;return f=b*this.perPage,e=d.length,c.length<(b+1)*this.perPage&&(e=((h=[])!=null?h:this.itemIds).length-f),this.setItemIds(c,b),(g=this.items)[f]==null&&(g[f]=null),(i=this.items).splice.apply(i,[f,e].concat(a.call(d))),this.pages[b]="loaded",this.list.replaceItems(f,d,this.itemIds.length)},c.prototype.resetRequests=function(){var a,b,c,d;if(this.requests){d=this.requests;for(b=0,c=d.length;b<c;b++)a=d[b],a!=null&&a.abort()}return this.requests=[]},c.prototype.setItemIds=function(a,b){var c;c=this.itemIds==null;if(!c&&this.itemIds.toString()===a.toString())return;this.itemIds=a,this.resetItemMap();if(!c)return this.refetchPages(b)},c.prototype.resetItemMap=function(){var a,b,c,d;this.itemMap={},d=[];for(a=b=0,c=this.itemIds.length;0>c?b>c:b<c;a=0>c?--b:++b)d.push(this.itemMap[this.itemIds[a]]=a);return d},c.prototype.recompute=function(a){var b,c,d,e=this;a==null&&(a=!1);if(this.deferredPositionChecks)return this.fetchPage(0,function(){var b,c,d,f;f=e.deferredPositionChecks;for(c=0,d=f.length;c<d;c++)b=f[c],e.fetchRange(e.itemMap[b]);delete e.deferredPositionChecks;if(a)return e.refreshList()});for(b=c=0,d=this.pages.length;0>d?c>d:c<d;b=0>d?--c:++c)this.pages[b]==="loaded"&&this.checkPage(b);if(a)return this.refreshList()},c.prototype.refetchPages=function(a){var b,c,d,e,f;f=[];for(b=c=0,d=this.pages.length;0>d?c>d:c<d;b=0>d?--c:++c)this.pages[b]==="loaded"&&b!==a&&(b*this.perPage<this.itemIds.length?f.push(this.fetchPage(b)):((e=this.requests[b])!=null&&e.abort(),f.push(delete this.pages[b])));return f},c.prototype.checkPage=function(a){var b,c,d,e;c=a*this.perPage;for(b=d=c,e=Math.min(c+this.perPage,this.itemIds.length);c>e?d>e:d<e;b=c>e?--d:++d)if(!this.items[b])return this.fetchPage(a)},c.prototype._addItem=function(a,b,c){var d;b==null&&(b=!0),c==null&&(c=null),d=c!=null?c:this.positionOrReload(a);if(d==null)return;return this.itemIds.splice(d,0,a.id),this.items.splice(d,0,a),b&&this.list.addedItem(a,d),this.resetItemMap()},c.prototype._updateItem=function(a,b,c){var d,e;b==null&&(b=!0),c==null&&(c=null),d=this.itemMap[a.id],e=c!=null?c:this.positionOrReload(a,d),a=this.items[d].set(a.toJSON());if(e==null)return;return e!==d&&this._moveItem(a,d,e),b&&this.list.updatedItem(a,d,e),this.resetItemMap()},c.prototype._moveItem=function(a,b,c){return c>b&&c--,this._removeItem(a,!1,b),this._addItem(a,!1,c)},c.prototype._removeItem=function(a,b,c){b==null&&(b=!0),c==null&&(c=null),c==null&&(c=this.itemMap[a.id]);if(c==null)return;return this.itemIds.splice(c,1),this.items.length>=c&&this.items.splice(c,1),b&&this.list.removedItem(a,c),this.resetItemMap()},c}()})}.call(this),function(){define("compiled/widget/ScrollableList",["compiled/util/ScrollableListDataSource","compiled/util/shortcut","compiled/jquery/scrollIntoView","jquery.disableWhileLoading"],function(a,b){return function(){function c(b,c){var d,e,f,g=this;this.$scroller=b,c==null&&(c={}),this.$scroller.css("overflow","auto"),this.ds=new a(this,c),this.$scroller.scroll(function(a){return g.scroll(a)}),this.$list=this.$scroller.find("ul").eq(0),this.$list.length||(this.$list=$("<ul>").appendTo(this.$scroller)),this.$list.addClass("scrollable-list"),this.itemTemplate=(d=c.itemTemplate)!=null?d:function(a){return"<li>"+a+"</li>"},this.elementHeight=(e=c.elementHeight)!=null?e:this.inferElementHeight(),this.fetchBuffer=(f=c.fetchBuffer)!=null?f:20,this.firstLoad=!0,c.noAutoLoad||this.load(),this.clicked&&this.$list.delegate(".scrollable-list > li","click",this.clicked)}return b(c,"ds","addItem","updateItems","removeItem"),c.prototype.item=function(a){return this.ds.items[this.positionFor(a)]},c.prototype.$item=function(a){var b;b=this.$itemAt(this.positionFor(a));if(b.length)return b},c.prototype.$itemAt=function(a){return this.$items().eq(a)},c.prototype.$items=function(){return this.$list.find("> li").not(".scrollable-list-item-deleting,.scrollable-list-item-moving")},c.prototype.addedItem=function(a,b){var c;return this.prepareItems(b-1),c=$(this.itemTemplate(a)),b===0?c.prependTo(this.$list):c.insertAfter(this.$itemAt(b-1)),this.setCount(this.ds.itemIds.length),typeof this.added=="function"?this.added(a,c):void 0},c.prototype.updateItem=function(a){return this.updateItems([a])},c.prototype.updatedItem=function(a,b,c){var d,e,f,g=this;return this.prepareItems(c-1),this.$itemAt(b).replaceWith(this.itemTemplate(a)),e=this.$items(),d=e.eq(b),b!==c&&(f=d.clone(),d.addClass("scrollable-list-item-moving").animate({opacity:"toggle",height:"toggle"},200,function(){return d.remove()}),c===0?f.prependTo(this.$list):f.insertAfter(e.eq(c-1)),f.animate({opacity:"toggle",height:"toggle"},0).animate({opacity:"toggle",height:"toggle"},200,function(){return f.scrollIntoView()})),typeof this.updated=="function"?this.updated(a,f!=null?f:d):void 0},c.prototype.removedItem=function(a,b){var c,d=this;return c=this.$itemAt(b),c.addClass("scrollable-list-item-deleting").fadeOut("fast",function(){return c.remove(),d.setCount(d.ds.itemIds.length),d.fetchVisible()}),typeof this.removed=="function"?this.removed(a,c):void 0},c.prototype.replaceItems=function(a,b,c){var d,e,f;this.setCount(c),this.prepareItems(a-1),d=this.$items().slice(a,a+b.length),f=[],d.length<b.length&&(f=b.slice(d.length),b=b.slice(0,d.length)),$(function(){var a,c,d;d=[];for(a=0,c=b.length;a<c;a++)e=b[a],d.push(this.itemTemplate(e));return d}.call(this).join("")).insertBefore(d.eq(0)),d.remove();if(f.length)return this.$list.append(function(){var a,b,c;c=[];for(a=0,b=f.length;a<b;a++)e=f[a],c.push(this.itemTemplate(e));return c}.call(this).join(""))},c.prototype.fetchVisible=function(){var a,b;return this.ds.itemIds?(b=Math.floor(this.$scroller.scrollTop()/this.elementHeight),a=Math.floor((this.$scroller.scrollTop()+this.$scroller.height()-1)/this.elementHeight)+this.fetchBuffer,a>=this.numItems&&(a=Math.max(this.numItems,1)-1),b=Math.max(0,b-this.fetchBuffer),this.prepareItems(a),this.ds.fetchRange(b,a)):[]},c.prototype.prepareItems=function(a){var b,c;c=a-this.$items().length;if(c>0)return this.$list.append(function(){var a,d;d=[];for(b=a=0;0>c?a>=c:a<=c;b=0>c?--a:++a)d.push("<li class='scrollable-list-item-loading' />");return d}().join(""))},c.prototype.scroll=function(){var a=this;return this.scrollCb&&clearTimeout(this.scrollCb),this.scrollCb=setTimeout(function(){return delete a.scrollCb,a.fetchVisible()},50)},c.prototype.inferElementHeight=function(){var a,b;return a=$(this.itemTemplate({})).appendTo(this.$list),b=a.height(),a.remove(),b},c.prototype.positionFor=function(a){return this.ds.itemMap[a]},c.prototype.loadItem=function(a){var b,c,d=this;return a!=null&&(c=this.positionFor(a))!=null&&(this.prepareItems(c),this.$item(a).scrollIntoView({toTop:this.firstLoad})),b=this.fetchVisible(),b.length||(b=[{}]),$.when.apply($,b).done(function(){var b,e,f;return c!=null&&(f=[d.ds.items[c],d.$item(a)],e=f[0],b=f[1]),typeof d.loaded=="function"?d.loaded(a,e,b):void 0})},c.prototype.load=function(a){var b,c,d,e=this;return a==null&&(a={}),d=a.sortKey&&a.sortKey!==this.ds.sortKey,c=a.params&&JSON.stringify(a.params)!==JSON.stringify(this.ds.params),d||c||!this.ds.initialized?(this.fetchThrough=0,this.$list.empty(),this.$list.css("min-height","0px"),b=this.ds.load(a,function(b){return e.setCount(b),e.loadItem(a.loadId),typeof a.cb=="function"&&a.cb(),e.firstLoad=!1}),this.$scroller.disableWhileLoading(b)):(this.loadItem(a.loadId),this.firstLoad=!1)},c.prototype.setCount=function(a){var b;this.numItems=a,this.$list.css("min-height",this.elementHeight*this.numItems+"px"),b=this.$items();if(b.length>this.numItems)return b.slice(this.numItems).remove()},c}()})}.call(this),function(){var a={}.hasOwnProperty,b=function(b,c){function e(){this.constructor=b}for(var d in c)a.call(c,d)&&(b[d]=c[d]);return e.prototype=c.prototype,b.prototype=new e,b.__super__=c.prototype,b};define("compiled/conversations/Conversation",["Backbone","jquery.ajaxJSON","jquery.disableWhileLoading"],function(a){var c;return c=function(a){function c(){return c.__super__.constructor.apply(this,arguments)}return b(c,a),c.name="Conversation",c.prototype.defaults={audience:[]},c.prototype.inboxAction=function(a){var b,c,d,e=this;return c={method:"POST",success:function(a){return e.list.updateItem(a)}},a=$.extend(!0,{},c,a),a.data=$.extend(this.list.baseData(),(d=a.data)!=null?d:{}),b=$.ajaxJSON(a.url,a.method,a.data,function(b){return typeof a.success=="function"&&a.success(b),e.list.updateItem(b)}),this.list.$item(this.id).disableWhileLoading(b)},c.prototype.url=function(a){return a==null&&(a=""),"/conversations/"+this.id+"/"+a+"?"+$.param(this.list.baseData())},c}(a.Model)})}.call(this),function(){define("compiled/widget/slideshow",["i18n!slideshow","jquery","str/htmlEscape","jqueryui/dialog","jquery.instructure_misc_helpers"],function(a,b,c){var d,e;return d=function(){function a(a,d){var e,f;this.title=a,this.slideshow=d,this.body=b("<li/>").addClass("slide"),this.slideshow.slides.append(this.body),this.prevSlide=this.slideshow.slideObjects[this.slideshow.slideObjects.length-1],(f=this.prevSlide)!=null&&(f.nextSlide=this),this.nextSlide=null,this.indicator=b("<a/>").addClass("slide").attr("href","#").attr("title",c(this.title)).html("&nbsp;"),this.indicator.data("slide",this),this.slideshow.navigation.append(this.indicator),e=this,this.indicator.click(function(){return d.showSlide(e),!1}),this.hide()}return a.name="Slide",a.prototype.addParagraph=function(a,d){var e;return e=b("<p/>"),d!=null&&e.addClass(d),e.html(c(a)),this.body.append(e)},a.prototype.addImage=function(a,c,d){var e,f;return e=b("<img/>").attr("src",a),c!=null&&e.addClass(c),d?(f=b("<a/>").attr("href",d).attr("target","_blank"),f.append(e),this.body.append(f)):this.body.append(e)},a.prototype.show=function(){return this.body.show(),this.indicator.addClass("current_slide")},a.prototype.hide=function(){return this.indicator.removeClass("current_slide"),this.body.hide()},a}(),e=function(){function e(d){var e;e=this,this.dom=b("<div/>").attr("id",d),this.slides=b("<ul/>").addClass("slides"),this.dom.append(this.slides),this.separator=b("<div/>").addClass("separator"),this.dom.append(this.separator),this.navigation=b("<div/>").addClass("navigation"),this.dom.append(this.navigation),this.backButton=b("<a/>").addClass("back").attr("href","#").attr("title",c(a.t("titles.back","Back"))).html("&nbsp;"),this.navigation.append(this.backButton),this.backButton.click(function(){return e.showPrevSlide(),!1}),this.forwardButton=b("<a/>").addClass("forward").attr("href","#").attr("title",c(a.t("titles.forward","Forward"))).html("&nbsp;"),this.navigation.append(this.forwardButton),this.forwardButton.click(function(){return e.showNextSlide(),!1}),this.closeButton=b("<a/>").addClass("close").attr("href","#").attr("title",c(a.t("titles.close","Close"))).html("&nbsp;"),this.navigation.append(this.closeButton),this.closeButton.click(function(){return e.close(),!1}),this.slideObjects=[],this.slideShown=null}return e.name="Slideshow",e.prototype.addSlide=function(a,b){var c;return c=new d(a,this),this.slideObjects.push(c),b(c)},e.prototype.start=function(){return this.showSlide(this.slideObjects[0]),this.dialog=this.dom.dialog({dialogClass:"slideshow_dialog",height:529,width:700,modal:!0,draggable:!1,resizable:!1})},e.prototype.showSlide=function(a){var b;if(a){if(!this.slideShown||a!==this.slideShown)(b=this.slideShown)!=null&&b.hide(),this.slideShown=a,this.slideShown.show();return this.slideShown.prevSlide?this.backButton.removeClass("inactive"):this.backButton.addClass("inactive"),this.slideShown.nextSlide?this.forwardButton.removeClass("inactive"):this.forwardButton.addClass("inactive")}},e.prototype.showPrevSlide=function(){var a;return this.showSlide((a=this.slideShown)!=null?a.prevSlide:void 0)},e.prototype.showNextSlide=function(){var a;return this.showSlide((a=this.slideShown)!=null?a.nextSlide:void 0)},e.prototype.close=function(){var a;return this.dom.dialog("close"),this.dom.hide(),(a=this.slideShown)!=null&&a.hide(),this.slideShown=null},e}(),e})}.call(this),function(){define("compiled/conversations/introSlideshow",["i18n!conversations_intro","compiled/widget/slideshow","jquery.ajaxJSON"],function(a,b){return function(){var c;return c=new b("conversations_intro"),c.addSlide(a.t("titles.slide1","Slide 1"),function(b){return b.addImage("/images/conversations/intro/icon.png","icon"),b.addParagraph(a.t("slide1.paragraph1","Take a look at your Inbox!"),"large"),b.addParagraph(a.t("slide1.paragraph2","Conversations‚Äîthe new Canvas messaging system‚Äîhas arrived!"),"large"),b.addParagraph(a.t("slide1.paragraph3","Use Conversations to send a private message to a classmate or use Conversations to talk to an entire group of people."),"large_and_blue"),b.addParagraph(a.t("slide1.paragraph4","Ready for a short intro? Click the right arrow to get started."),"large")}),c.addSlide(a.t("titles.slide2","Slide 2"),function(b){return b.addImage("/images/conversations/intro/image2.png","screenshot"),b.addParagraph(a.t("slide2.paragraph1","All your conversations are shown on the left side.")),b.addParagraph(a.t("slide2.paragraph2","You can see who the conversation is with, how many messages there are, and a few lines from the newest message in each conversation."))}),c.addSlide(a.t("titles.slide3","Slide 3"),function(b){return b.addImage("/images/conversations/intro/image3.png","screenshot"),b.addParagraph(a.t("slide3.paragraph1",'Conversations can be marked as read/unread, archived, or labeled by color using the "actions" button on the message.')),b.addParagraph(a.t("slide3.paragraph2","Archived messages aren't deleted, they're just moved out of your inbox, so you can access them again if needed."))}),c.addSlide(a.t("titles.slide4","Slide 4"),function(b){return b.addImage("/images/conversations/intro/image4.png","screenshot"),b.addParagraph(a.t("slide4.paragraph1","When you select a conversation, all the messages for that conversation are shown in the panel on the right. When conversations get long, you can always scroll down to see earlier messages."))}),c.addSlide(a.t("titles.slide5","Slide 5"),function(b){return b.addImage("/images/conversations/intro/image5.png","screenshot"),b.addParagraph(a.t("slide5.paragraph1","To begin a message, start by clicking the Compose icon."))}),c.addSlide(a.t("titles.slide6","Slide 6"),function(b){return b.addImage("/images/conversations/intro/image6.png","screenshot"),b.addParagraph(a.t("slide6.paragraph1","In the New Message box, start typing the person, or group's name, and they'll show up in the dropdown. Alternatively, you can click the address book icon to find someone if you don't remember a name.")),b.addParagraph(a.t("slide6.paragraph2","Type your message, click Send, and you're golden."))}),c.addSlide(a.t("titles.slide7","Slide 7"),function(b){return b.addImage("/images/conversations/intro/image7.png","screenshot"),b.addParagraph(a.t("slide7.paragraph1","You can send messages to one person or to a group of people. By default all group messages are available to everyone in the group.")),b.addParagraph(a.t("slide7.paragraph2",'If you wanted to send the message privately to all the recipients, uncheck the "This is a group conversation" checkbox.'))}),c.addSlide(a.t("titles.slide8","Slide 8"),function(b){return b.addImage("/images/conversations/intro/image8.png","screenshot"),b.addParagraph(a.t("slide8.paragraph1","You can select one or more messages by clicking the checkbox on the right hand side.")),b.addParagraph(a.t("slide8.paragraph2","Once selected, you can forward them to someone else, or delete them."))}),c.addSlide(a.t("titles.slide9","Slide 9"),function(b){return b.addImage("/images/conversations/intro/image9.png","screenshot","http://www.youtube.com/watch?v=NWqIaEyVWZM"),b.addParagraph(a.t("slide9.paragraph1","We think you'll find Conversations simple and easy to use.")),b.addParagraph(a.t("slide9.paragraph2","Check out this short introduction video to see Conversations in action.")),b.addParagraph(a.t("slide9.paragraph3","Your old messages have been organized into Conversations for you. So what are you waiting for? Get started!"))}),c.dom.bind("dialogclose",function(){return $.ajaxJSON("/conversations/watched_intro","POST",{})}),c.start()}})}.call(this),define("jst/conversations/conversationItem",["compiled/handlebars_helpers","i18n!conversations.conversation_item"],function(a){var b=a.template,c=a.templates=a.templates||{};return c["conversations/conversationItem"]=b(function(a,b,c,d,e){function q(a,b){var d="",e;return d+='<img src="',e=c.avatar_url||a.avatar_url,typeof e===m?e=e.call(a,{hash:{}}):e===o&&(e=n.call(a,"avatar_url",{hash:{}})),d+=p(e)+'" class="avatar" />',d}function r(a,b){return' style="display:none"'}c=c||a.helpers;var f="",g,h,i,j,k,l=this,m="function",n=c.helperMissing,o=void 0,p=this.escapeExpression;f+='<li data-id="',g=c.id||b.id,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"id",{hash:{}})),f+=p(g)+'" class="',g=c.classes||b.classes,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"classes",{hash:{}})),f+=p(g)+'">\n  ',g=c.avatar_url||b.avatar_url,h=c["if"],k=l.program(1,q,e),k.hash={},k.fn=k,k.inverse=l.noop,g=h.call(b,g,k);if(g||g===0)f+=g;f+='\n  <a href="/conversations/',g=c.id||b.id,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"id",{hash:{}})),f+=p(g)+'?conversation[workflow_state]=unread" class="action_mark_as_unread" title="',g="Mark as Unread",h="inbox_actions.mark_as_unread",i={},j="conversations.conversationItem",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='">',g="Mark as Unread",h="inbox_actions.mark_as_unread",i={},j="conversations.conversationItem",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</a>\n  <a href="/conversations/',g=c.id||b.id,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"id",{hash:{}})),f+=p(g)+'?conversation[workflow_state]=read" class="action_mark_as_read" title="',g="Mark as Read",h="inbox_actions.mark_as_read",i={},j="conversations.conversationItem",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='">',g="Mark as Read",h="inbox_actions.mark_as_read",i={},j="conversations.conversationItem",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</a>\n  <a href="/conversations/',g=c.id||b.id,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"id",{hash:{}})),f+=p(g)+'?conversation[starred]=true" class="action_star" title="',g="Star",h="inbox_actions.action_star",i={},j="conversations.conversationItem",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='">',g="Star",h="inbox_actions.action_star",i={},j="conversations.conversationItem",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</a>\n  <a href="/conversations/',g=c.id||b.id,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"id",{hash:{}})),f+=p(g)+'?conversation[starred]=false" class="action_unstar" title="',g="Unstar",h="inbox_actions.action_unstar",i={},j="conversations.conversationItem",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='">',g="Unstar",h="inbox_actions.action_unstar",i={},j="conversations.conversationItem",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</a>\n  <span class="date">',g=c.lastMessageAt||b.lastMessageAt,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"lastMessageAt",{hash:{}})),f+=p(g)+'</span>\n  <img class="attachments" src="/images/messages/attach-gray.png" title="',g="This conversation has one or more attachments",h="has_attachments",i={},j="conversations.conversationItem",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='">\n  <img class="media_objects" src="/images/messages/media-gray.png" title="',g="This conversation has one or more media comments",h="has_media",i={},j="conversations.conversationItem",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='">\n  <span class="audience">',g=c.audienceHtml||b.audienceHtml,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"audienceHtml",{hash:{}}));if(g||g===0)f+=g;f+='</span>\n  <span class="count"',g=c.hideCount||b.hideCount,h=c["if"],k=l.program(3,r,e),k.hash={},k.fn=k,k.inverse=l.noop,g=h.call(b,g,k);if(g||g===0)f+=g;f+=">",g=c.message_count||b.message_count,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"message_count",{hash:{}})),f+=p(g)+"</span>\n  <p>",g=c.lastMessage||b.lastMessage,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"lastMessage",{hash:{}})),f+=p(g)+'</p>\n  <span class="actions"><a href="#" title="',g="Actions",h="inbox_actions_description",i={},j="conversations.conversationItem",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='">',g="Actions",h="inbox_actions_description",i={},j="conversations.conversationItem",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;f+='</a></span>\n  <a href="/conversations/',g=c.id||b.id,typeof g===m?g=g.call(b,{hash:{}}):g===o&&(g=n.call(b,"id",{hash:{}})),f+=p(g)+'" class="details_link">',g="more...",h="read_more",i={},j="conversations.conversationItem",i.scope=j,j=c.t||b.t,k={},k.hash=i,typeof j===m?g=j.call(b,h,g,k):j===o?g=n.call(b,"t",h,g,k):g=j;if(g||g===0)f+=g;return f+="</a>\n</li>\n",f}),c["conversations/conversationItem"]}),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b={}.hasOwnProperty,c=function(a,c){function e(){this.constructor=a}for(var d in c)b.call(c,d)&&(a[d]=c[d]);return e.prototype=c.prototype,a.prototype=new e,a.__super__=c.prototype,a};define("compiled/conversations/ConversationsList",["i18n!conversations.conversations_list","compiled/widget/ScrollableList","compiled/conversations/Conversation","jst/conversations/conversationItem","jquery.instructure_date_and_time"],function(b,d,e,f){return function(d){function g(b,c){var d=this;this.pane=b,this.conversationItem=a(this.conversationItem,this),this.clicked=a(this.clicked,this),this.loaded=a(this.loaded,this),this.app=this.pane.app,this.$empty=this.pane.$pane.find("#no_messages"),g.__super__.constructor.call(this,c,{model:e,itemTemplate:this.conversationItem,elementHeight:76,itemIdsKey:"conversation_ids",itemsKey:"conversations",sortKey:"last_message_at",sortDir:"desc",baseUrl:"/conversations?include_all_conversation_ids=1",noAutoLoad:!0}),this.$list.delegate(".action_mark_as_read, .action_mark_as_unread, .action_unstar, .action_star","click",function(a){return d.pane.action($(a.currentTarget),{method:"PUT"}),!1}),this.$list.delegate(".actions a","blur",function(a){return $(window).one("keyup",function(a){if(a.shiftKey)return d.app.closeMenus()})}),this.$list.delegate(".actions a","click",function(a){return d.pane.openConversationMenu($(a.currentTarget)),!1}).focus(function(a){return d.pane.openConversationMenu($(a.currentTarget))})}return c(g,d),g.prototype.baseData=function(){return{scope:this.scope,filter:this.filters}},g.prototype.load=function(a,b){var c,d=this;return this.scope=a.scope,this.filters=(c=a.filter)!=null?c:[],g.__super__.load.call(this,{sortKey:""+this.lastMessageKey()+"_at",params:this.baseData(),loadId:a.id,cb:function(){return d.emptyCheck(),typeof b=="function"?b():void 0}})},g.prototype.loaded=function(a,b,c){return a&&b==null?this.app.updateHashData({id:null}):this.activate(b,c)},g.prototype.added=function(a,b){return this.$empty.hide()},g.prototype.updated=function(a,b){var c;this.emptyCheck();if(this.isActive(a)&&((c=a.messages)!=null?c[0]:void 0))return this.app.addMessages(a.messages,"prepend","slide")},g.prototype.removed=function(a,b){this.emptyCheck();if(this.isActive(a.id))return this.activate(null)},g.prototype.clicked=function(a){return this.select($(a.currentTarget).data("id"))},g.prototype.lastMessageKey=function(){return this.scope==="sent"?"last_authored_message":"last_message"},g.prototype.emptyCheck=function(){var a,c,d,e;return d=this.app.filterNameMap,e=function(){switch(this.scope){case"unread":return b.t("no_unread_messages","You have no unread messages");case"starred":return b.t("no_starred_messages","You have no starred messages");case"sent":return b.t("no_sent_messages","You have no sent messages");case"archived":return b.t("no_archived_messages","You have no archived messages");default:return b.t("no_messages","You have no messages")}}.call(this),a=function(){var a,b,e,f;e=this.filters,f=[];for(a=0,b=e.length;a<b;a++)c=e[a],d[c]&&f.push(d[c]);return f}.call(this),a.length&&(e+=" ("+a.join(", ")+")"),this.$empty.text(e),this.$empty.showIf(!this.$items().length)},g.prototype.select=function(a,b){b==null&&(b=!0),this.ensureSelected(a,b);if(b)return this.app.updateHashData({id:a})},g.prototype.isActive=function(a){return this.active&&this.active.id===a},g.prototype.deactivate=function(){var a;if(!this.active||!this.item(this.active.id))return;return(a=this.$item(this.active.id))!=null&&a.removeClass("selected"),this.scope==="unread"&&this.removeItem(this.active),delete this.active},g.prototype.ensureSelected=function(a,b){b==null&&(b=!0),b?(this.selected=[],this.$items().removeClass("selected"),this.isActive(a)||this.deactivate()):this.selected==null&&(this.selected=[]);if(a!=null)return this.$item(a).addClass("selected"),this.selected.push(a)},g.prototype.activate=function(a,b){var c=this;if(a&&this.isActive(a!=null?a.id:void 0)){this.app.deselectMessages();return}return this.ensureSelected(a!=null?a.id:void 0),this.active=a,this.app.loadConversation(this.active,b,function(){if(b!=null?b.hasClass("unread"):void 0)return b.removeClass("read unread archived").addClass("read")})},g.prototype.conversationItem=function(a){var b,c,d,e,g,h,i;c=$.extend({},a.toJSON());if(c.participants){i=c.participants;for(g=0,h=i.length;g<h;g++)e=i[g],this.app.userCache[e.id]||(this.app.userCache[e.id]=e)}return c.audience&&(c.audienceHtml=this.app.htmlAudience(c,{highlightFilters:!0}),this.isActive(c.id)&&this.app.resetMessageForm(!1)),c.lastMessage=c[this.lastMessageKey()],c.lastMessageAt=$.friendlyDatetime($.parseFromISO(c[this.lastMessageKey()+"_at"]).datetime),c.hideCount=c.message_count===1,b=function(){var a,b,e,f;e=c.properties,f=[];for(a=0,b=e.length;a<b;a++)d=e[a],f.push(d);return f}(),b.push(c.workflow_state),c["private"]&&b.push("private"),c.starred&&b.push("starred"),c.subscribed||b.push("unsubscribed"),$.inArray(c.id,this.selected)>=0&&b.push("selected"),c.classes=b.join(" "),f(c)},g}(d)})}.call(this),function(){define("compiled/conversations/ConversationsPane",["i18n!conversations.conversations_pane","compiled/conversations/ConversationsList","str/htmlEscape","compiled/util/shortcut"],function(a,b,c,d){return function(){function c(a,c){this.app=a,this.$pane=c,this.list=new b(this,this.$pane.find("> div.conversations")),this.selected=[],this.initializeActions()}return d(c,"list","baseData","updateItems","isActive"),c.prototype.initializeActions=function(){var b,c=this;return b=$("#conversation_actions").find("li a"),b.click(function(a){return a.preventDefault(),c.app.closeMenus()}),b.filter(".standard_action").click(function(a){return c.action($(a.currentTarget),{method:"PUT"})}),$("#action_delete_all").click(function(b){if(confirm(a.t("confirm.delete_conversation","Are you sure you want to delete your copy of this conversation? This action cannot be undone.")))return c.action($(b.currentTarget),{method:"DELETE"})})},c.prototype.updateView=function(a){return this.list.load(a)},c.prototype.action=function(a,b){var c,d,e,f,g=this;return d=(f=b.conversationId)!=null?f:a.closest("div.conversations li").data("id"),d==null&&(d=$("#conversation_actions").data("activeConversationId")),c=this.list.item(d),b=$.extend(!0,{},{url:this.actionUrlFor(a,d)},b),e=b.success,b.success=function(a){var b;return((b=a.messages)!=null?b.length:void 0)&&g.app.addMessage(a.messages[0]),typeof e=="function"?e(a):void 0},c.inboxAction(b)},c.prototype.actionUrlFor=function(a,b){var c;return c=$.replaceTags(a.attr("href"),"id",b),c+(c.match(/\?/)?"&":"?")+$.param(this.baseData())},c.prototype.active=function(){return this.list.active},c.prototype.openConversationMenu=function(a){var b,c,d,e,f=this;return this.app.closeMenus(),d={node:a,container:$("#conversation_actions"),conversation:a.closest("li"),parent:a.parent(),lists:$("#conversation_actions ul"),listElements:$("#conversation_actions li"),focusable:$("a, input, select, textarea"),actions:{markAsRead:$("#action_mark_as_read").parent(),markAsUnread:$("#action_mark_as_unread").parent(),unstar:$("#action_unstar").parent(),star:$("#action_star").parent(),unsubscribe:$("#action_unsubscribe").parent(),subscribe:$("#action_subscribe").parent(),forward:$("#action_forward").parent(),archive:$("#action_archive").parent(),unarchive:$("#action_unarchive").parent(),"delete":$("#action_delete").parent(),deleteAll:$("#action_delete_all").parent()}},this.activeActionMenu=d.node,d.parent.addClass("selected"),d.container.addClass("selected"),d.conversation.addClass("menu_active"),b=d.container,c=d.conversation,d.container.data("activeConversationId",d.conversation.data("id")),d.lists.removeClass("first last").hide(),d.listElements.hide(),d.conversation.hasClass("unread")&&d.actions.markAsRead.show(),d.conversation.hasClass("read")&&d.actions.markAsUnread.show(),d.conversation.hasClass("starred")?d.actions.unstar.show():d.actions.star.show(),d.conversation.hasClass("private")?(d.actions.subscribe.hide(),d.actions.unsubscribe.hide()):(d.conversation.hasClass("unsubscribed")||d.actions.unsubscribe.show(),d.conversation.hasClass("unsubscribed")&&d.actions.subscribe.show()),d.actions.forward.show(),d.actions["delete"].show(),d.actions.deleteAll.show(),d.conversation.hasClass("archived")?d.actions.unarchive.show():d.actions.archive.show(),$(window).one("keydown",function(a){if(a.keyCode!==9||a.shiftKey)return;return d.focusable.one("focus.actions_menu",function(a){return f.nextElement=$(a.target),d.focusable.unbind(".actions_menu"),d.container.find("a:visible:first").focus(),d.container.find("a:visible:first").bind("blur.actions_menu",a,function(){return $(window).one("keyup",function(a){var b;b=d.container.find("a:focus").length;if(!b)return d.container.find("a.visible").unbind(".actions_menu"),f.activeActionMenu.focus()})}),d.container.find("a:visible:last").bind("blur.actions_menu",a,function(){return $(window).one("keyup",function(a){var b;b=d.container.find("a:focus").length;if(!b)return d.container.find("a.visible").unbind(".actions_menu"),f.nextElement.focus(),f.closeMenus()})})})}),d.container.find('li[style*="list-item"]').parent().show(),d.groups=d.container.find('ul[style*="block"]'),d.groups.length&&(d.groups.first().addClass("first"),d.groups.last().addClass("last")),e=d.node.offset(),d.container.css({left:e.left+d.node.width()/2-d.container.offsetParent().offset().left-d.container.width()/2,top:e.top+d.node.height()*.9-d.container.offsetParent().offset().top})},c.prototype.resize=function(a){return this.list.$scroller.height(a-$("#actions").outerHeight(!0)),this.list.fetchVisible()},c}()})}.call(this),function(){define("compiled/conversations/listWithOthers",["i18n!conversations","str/htmlEscape","jquery.instructure_misc_helpers"],function(a,b){return function(c,d){var e,f;return d==null&&(d=2),c.length>d&&(c=c.slice(0,d).concat([c.slice(d,c.length)])),$.toSentence(function(){var d,g,i;i=[];for(d=0,g=c.length;d<g;d++)f=c[d],typeof f=="string"||f.htmlSafe?i.push("<span>"+b(f)+"</span>"):i.push("<span class='others'>\n  "+b(a.t("other","other",{count:f.length}))+"\n  <span>\n    <ul>\n      "+function(){var a,c,d;d=[];for(a=0,c=f.length;a<c;a++)e=f[a],d.push("<li>"+b(e)+"</li>");return d}().join("")+"\n    </ul>\n  </span>\n</span>");return i}())}})}.call(this),function(){define("compiled/conversations/audienceList",["i18n!conversations","underscore","str/htmlEscape","compiled/conversations/listWithOthers","jquery.instructure_misc_helpers"],function(a,b,c,d){var e;return e=function(a){var b;return b=c(a.name),a.activeFilter&&(b="<span class='active-filter'>"+b+"</span>"),$.raw(b)},function(f,g){var i,j,k;return g==null&&(g={}),g.highlightFilters&&(f=b.groupBy(f,function(a){return a.activeFilter}),f=((k=f[true])!=null?k:[]).concat((j=f[false])!=null?j:[])),f=function(){var a,b,c;c=[];for(a=0,b=f.length;a<b;a++)i=f[a],c.push(e(i));return c}(),f.length===0?"<span>"+c(a.t("notes_to_self","Monologue"))+"</span>":d(f)}})}.call(this),function(){define("compiled/conversations/contextList",["underscore","str/htmlEscape","compiled/conversations/listWithOthers","jquery.instructure_misc_helpers"],function(a,b,c){var d;return d=function(a){var c;return c=b(a.name),a.activeFilter&&(c="<span class='active-filter'>"+c+"</span>"),this.options.linkToContexts&&a.type==="course"&&(c="<a href='"+b(a.url)+"'>"+c+"</a>"),$.raw(c)},function(b,e){var f;return this.options=e,b=a.sortBy(b,function(a){return""+(a.activeFilter?0:1)+"_"+a.name.toLowerCase()}),this.options.hardCutoff&&(b=b.slice(0,this.options.hardCutoff)),b=function(){var a,c,e;e=[];for(a=0,c=b.length;a<c;a++)f=b[a],e.push(d(f));return e}(),c(b)}})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define("compiled/widget/TokenSelector",["jquery","jquery.ajaxJSON","jquery.instructure_misc_helpers","jquery.disableWhileLoading","compiled/jquery/scrollIntoView"],function(b){return function(){function c(c,d,e){var f=this;this.input=c,this.url=d,this.options=e!=null?e:{},this.close=a(this.close,this),this.stack=[],this.fetchListAjaxRequests=[],this.queryCache={},this.$container=b("<div />").addClass("autocomplete_menu"),this.options.showToggles&&this.$container.addClass("with-toggles"),this.$menu=b("<div />").append(this.$list=this.newList()),this.$container.append(b("<div />").append(this.$menu)),this.$container.css("top",0).css("left",0),this.mode="input",b("body").append(this.$container),this.reposition=function(){var a;return a=f.input.bottomOffset(),f.$container.css("top",a.top),f.$container.css("left",a.left)},b(window).resize(this.reposition),this.close()}return c.prototype.abortRunningRequests=function(){var a,b,c,d;d=this.fetchListAjaxRequests;for(b=0,c=d.length;b<c;b++)a=d[b],a.abort();return this.fetchListAjaxRequests=[]},c.prototype.browse=function(a){if(!this.uiLocked)return this.input.val(""),this.close(),this.fetchList({data:a}),!0},c.prototype.newList=function(){var a,c=this;return a=b('<div class="list"><ul class="heading"></ul><ul></ul></div>'),a.find("ul").mousemove(function(a){var d;if(c.uiLocked)return;return d=b(a.target).closest("li"),d.hasClass("selectable")||(d=null),c.select(d)}).mousedown(function(a){return setTimeout(function(){return c.input.focus()},0)}).click(function(a){var d;if(c.uiLocked)return;return d=b(a.target).closest("li"),d.hasClass("selectable")||(d=null),c.select(d),c.selection&&(b(a.target).closest("a.expand").length?c.selectionExpanded()?c.collapse():c.expandSelection():c.selectionToggleable()&&b(a.target).closest("a.toggle").length?c.toggleSelection():c.selectionExpanded()?c.collapse():c.selectionExpandable()?c.expandSelection():(c.toggleSelection(!0),c.clear(),c.close())),c.input.focus()}),a.body=a.find("ul").last(),a},c.prototype.captureKeyDown=function(a){var b,c;if(this.uiLocked)return!0;switch((b=(c=a.originalEvent)!=null?c.keyIdentifier:void 0)!=null?b:a.which){case"Backspace":case"U+0008":case 8:if(this.input.val()==="")return this.listExpanded()?this.collapse():this.$menu.is(":visible")?this.close():this.input.removeLastToken(),!0;break;case"Tab":case"U+0009":case 9:this.selection&&(this.selectionToggleable()||!this.selectionExpandable())&&this.toggleSelection(!0),this.clear(),this.close();if(this.selection)return!0;break;case"Enter":case 13:if(this.selectionExpanded())return this.collapse(),!0;if(this.selectionExpandable()&&!this.selectionToggleable())return this.expandSelection(),!0;return this.selection&&(this.toggleSelection(!0),this.clear()),this.close(),!0;case"Shift":case 16:return!1;case"Esc":case"U+001B":case 27:return this.$menu.is(":visible")?(this.close(),!0):!1;case"U+0020":case 32:if(this.selectionToggleable()&&this.mode==="menu")return this.toggleSelection(),!0;break;case"Left":case 37:if(this.listExpanded()&&this.input.caret()===0)return this.selectionExpanded()||this.input.val()===""?this.collapse():this.select(this.$list.find("li").first()),!0;break;case"Up":case 38:return this.selectPrev(),!0;case"Right":case 39:if(this.input.caret()===this.input.val().length&&this.expandSelection())return!0;break;case"Down":case 40:return this.selectNext(),!0;case"U+002B":case 187:case 107:if(this.selectionToggleable()&&this.mode==="menu")return this.toggleSelection(!0),!0;break;case"U+002D":case 189:case 109:if(this.selectionToggleable()&&this.mode==="menu")return this.toggleSelection(!1),!0}return this.mode="input",this.fetchList(),!1},c.prototype.fetchList=function(a,c){var d=this;return a==null&&(a={}),this.uiLocked=c!=null?c:!1,clearTimeout(this.timeout),this.timeout=setTimeout(function(){var c,e,f;c=d.preparePost((f=a.data)!=null?f:{}),e=JSON.stringify(c);if(c.search===""&&!d.listExpanded()&&!a.data){d.uiLocked=!1,d.close();return}if(e===d.lastAppliedQuery){d.uiLocked=!1;return}if(d.queryCache[e]){d.lastAppliedQuery=e,d.lastSearch=c.search,d.abortRunningRequests(),d.renderList(d.queryCache[e],a,c);return}return d.fetchListAjaxRequests.push(d.load(b.ajaxJSON(d.url,"POST",b.extend({},c),function(b){var f;d.queryCache[e]=b;if(JSON.stringify(d.preparePost((f=a.data)!=null?f:{}))!==e)return d.uiLocked=!1;d.lastAppliedQuery=e,d.lastSearch=c.search;if(d.$menu.is(":visible"))return d.renderList(b,a,c)},function(a){return d.uiLocked=!1})))},100)},c.prototype.addByUserId=function(a,c){var d,e=this;return d=function(a){var b;e.close(),b=a[0];if(b)return e.input.addToken({value:b.id,text:b.name,data:b})},this.load(b.ajaxJSON(this.url,"POST",{user_id:a,from_conversation_id:c},d,this.close))},c.prototype.open=function(){return this.$container.show(),this.reposition()},c.prototype.close=function(){var a,b,c,d,e,f,g,h,i;this.uiLocked=!1,this.$container.hide(),delete this.lastAppliedQuery,h=this.stack;for(c=f=0,g=h.length;f<g;c=++f)i=h[c],b=i[0],a=i[1],d=i[2],e=i[3],this.$list.remove(),this.$list=a.css("height","auto");return this.$list.find("ul").html(""),this.stack=[],this.$menu.css("left",0),this.select(null),this.input.selectorClosed()},c.prototype.clear=function(){return this.input.val("")},c.prototype.blur=function(){return this.close()},c.prototype.listExpanded=function(){return this.stack.length?!0:!1},c.prototype.selectionExpanded=function(){var a,b;return(a=(b=this.selection)!=null?b.hasClass("expanded"):void 0)!=null?a:!1},c.prototype.selectionExpandable=function(){var a,b;return(a=(b=this.selection)!=null?b.hasClass("expandable"):void 0)!=null?a:!1},c.prototype.selectionToggleable=function(a){var b;return a==null&&(a=this.selection),((b=a!=null?a.hasClass("toggleable"):void 0)!=null?b:!1)&&!this.selectionExpanded()},c.prototype.expandSelection=function(){return!this.selectionExpandable()||!!this.selectionExpanded()?!1:(this.stack.push([this.selection,this.$list,this.lastAppliedQuery,this.lastSearch]),this.clear(),this.$menu.css("width",(this.stack.length+1)*100+"%"),this.fetchList({expand:!0},!0))},c.prototype.collapse=function(){var a,b,c,d=this;return this.listExpanded()?(c=this.stack.pop(),b=c[0],a=c[1],this.lastAppliedQuery=c[2],this.lastSearch=c[3],this.uiLocked=!0,a.css("height","auto"),this.$menu.animate({left:"+="+this.$menu.parent().css("width")},"fast",function(){return d.input.val(d.lastSearch),d.$list.remove(),d.$list=a,d.select(b),d.uiLocked=!1})):!1},c.prototype.toggleSelection=function(a,b,c){var d,e;b==null&&(b=this.selection),c==null&&(c=!1);if(a==null&&!this.selectionToggleable(b))return!1;d=b.data("id"),a==null&&(a=!b.hasClass("on")),a?(this.selectionToggleable(b)&&!c&&b.addClass("on"),this.input.addToken({value:d,text:(e=b.data("text"))!=null?e:b.text(),noClear:!0,data:b.data("user_data")})):(c||b.removeClass("on"),this.input.removeToken({value:d}));if(!c)return this.updateSelectAll(b)},c.prototype.updateSelectAll=function(a,c){var d,e,f,g,h,i,j=this;c==null&&(c=0),i=a.data("user_data").selectAll,d=c?this.stack[this.stack.length-c][1]:this.$list,h=d.selectAll;if(!h)return;e=d.body.find("li.toggleable").not(h),i?h.hasClass("on")?e.addClass("on").each(function(a,c){return j.toggleSelection(!1,b(c),!0)}):e.removeClass("on").each(function(a,c){return j.toggleSelection(!1,b(c),!0)}):(f=e.filter(".on"),f.length<e.length&&h.hasClass("on")?(h.removeClass("on"),this.toggleSelection(!1,h,!0),f.each(function(a,c){return j.toggleSelection(!0,b(c),!0)})):f.length===e.length&&!h.hasClass("on")&&(h.addClass("on"),this.toggleSelection(!0,h,!0),f.each(function(a,c){return j.toggleSelection(!1,b(c),!0)})));if(c<this.stack.length){c++,g=this.stack[this.stack.length-c][0];if(this.selectionToggleable(g))return h.hasClass("on")?g.addClass("on"):g.removeClass("on"),this.updateSelectAll(g,c)}},c.prototype.select=function(a,b){var c,d;b==null&&(b=!1);if((a!=null?a[0]:void 0)===((c=this.selection)!=null?c[0]:void 0))return;(d=this.selection)!=null&&d.removeClass("active"),this.selection=(a!=null?a.length:void 0)?(a.addClass("active"),a.scrollIntoView({ignore:{border:!0}}),a):null;if(!b)return this.mode=a?"menu":"input"},c.prototype.selectNext=function(a){var b;a==null&&(a=!1),this.select(this.selection?this.selection.next().length?this.selection.next():this.selection.parent("ul").next().length?this.selection.parent("ul").next().find("li").first():null:this.$list.find("li:first"),a);if((b=this.selection)!=null?b.hasClass("message"):void 0)return this.selectNext(a)},c.prototype.selectPrev=function(){var a,b;this.select(this.selection?((a=this.selection)!=null?a.prev().length:void 0)?this.selection.prev():this.selection.parent("ul").prev().length?this.selection.parent("ul").prev().find("li").last():null:this.$list.find("li:last"));if((b=this.selection)!=null?b.hasClass("message"):void 0)return this.selectPrev()},c.prototype.populateRow=function(a,b,c){c==null&&(c={}),this.options.populator?this.options.populator(this,a,b,c):(a.data("id",b.text),a.text(b.text)),c.first&&a.addClass("first");if(c.last)return a.addClass("last")},c.prototype.load=function(a){return this.$menu.is(":visible")||(this.open(),this.$list.find("ul").last().append(b('<li class="message first last"></li>'))),this.$list.disableWhileLoading(a),a},c.prototype.renderList=function(a,c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this;c==null&&(c={}),d==null&&(d={}),this.open(),c.expand?h=this.newList():h=this.$list,h.selectAll=null,this.selection=null,j=h.find("ul"),j.html(""),f=j.first(),e=j.last();if(a.length){n=this.stack.length?this.stack[this.stack.length-1][0]:null,l=this.stack.length?function(){var a,b,c,d;c=this.stack,d=[];for(a=0,b=c.length;a<b;a++)k=c[a],d.push(k[0].data("id"));return d}.call(this):[],a.prepared||(typeof (p=this.options).preparer=="function"&&p.preparer(d,a,n),a.prepared=!0);for(m=r=0,s=a.length;r<s;m=++r)o=a[m],g=b("<li />").addClass("selectable"),this.populateRow(g,o,{level:this.stack.length,first:m===0,last:m===a.length-1,parent:n,ancestors:l}),o.selectAll&&(h.selectAll=g),g.hasClass("toggleable")&&this.input.hasToken(g.data("id"))&&g.addClass("on"),e.append(g);(((t=h.selectAll)!=null?typeof t.hasClass=="function"?t.hasClass("on"):void 0:void 0)||this.stack.length&&(typeof (q=this.stack[this.stack.length-1][0]).hasClass=="function"?q.hasClass("on"):void 0))&&h.body.find("li.toggleable").addClass("on")}else i=b('<li class="message first last"></li>'),i.text((u=(v=this.options.messages)!=null?v.noResults:void 0)!=null?u:""),e.append(i);return this.listExpanded()?(g=this.stack[this.stack.length-1][0].clone(),g.addClass("expanded").removeClass("active first last"),f.append(g).show()):f.hide(),c.expand?(h.insertAfter(this.$list),this.$menu.animate({left:"-="+this.$menu.parent().css("width")},"fast",function(){return w.$list.animate({height:"1px"},"fast",function(){return w.uiLocked=!1}),w.$list=h,w.selectNext(!0)})):(c.loading||this.selectNext(!0),this.uiLocked=!1)},c.prototype.preparePost=function(a){var c,d,e;return c=b.extend({},(e=this.options.baseData)!=null?e:{},a,{search:this.input.val().replace(/^\s+|\s+$/g,"")}),c.exclude=this.input.baseExclude.concat(this.stack.length?[]:this.input.tokenValues()),this.listExpanded()&&(c.context=this.stack[this.stack.length-1][0].data("id")),c.per_page==null&&(c.per_page=typeof (d=this.options).limiter=="function"?d.limiter({level:this.stack.length}):void 0),c},c}()})}.call(this),function(){var a=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};define("compiled/widget/TokenInput",["jquery","compiled/widget/TokenSelector","jquery.instructure_misc_plugins"],function(b,c){var d;return d=function(){function d(a,d){var e,f,g=this;this.$node=a,this.options=d,this.$node.data("token_input",this),this.$fakeInput=b("<div />").css("font-family",this.$node.css("font-family")).insertAfter(this.$node).addClass("token_input").click(function(){return g.$input.focus()}),this.nodeName=this.$node.attr("name"),this.$node.removeAttr("name").hide().change(function(){return g.$tokens.html(""),typeof g.change=="function"?g.change(g.tokenValues()):void 0}),this.added=this.options.added,this.$placeholder=b("<span />"),this.$placeholder.text(this.options.placeholder),this.options.placeholder&&this.$placeholder.appendTo(this.$fakeInput),this.$scroller=b("<div />").appendTo(this.$fakeInput),this.$tokens=b("<ul />").appendTo(this.$scroller),this.$tokens.click(function(a){var c,d;if(d=b(a.target).closest("li")){c=b(a.target).closest("a");if(c.length)return d.remove(),typeof g.change=="function"?g.change(g.tokenValues()):void 0}}),this.$tokens.maxTokenWidth=function(){var a;return parseInt(g.$tokens.css("width").replace("px",""))-((a=g.options.tokenWrapBuffer)!=null?a:150)+"px"},this.$tokens.resizeTokens=function(a){return a.find("div.ellipsis").css("max-width",g.$tokens.maxTokenWidth())},b(window).resize(function(){return g.$tokens.resizeTokens(g.$tokens)}),this.$input=b("<input />").appendTo(this.$scroller).css("width","20px").css("font-size",this.$fakeInput.css("font-size")).autoGrowInput({comfortZone:20}).focus(function(){return g.$placeholder.hide(),g.active=!0,g.$fakeInput.addClass("active")}).blur(function(){return g.active=!1,setTimeout(function(){var a;if(!g.active)return g.$fakeInput.removeClass("active"),g.$placeholder.showIf(g.val()===""&&!g.$tokens.find("li").length),(a=g.selector)!=null?typeof a.blur=="function"?a.blur():void 0:void 0},50)}).keydown(function(a){return g.inputKeyDown(a)}).keyup(function(a){return g.inputKeyUp(a)});if(this.options.selector){e=(f=this.options.selector.type)!=null?f:c,delete this.options.selector.type;if(this.browser=this.options.selector.browser)delete this.options.selector.browser,b('<a class="browser">browse</a>').click(function(){if(g.selector.browse(g.browser.data))return g.$fakeInput.addClass("browse")}).prependTo(this.$fakeInput),this.$fakeInput.addClass("browsable");this.selector=new e(this,this.$node.data("finder_url"),this.options.selector)}this.baseExclude=[],this.resize()}return d.name="TokenInput",d.prototype.resize=function(){return this.$fakeInput.css("width",this.$node.css("width"))},d.prototype.addToken=function(a){var c,d,e,f,g,h,i,j,k;return i=(j=a!=null?a.value:void 0)!=null?j:this.val(),f="token_"+i,e=this.$tokens.find("#"+f),g=e.length===0,g&&(e=b("<li />"),h=(k=a!=null?a.text:void 0)!=null?k:this.val(),e.attr("id",f),d=b("<div />").addClass("ellipsis"),d.attr("title",h),d.text(h),e.append(d),c=b("<a />"),e.append(c),e.append(b("<input />").attr("type","hidden").attr("name",this.nodeName+"[]").val(i)),this.$tokens.resizeTokens(e),this.$tokens.append(e)),(a!=null?!a.noClear:!void 0)&&this.val(""),this.$placeholder.hide(),a&&typeof this.added=="function"&&this.added(a.data,e,g),typeof this.change=="function"&&this.change(this.tokenValues()),this.reposition()},d.prototype.hasToken=function(a){var b;return this.$tokens.find("#token_"+((b=a!=null?a.value:void 0)!=null?b:a)).length>0},d.prototype.removeToken=function(a){var b,c;return b="token_"+((c=a!=null?a.value:void 0)!=null?c:a),this.$tokens.find("#"+b).remove(),typeof this.change=="function"&&this.change(this.tokenValues()),this.reposition()},d.prototype.removeLastToken=function(a){return this.$tokens.find("li").last().remove(),typeof this.change=="function"&&this.change(this.tokenValues()),this.reposition()},d.prototype.reposition=function(){var a;return(a=this.selector)!=null&&a.reposition(),this.$scroller.scrollTop(this.$scroller.prop("scrollHeight"))},d.prototype.inputKeyDown=function(b){var c,d,e;this.keyUpAction=!1;if(this.selector){if((c=this.selector)!=null?c.captureKeyDown(b):void 0)return b.preventDefault(),!1;this.$fakeInput.removeClass("browse")}else if((d=(e=b.which,a.call(this.delimiters,e)>=0))!=null?d:[])return this.keyUpAction=this.addToken,b.preventDefault(),!1;return!0},d.prototype.tokenPairs=function(){var a,c,d,e,f,g;f=this.$tokens.find("li"),g=[];for(d=0,e=f.length;d<e;d++)c=f[d],a=b(c),g.push([a.find("input").val(),a.find("div").attr("title")]);return g},d.prototype.tokenValues=function(){var a,b,c,d,e;d=this.$tokens.find("input"),e=[];for(b=0,c=d.length;b<c;b++)a=d[b],e.push(a.value);return e},d.prototype.inputKeyUp=function(a){return this.reposition(),typeof this.keyUpAction=="function"?this.keyUpAction():void 0},d.prototype.bottomOffset=function(){var a;return a=this.$fakeInput.offset(),a.top+=this.$fakeInput.height()+2,a},d.prototype.focus=function(){return this.$input.focus()},d.prototype.val=function(a){if(a==null)return this.$input.val();if(a!==this.$input.val())return this.$input.val(a).change(),this.reposition()},d.prototype.caret=function(){var a,b,c,d;return this.$input[0].selectionStart!=null?(c=this.$input[0].selectionStart,a=this.$input[0].selectionEnd):(d=this.val(),b=document.selection.createRange().duplicate(),b.moveEnd("character",d.length),c=b.text===""?d.length:d.lastIndexOf(b.text),b=document.selection.createRange().duplicate(),b.moveStart("character",-d.length),a=b.text.length),c===a?c:-1},d.prototype.selectorClosed=function(){return this.$fakeInput.removeClass("browse")},d}(),b.fn.tokenInput=function(a){return this.each(function(){return new d(b(this),b.extend(!0,{},a))})}})}.call(this),function(){var a=function(a,b){return function(){return a.apply(b,arguments)}},b=[].indexOf||function(a){for(var b=0,c=this.length;b<c;b++)if(b in this&&this[b]===a)return b;return-1};define("compiled/conversations/Inbox",["i18n!conversations","underscore","str/htmlEscape","compiled/conversations/introSlideshow","compiled/conversations/ConversationsPane","compiled/conversations/audienceList","compiled/conversations/contextList","compiled/widget/TokenInput","compiled/str/TextHelper","jquery.ajaxJSON","jquery.instructure_date_and_time","jquery.instructure_forms","jqueryui/dialog","jquery.instructure_misc_helpers","jquery.disableWhileLoading","jquery.rails_flash_notifications","media_comments","vendor/jquery.ba-hashchange","vendor/jquery.elastic","jqueryui/position"],function(c,d,e,f,g,h,i,j,k){return function(){function j(b){this.options=b,this.initializeMenus=a(this.initializeMenus,this),this.render=a(this.render,this),this.currentUser=this.options.USER,this.contexts=this.options.CONTEXTS,this.userCache={},this.userCache[this.currentUser.id]=this.currentUser,$(this.render)}return j.prototype.render=function(){this.$inbox=$("#inbox"),this.minHeight=parseInt(this.$inbox.css("min-height").replace("px","")),this.$conversations=$("#conversations"),this.$messages=$("#messages"),this.$messageList=this.$messages.find("ul.messages"),this.initializeHelp(),this.initializeForms(),this.initializeMenus(),this.initializeMessageActions(),this.initializeConversationActions(),this.initializeTemplates(),this.initializeTokenInputs(),this.initializeConversationsPane(),this.initializeAutoResize(),this.initializeHashChange();if(this.options.SHOW_INTRO)return f()},j.prototype.showMessageForm=function(){var a,b,c,d;return a=this.conversations.active(),b=a==null,this.$form.find("#recipient_info").showIf(b),this.$form.find("#group_conversation_info").hide(),$("#action_compose_message").toggleClass("active",b),b?(this.$form.addClass("new"),this.$form.find("#action_add_recipients").hide(),this.$form.attr({action:"/conversations?"+$.param((c=(d=this.conversations)!=null?d.baseData():void 0)!=null?c:{})})):(this.$form.removeClass("new"),this.$form.find("#action_add_recipients").showIf(!a.get("private")),this.$form.attr({action:a.url("add_message")})),this.resetMessageForm(),this.$form.find("#user_note_info").hide().find("input").attr("checked",!1),this.$form.show().find(":input:visible:first").focus()},j.prototype.resetMessageForm=function(a){var b;return a==null&&(a=!0),this.$form.find(".audience").html((b=this.conversations.active())?this.htmlAudience(b.attributes,{linkToContexts:!0,highlightFilters:!0}):e(c.t("headings.new_message","New Message"))),a&&(this.$form.find("input[name!=authenticity_token], textarea").not(":checkbox").val("").change(),this.$form.find(".attachment:visible").remove(),this.$form.find(".media_comment").hide(),this.$form.find("#action_media_comment").show()),this.resize()},j.prototype.filters=function(){var a;return(a=this.conversations.baseData().filter)!=null?a:[]},j.prototype.htmlAudience=function(a,b){var c,e,f,g;return b==null&&(b={}),e=b.filters=b.highlightFilters?this.filters():[],c=function(){var b,c,g,h;g=a.audience,h=[];for(b=0,c=g.length;b<c;b++)f=g[b],h.push({id:f,name:this.userCache[f].name,activeFilter:d.include(e,"user_"+f)});return h}.call(this),g=h(c,b),c.length&&(g+=" <em>"+this.htmlContextList(a.audience_contexts,b)+"</em>"),g},j.prototype.htmlContextList=function(a,b){var c,e,f,g,h,j,k;return b==null&&(b={}),f=(k=b.filters)!=null?k:[],a=function(){var b,c;b=a.courses,c=[];for(h in b)j=b[h],(e=this.contexts.courses[h])&&c.push(e);return c}.call(this).concat(function(){var b,c;b=a.groups,c=[];for(h in b)j=b[h],(g=this.contexts.groups[h])&&c.push(g);return c}.call(this)),a=function(){var b,e,g;g=[];for(b=0,e=a.length;b<e;b++)c=a[b],c=d.clone(c),c.activeFilter=d.include(f,""+c.type+"_"+c.id),g.push(c);return g}(),i(a,b)},j.prototype.htmlNameForUser=function(a,b){var c,d;return b==null&&(b={courses:a.common_courses,groups:a.common_groups}),e(a.name)+(((c=b.courses)!=null?c.length:void 0)||((d=b.groups)!=null?d.length:void 0)?" <em>"+this.htmlContextList(b)+"</em>":"")},j.prototype.canAddNotesFor=function(a){var c,d,e,f;if(!this.options.NOTES_ENABLED)return!1;if(a.can_add_notes)return!0;e=a.common_courses;for(c in e){d=e[c];if(b.call(d,"StudentEnrollment")>=0&&(this.options.CAN_ADD_NOTES_FOR_ACCOUNT||((f=this.contexts.courses[c])!=null?f.can_add_notes:void 0)))return!0}return!1},j.prototype.loadConversation=function(a,b,c){var d,e,f=this;return this.toggleMessageActions(!1),this.$messageList.removeClass("private").hide().html(""),(typeof $conversation!="undefined"&&$conversation!==null?$conversation.hasClass("private"):void 0)&&this.$messageList.addClass("private"),this.showMessageForm(),d=this.currentHashData(),d.message&&this.$form.find("#body").val(d.message),a==null?(d.user_id&&($("#from_conversation_id").val(d.from_conversation_id),$("#recipients").data("token_input").selector.addByUserId(d.user_id,d.from_conversation_id)),c()):(e=a.url(),this.$messageList.show().disableWhileLoading($.ajaxJSON(e,"GET",{},function(a){var b,d,e,g,h,i,j,k,l;f.conversations.updateItems([a]);if(!f.conversations.isActive(a.id))return;j=a.participants;for(e=0,h=j.length;e<h;e++){d=j[e];if((k=f.userCache[d.id])!=null?!k.avatar_url:!void 0)f.userCache[d.id]=d,d.htmlName=f.htmlNameForUser(d);else continue}a["private"]&&(d=function(){var b,c,e,f;e=a.participants,f=[];for(b=0,c=e.length;b<c;b++)d=e[b],d.id!==this.currentUser.id&&f.push(d);return f}.call(f)[0]&&f.canAddNotesFor(d))&&f.$form.find("#user_note_info").show(),f.resize(),f.$messages.show(),l=a.messages;for(g=0,i=l.length;g<i;g++)b=l[g],f.$messageList.append(f.buildMessage(b));return f.$messageList.show(),c()})))},j.prototype.deselectMessages=function(){return this.$messageList.find("li.selected").removeClass("selected")},j.prototype.addMessage=function(a){return this.toggleMessageActions(!1),this.buildMessage(a).prependTo(this.$messageList).slideDown("fast")},j.prototype.buildMessage=function(a){var b,d,f,g,h,i,j,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z=this;if(a.submission)return this.buildSubmission(a);f=$("#message_blank").clone(!0).attr("id","message_"+a.id),f.data("id",a.id),f.addClass(a.generated?"generated":a.author_id===this.currentUser.id?"self":"other"),f.addClass("forwardable"),n=this.userCache[a.author_id],(j=n!=null?n.avatar_url:void 0)&&f.prepend($("<img />").attr("src",j).addClass("avatar")),n&&n.htmlName==null&&(n.htmlName=this.htmlNameForUser(n)),o=(u=n!=null?n.name:void 0)!=null?u:c.t("unknown_user","Unknown user"),f.find(".audience").html((n!=null?n.htmlName:void 0)||e(o)),f.find("span.date").text($.parseFromISO(a.created_at).datetime_formatted),f.find("p").html(k.formatMessage(a.body)),f.find("a.show_quoted_text_link").click(function(a){var b,c;b=$(a.currentTarget),c=b.parents(".quoted_text_holder").children(".quoted_text");if(c.length)return event.stopPropagation(),event.preventDefault(),c.show(),b.hide()}),g=f.find("a.send_private_message"),l=$.replaceTags(g.attr("href"),{user_id:a.author_id,user_name:encodeURIComponent(o),from_conversation_id:typeof (p=this.conversations).active=="function"?p.active().id:void 0}),g.attr("href",l).click(function(a){return a.stopPropagation()});if((v=a.forwarded_messages)!=null?v.length:void 0){h=$('<ul class="messages"></ul>'),w=a.forwarded_messages;for(q=0,s=w.length;q<s;q++)m=w[q],h.append(this.buildMessage(m));f.append(h)}h=f.find("ul.message_attachments").detach(),d=h.find(".media_object_blank").detach(),b=h.find(".attachment_blank").detach();if(a.media_comment!=null||((x=a.attachments)!=null?x.length:void 0)){f.append(h),a.media_comment!=null&&h.append(this.buildMediaObject(d,a.media_comment));if(a.attachments!=null){y=a.attachments;for(r=0,t=y.length;r<t;r++)i=y[r],h.append(this.buildAttachment(b,i))}}return f},j.prototype.buildMediaObject=function(a,b){var c;return c=a.clone(!0).attr("id","media_comment_"+b.media_id),c.find("span.title").html(e(b.display_name)),c.find("span.media_comment_id").html(e(b.media_id)),c.find(".instructure_inline_media_comment").data("media_comment_type",b.media_type),c},j.prototype.buildAttachment=function(a,b){var c,d,f=this;return c=a.clone(!0).attr("id","attachment_"+b.id),c.data("id",b.id),c.find("span.title").html(e(b.display_name)),d=c.find("a"),d.attr("href",b.url),d.click(function(a){return a.stopPropagation()}),c},j.prototype.buildSubmission=function(a){var b,d,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w=this;i=$("#submission_blank").clone(!0).attr("id",a.id),i.data("id",a.id),a=a.submission,j=i.find("ul"),f=j.find("li.header"),l=$.replaceTags(f.find("a").attr("href"),{course_id:a.assignment.course_id,assignment_id:a.assignment_id,id:a.user_id}),f.find("a").attr("href",l),q=this.userCache[a.user_id],q&&q.htmlName==null&&(q.htmlName=this.htmlNameForUser(q)),r=(t=q!=null?q.name:void 0)!=null?t:c.t("unknown_user","Unknown user"),f.find(".title").html(e(a.assignment.name)),f.find("span.date").text(a.submitted_at?$.parseFromISO(a.submitted_at).datetime_formatted:c.t("not_applicable","N/A")),f.find(".audience").html((q!=null?q.htmlName:void 0)||e(r)),a.score&&a.assignment.points_possible?p=""+a.score+" / "+a.assignment.points_possible:p=(u=a.score)!=null?u:c.t("not_scored","no score"),f.find(".score").html(p),d=j.find(".comment").detach(),n=0,o=4;for(m=s=v=a.submission_comments.length-1;s>=0;m=s+=-1){k=a.submission_comments[m];if(n<10)n++,b=this.buildSubmissionComment(d,k),n>o&&b.hide(),j.append(b);else break}return h=j.find(".more").detach(),n>o&&(g=h.clone(!0),g.find(".hidden").text(n-o),g.attr("title",e(c.t("titles.expand_inline","Show more comments"))),g.click(function(a){var b;return b=$(a.currentTarget),i=b.closest(".submission"),i.find(".more:hidden").show(),b.hide(),i.find(".comment:hidden").slideDown("fast"),w.resize(),!1}),j.append(g)),a.submission_comments.length>n&&(h.find("a").attr("href",l).attr("target","_blank"),h.find(".hidden").text(a.submission_comments.length-n),h.attr("title",e(c.t("titles.view_submission","Open submission in new window."))),a.submission_comments.length>o&&h.hide(),j.append(h)),i},j.prototype.buildSubmissionComment=function(a,b){var d,f,g,h,i;return d=a.clone(!0),g=this.userCache[b.author_id],(f=g!=null?g.avatar_url:void 0)&&d.prepend($("<img />").attr("src",f).addClass("avatar")),g&&g.htmlName==null&&(g.htmlName=this.htmlNameForUser(g)),h=(i=g!=null?g.name:void 0)!=null?i:c.t("unknown_user","Unknown user"),d.find(".audience").html((g!=null?g.htmlName:void 0)||e(h)),d.find("span.date").text($.parseFromISO(b.created_at).datetime_formatted),d.find("p").html(e(b.comment).replace(/\n/g,"<br />")),d},j.prototype.closeMenus=function(){return $("#actions .menus > li, #conversation_actions, #conversations .actions").removeClass("selected"),$("#conversations li.menu_active").removeClass("menu_active")},j.prototype.openMenu=function(a){var b,c;this.closeMenus();if(!a.hasClass("disabled"))return b=a.parent("li, span").addClass("selected").find("div"),c=-(b.parent().position().left+b.parent().outerWidth()/2)+6,c<-(b.outerWidth()/2)&&(c=-(b.outerWidth()/2)),b.css("margin-left",c+"px")},j.prototype.resize=function(a){var b=this;return a==null&&(a=0),this.resizeCb&&clearTimeout(this.resizeCb),this.resizeCb=setTimeout(function(){var a;return delete b.resizeCb,a=$(window).height()-$("#header").outerHeight(!0)-($("#wrapper-container").outerHeight(!0)-$("#wrapper-container").height())-($("#main").outerHeight(!0)-$("#main").height())-$("#breadcrumbs").outerHeight(!0)-$("#footer").outerHeight(!0),a<b.minHeight&&(a=b.minHeight),$(document.body).toggleClass("too_small",a<=b.minHeight),b.$inbox.height(a),b.$messageList.height(a-b.$form.outerHeight(!0)),b.conversations.resize(a)},a)},j.prototype.toggleMessageActions=function(a){return a!=null?(this.$messageList.find("> li").removeClass("selected"),this.$messageList.find("> li :checkbox").attr("checked",!1)):a=!!this.$messageList.find("li.selected").length,$("#action_forward").parent().showIf(a&&this.$messageList.find("li.selected.forwardable").length),a?$("#message_actions").slideDown(100):$("#message_actions").slideUp(100),this.$form[a?"addClass":"removeClass"]("disabled")},j.prototype.updateHashData=function(a){var b,c;b=$.extend(this.currentHashData(),a),c=$.encodeToHex(JSON.stringify(b));if(c!==location.hash.substring(1))return location.hash=c,$(document).triggerHandler("document_fragment_change",c)},j.prototype.initializeHelp=function(){var a=this;return $("#help_crumb").click(function(a){return a.preventDefault(),f()})},j.prototype.initializeForms=function(){var a=this;return $("#create_message_form, #forward_message_form").find("textarea").elastic().keypress(function(a){if(a.which===13&&a.shiftKey)return a.preventDefault(),$(a.target).closest("form").submit(),!1}),this.$form=$("#create_message_form"),this.$addForm=$("#add_recipients_form"),this.$forwardForm=$("#forward_message_form"),this.$form.submit(function(b){var c;return c=!!a.$form.find("#body").val()&&(a.$form.find("#recipient_info").filter(":visible").length===0||a.$form.find(".token_input li").length>0),c||b.stopImmediatePropagation(),c}),this.$form.formSubmit({fileUpload:function(){return a.$form.find(".file_input:visible").length>0},preparedFileUpload:!0,context_code:"user_"+$("#identity .user_id").text(),folder_id:this.options.FOLDER_ID,intent:"message",formDataTarget:"url",handle_files:function(a,b){var c;return b.attachment_ids=function(){var b,d,e;e=[];for(b=0,d=a.length;b<d;b++)c=a[b],e.push(c.attachment.id);return e}(),b},disableWhileLoading:!0,success:function(b){var d;return b.length==null&&(b=[b]),a.conversations.updateItems(b),b.length===1?(d=b[0],a.conversations.isActive(d.id)&&a.buildMessage(d.messages[0]).prependTo(a.$messageList).slideDown("fast"),d.visible&&a.updateHashData({id:d.id}),$.flashMessage(c.t("message_sent","Message Sent"))):$.flashMessage(c.t("messages_sent","Messages Sent")),a.resetMessageForm()},error:function(b){var d,e;if(typeof b.isRejected=="function"?b.isRejected():void 0)return;return d=b[0],(d!=null?d.attribute:void 0)==="body"?a.$form.find("#body").errorBox(c.t("message_blank_error","No message was specified")):(e=(d!=null?d.attribute:void 0)==="recipients"?d.message==="blank"?c.t("recipient_blank_error","No recipients were specified"):c.t("recipient_error","The course or group you have selected has no valid recipients"):c.t("unspecified_error","An unexpected error occurred, please try again"),a.$form.find(".token_input").errorBox(e)),$(".error_box").filter(":visible").css("z-index",10)}}),this.$form.click(function(){return a.toggleMessageActions(!1)}),this.$addForm.submit(function(b){var c;return c=!!a.$addForm.find(".token_input li").length,c||b.stopImmediatePropagation(),c}),this.$addForm.formSubmit({disableWhileLoading:!0,success:function(b){return a.buildMessage(b.messages[0]).prependTo(a.$messageList).slideDown("fast"),a.conversations.updateItems([b]),a.resetMessageForm(),a.$addForm.dialog("close")},error:function(b){return a.$addForm.dialog("close")}}),this.$forwardForm.submit(function(b){var c;return c=!!a.$forwardForm.find("#forward_body").val()&&!!a.$forwardForm.find(".token_input li").length,c||b.stopImmediatePropagation(),c}),this.$forwardForm.formSubmit({disableWhileLoading:!0,success:function(b){var c;return c=b[0],a.conversations.updateItems([c]),a.updateHashData({id:c.id}),a.resetMessageForm(),a.$forwardForm.dialog("close")},error:function(b){return a.$forwardForm.dialog("close")}}),this.$messageList.click(function(b){var c;if(!$(b.target).closest("a.instructure_inline_media_comment").length)return c=$(b.target).closest("#messages > ul > li"),c.hasClass("generated")||(c.toggleClass("selected"),c.find("> :checkbox").attr("checked",c.hasClass("selected"))),a.toggleMessageActions()})},j.prototype.initializeMenus=function(){var a=this;return $(".menus > li > a").click(function(b){return b.preventDefault(b),a.openMenu($(b.currentTarget))}).focus(function(b){return a.openMenu($(b.currentTarget))}),$(document).bind("mousedown",function(b){$(b.target).closest("span.others").find("> span").length||$("span.others > span").hide();if(!$(b.target).closest(".menus > li, #conversation_actions, #conversations .actions").length)return a.closeMenus()}),this.$menuViews=$("#menu_views"),this.$menuViewsList=this.$menuViews.parent(),this.$menuViewsList.find("li a").click(function(b){var c;a.closeMenus();if(c=$(b.target).closest("li").data("scope"))return b.preventDefault(),a.updateHashData({scope:c})}),$("#conversations ul, #create_message_form").delegate(".audience","click",function(a){var b;if((b=$(a.target).closest("span.others").find("> span")).length)return $(a.target).closest("span.others > span").length||($("span.others > span").not(b).hide(),b.toggle(),b.css("left",b.parent().position().left),b.css("top",b.parent().height()+b.parent().position().top)),!1})},j.prototype.setScope=function(a){var b,c;return c=this.$menuViewsList.find("li"),c.removeClass("checked"),b=c.filter("[data-scope="+a+"]"),b.length||(b=c.filter("[data-scope=inbox]")),b.addClass("checked"),this.$menuViews.text(b.text())},j.prototype.initializeMessageActions=function(){var a=this;return $("#message_actions").find("a").click(function(a){return a.preventDefault()}),$("#cancel_bulk_message_action").click(function(){return a.toggleMessageActions(!1)}),$("#action_delete").click(function(b){var d,e,f;e=a.conversations.active();if(e==null)return;d=a.$messageList.find(".selected"),f=d.length>1?c.t("confirm.delete_messages","Are you sure you want to delete your copy of these messages? This action cannot be undone."):c.t("confirm.delete_message","Are you sure you want to delete your copy of this message? This action cannot be undone.");if(confirm(f))return d.fadeOut("fast"),a.conversations.action($(b.currentTarget),{conversationId:e.id,data:{remove:function(){var a,b,c;c=[];for(a=0,b=d.length;a<b;a++)f=d[a],c.push($(f).data("id"));return c}()},success:function(){return a.toggleMessageActions(!1)},error:function(){return d.show()}})}),$("#action_forward").click(function(b){var d;if(a.conversations.active()==null)return;return a.$forwardForm.find("input[name!=authenticity_token], textarea").val("").change(),d=a.$forwardForm.find("ul.messages").first(),d.html(""),d.html(a.$messageList.find("> li.selected.forwardable").clone(!0).removeAttr("id").removeClass("self")),d.find("> li").removeClass("selected odd").find("> :checkbox").attr("checked",!0).attr("name","forwarded_message_ids[]").val(function(){return $(this).closest("li").data("id")}),d.find("> li").last().addClass("last"),a.$forwardForm.css("max-height",$(window).height()-300+"px").dialog("close").dialog({position:"center",height:"auto",width:510,title:c.t("title.forward_messages","Forward Messages"),buttons:[{text:c.t("buttons.send_message","Send"),click:function(){return $(this).submit()}},{text:c.t("#buttons.cancel","Cancel"),click:function(){return $(this).dialog("close")}}],open:function(){return a.$forwardForm.attr({action:"/conversations?"+$.param(a.conversations.baseData())})},close:function(){return $("#forward_recipients").data("token_input").$input.blur()}})})},j.prototype.initializeConversationActions=function(){var a=this;return $("#action_compose_message").click(function(b){return b.preventDefault(),a.updateHashData({id:null})}),$("#action_add_recipients").click(function(b){b.preventDefault();if(a.conversations.active()==null)return;return a.$addForm.attr("action",a.conversations.actionUrlFor($(b.currentTarget))).dialog("close").dialog({width:420,title:c.t("title.add_recipients","Add Recipients"),buttons:[{text:c.t("buttons.add_people","Add People"),click:function(){return a.$addForm.submit()}},{text:c.t("#buttons.cancel","Cancel"),click:function(){return a.$addForm.dialog("close")}}],open:function(){var b;return b=$("#add_recipients").data("token_input"),b.baseExclude=a.conversations.active().get("audience"),a.$addForm.find("input[name!=authenticity_token]").val("").change()},close:function(){return $("#add_recipients").data("token_input").$input.blur()}})})},j.prototype.initializeTemplates=function(){var a,b=this;return a=0,$("#action_add_attachment").click(function(c){var d;return c.preventDefault(),d=$("#attachment_blank").clone(!0),d.attr("id",null),d.find("input[type='file']").attr("name","attachments["+a++ +"]"),$("#attachment_list").append(d),d.slideDown("fast",function(){return b.resize()}),!1}),$("#attachment_blank a.remove_link").click(function(a){var c;return a.preventDefault(),c=$(a.currentTarget).closest(".attachment"),c.slideUp("fast",function(){return b.resize(),c.remove()}),!1}),$("#action_media_comment").click(function(a){return a.preventDefault(),$("#create_message_form .media_comment").mediaComment("create","any",function(a,b){return $("#media_comment_id").val(a),$("#media_comment_type").val(b),$("#create_message_form .media_comment").show(),$("#action_media_comment").hide()})}),$("#create_message_form .media_comment a.remove_link").click(function(a){return a.preventDefault(),$("#media_comment_id").val(""),$("#media_comment_type").val(""),$("#create_message_form .media_comment").hide(),$("#action_media_comment").show()})},j.prototype.buildContextInfo=function(a){var b,c,d;c=a.id.match(/^(course|section)_(\d+)$/),c&&(d=this.contexts[""+c[1]+"s"][c[2]]),b=a.context_name||"",b=b.length<40?b:b.substr(0,40)+"...";if(d!=null?d.term:void 0)b=b?""+b+" - "+d.term:d.term;return b?$("<span />",{"class":"context_info"}).text("("+b+")"):""},j.prototype.initializeTokenInputs=function(){var a,b,d,e,f,g,h,i=this;return a=function(a){return a==null&&(a={}),function(b,d,e,f){var g,h,j,k,l,m;f==null&&(f={}),e.id=""+e.id,e.avatar_url&&(j=$('<img class="avatar" />'),j.attr("src",e.avatar_url),d.append(j)),g=$("<b />"),g.text(e.name),k=$("<span />",{"class":"name"}),f.parent||(h=i.buildContextInfo(e)),k.append(g,h),l=$("<span />",{"class":"details"}),e.common_courses!=null?l.html(i.htmlContextList({courses:e.common_courses,groups:e.common_groups},{hardCutoff:2})):e.type&&e.user_count!=null?l.text(c.t("people_count","person",{count:e.user_count})):e.item_count!=null?e.id.match(/_groups$/)?l.text(c.t("groups_count","group",{count:e.item_count})):e.id.match(/_sections$/)&&l.text(c.t("sections_count","section",{count:e.item_count})):e.subText&&l.text(e.subText),d.append(k,l),d.attr("title",e.name),m=e.name,f.parent&&(e.selectAll&&e.noExpand?m=f.parent.data("text"):e.id.match(/_\d+_/)&&(m=c.beforeLabel(f.parent.data("text"))+" "+m)),d.data("text",m),d.data("id",e.type==="context"||!a.prefixUserIds?e.id:"user_"+e.id),e.rootId=f.ancestors[0],d.data("user_data",e),d.addClass(e.type?e.type:"user"),f.level>0&&b.options.showToggles&&(d.prepend('<a class="toggle"><i></i></a>'),e.item_count||d.addClass("toggleable"));if(e.type==="context"&&!e.noExpand)return d.prepend('<a class="expand"><i></i></a>'),d.addClass("expandable")}},f=c.t("recipient_field_placeholder","Enter a name, course, or group"),e=c.t("no_results","No results found"),b=c.t("enrollments_everyone","Everyone"),g=c.t("select_all","Select All"),$(".recipients").tokenInput({placeholder:f,added:function(a,b,d){var e,f,g;a.id=""+a.id,d&&a.rootId&&b.append("<input type='hidden' name='tags[]' value='"+a.rootId+"'>"),d&&a.type&&(b.addClass(a.type),a.user_count!=null&&(b.addClass("details"),e=$("<span />"),e.text(c.t("people_count","person",{count:a.user_count})),b.append(e)));if(!a.id.match(/^(course|group)_/))return a=$.extend({},a),delete a.avatar_url,f=(g=i.userCache[a.id])!=null?g:{},i.userCache[a.id]=$.extend(f,a)},selector:{messages:{noResults:e},populator:a(),limiter:function(a){return a.level>0?-1:5},showToggles:!0,preparer:function(a,c,d){var e;e=a.context;if(!a.search&&e&&c.length>1){if(e.match(/^(course|section)_\d+$/))return c.unshift({id:""+e+"_all",name:b,user_count:d.data("user_data").user_count,type:"context",avatar_url:d.data("user_data").avatar_url,selectAll:!0});if(e.match(/^((course|section)_\d+_.*|group_\d+)$/)&&!e.match(/^course_\d+_(groups|sections)$/))return c.unshift({id:e,name:g,user_count:d.data("user_data").user_count,type:"context",avatar_url:d.data("user_data").avatar_url,selectAll:!0,noExpand:!0})}},baseData:{synthetic_contexts:1},browser:{data:{per_page:-1,type:"context"}}}}),h=$("#recipients").data("token_input"),h.$fakeInput.css("width","100%"),h.change=function(a){var b,c;return a.length>1||((c=a[0])!=null?c.match(/^(course|group)_/):void 0)?(i.$form.find("#group_conversation_info").is(":visible")||i.$form.find("#group_conversation").attr("checked",!1),i.$form.find("#group_conversation_info").show(),i.$form.find("#user_note_info").hide()):(i.$form.find("#group_conversation").attr("checked",!1),i.$form.find("#group_conversation_info").hide(),i.$form.find("#user_note_info").showIf((b=i.userCache[a[0]])&&i.canAddNotesFor(b))),i.resize()},this.filterNameMap={},$("#context_tags").tokenInput({placeholder:f,added:function(a,b,c){return b.prevAll().remove()},tokenWrapBuffer:80,selector:{messages:{noResults:e},populator:a({prefixUserIds:!0}),limiter:function(a){return 5},preparer:function(a,d,e){var f,g;f=a.context;if(!a.search&&f&&d.length>0&&f.match(/^(course|group)_\d+$/))return d.length>1&&f.match(/^course_/)&&d.unshift({id:""+f+"_all",name:b,user_count:e.data("user_data").user_count,type:"context",avatar_url:e.data("user_data").avatar_url}),g=f.match(/^course/)?c.t("filter_by_course","Fiter by this course"):c.t("filter_by_group","Fiter by this group"),d.unshift({id:f,name:e.data("text"),type:"context",avatar_url:e.data("user_data").avatar_url,subText:g,noExpand:!0})},baseData:{synthetic_contexts:1,types:["course","user","group"],include_inactive:!0},browser:{data:{per_page:-1,types:["context"]}}}}),d=$("#context_tags").data("token_input"),d.change=function(a){var b,c;return b=function(){var a,b,e,f;e=d.tokenPairs(),f=[];for(a=0,b=e.length;a<b;a++)c=e[a],this.filterNameMap[c[0]]=c[1],f.push(c[0]);return f}.call(i),i.updateHashData({filter:b})}},j.prototype.initializeConversationsPane=function(){return this.conversations=new g(this,this.$conversations)},j.prototype.initializeAutoResize=function(){var a=this;return $(window).resize(function(){return a.resize(50)}),this.resize()},j.prototype.currentHashData=function(){var a;try{a=$.parseJSON($.decodeFromHex(location.hash.substring(1)))||{}}catch(b){a={}}return a},j.prototype.initializeHashChange=function(){var a=this;return $(window).bind("hashchange",function(){var b,c,d;c=location.hash,b=a.currentHashData();if(b.filter){b.filter=function(){var a,c,e,f;e=b.filter,f=[];for(a=0,c=e.length;a<c;a++)d=e[a],this.filterNameMap[d]&&f.push(d);return f}.call(a);if(!b.filter.length)return a.updateHashData({filter:null})}return a.setScope(b.scope),a.conversations.updateView(b)}).triggerHandler("hashchange")},j}()})}.call(this),function(){require(["compiled/conversations/Inbox"],function(a){return new a(ENV.CONVERSATIONS)})}.call(this),define("compiled/bundles/conversations",function(){})