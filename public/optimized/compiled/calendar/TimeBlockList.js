(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define(["jquery","i18n!calendar","compiled/calendar/TimeBlockListManager","compiled/calendar/TimeBlockRow","jquery.instructure_date_and_time","jquery.instructure_forms","vendor/date"],function(b,c,d,e){var f;return f=function(){function f(c,e,f){this.handleSplitClick=a(this.handleSplitClick,this),this.addRow=a(this.addRow,this);var g=this;this.element=b(c),this.splitterDiv=b(e),this.blocksManager=new d(f),this.splitterDiv.find(".split-link").click(this.handleSplitClick),this.element.delegate("input","change",function(a){if(b(a.currentTarget).closest("tr").is(":last-child"))return g.addRow()}),this.render()}return f.name="TimeBlockList",f.prototype.render=function(){var a,b,c,d;this.rows=[],this.element.empty(),d=this.blocksManager.blocks;for(b=0,c=d.length;b<c;b++)a=d[b],this.addRow(a);return this.addRow()},f.prototype.rowRemoved=function(a){var b,c;this.rows=function(){var d,e,f,g;f=this.rows,g=[];for(d=0,e=f.length;d<e;d++){c=f[d];if(c===a)continue;c.locked||(b=!0),g.push(c)}return g}.call(this);if(!b)return this.addRow()},f.prototype.addRow=function(a){var b;return b=new e(this,a),this.element.append(b.$row),this.rows.push(b),b},f.prototype.handleSplitClick=function(a){var b;return a.preventDefault(),b=this.splitterDiv.find("[name=duration]").val(),this.split(b)},f.prototype.split=function(a){if(a&&this.validate())return this.blocksManager.split(a),this.render()},f.prototype.validate=function(){var a,b,d,e,f,g;b=!0,this.blocksManager.reset(),f=this.rows;for(d=0,e=f.length;d<e;d++)a=f[d],a.validate()?a.blank()||(g=this.blocksManager).add.apply(g,a.getData()):b=!1;return b||alert(c.t("time_block_errors","There are errors in your time block selections.")),b},f.prototype.blocks=function(){var a,b,c,d,e;d=this.blocksManager.blocks,e=[];for(b=0,c=d.length;b<c;b++)a=d[b],a.locked||e.push([a.start,a.end]);return e},f}()})}).call(this)