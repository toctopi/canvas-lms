(function(){var a=function(a,b){return function(){return a.apply(b,arguments)}};define(["jquery","jquery.ui.menu.inputmenu","vendor/jquery.ui.popup-1.9","vendor/jquery.ui.button-1.9"],function(b,c,d,e){var f;return f=function(){function c(d,e){this.keepButtonActive=a(this.keepButtonActive,this),this.onClose=a(this.onClose,this),this.close=a(this.close,this),this.onOpen=a(this.onOpen,this);var f,g,h,i=this;this.$trigger=b(d).data("kyleMenu",this),this.opts=b.extend(!0,{},c.defaults,e),this.opts.noButton||(this.$trigger.button(this.opts.buttonOpts),this.$trigger.bind("mouseleave.button",this.keepButtonActive)),this.$menu=this.$trigger.next().menu(this.opts.menuOpts).popup(this.opts.popupOpts).addClass("ui-kyle-menu use-css-transitions-for-show-hide"),this.opts.appendMenuTo&&(f=this.$menu.data("popup"),h=f.open,g=this,f.open=function(){return g.$menu.appendTo(g.opts.appendMenuTo),h.apply(this,arguments)},this.$placeholder=b('<span style="display:none;">').insertAfter(this.$menu),this.$menu.bind("click",function(){var a;return(a=i.$placeholder).trigger.apply(a,arguments)})),this.$menu.bind({menuselect:this.close,popupopen:this.onOpen,popupclose:this.onClose})}return c.name="KyleMenu",c.prototype.onOpen=function(a){return this.adjustCarat(a),this.$menu.addClass("ui-state-open")},c.prototype.open=function(){return this.$menu.popup("open")},c.prototype.close=function(){return this.$menu.popup("close").removeClass("ui-state-open")},c.prototype.onClose=function(){return this.opts.appendMenuTo&&this.$menu.insertBefore(this.$placeholder),this.$trigger.removeClass("ui-state-active"),this.$menu.removeClass("ui-state-open")},c.prototype.keepButtonActive=function(){if(this.$menu.is(".ui-state-open"))return this.$trigger.addClass("ui-state-active")},c.prototype.adjustCarat=function(a){var c,d,e,f,g;return(g=this.$carat)!=null&&g.remove(),this.$trigger.addClass("ui-state-active"),f=this.$trigger.outerWidth(),e=this.$trigger.offset().left-this.$menu.offset().left,c=a.pageX-this.$trigger.offset().left,d=Math.min(Math.max(6,c),f-6)+e,this.$carat=b('<span class="ui-menu-carat"><span /></span>').css("left",d).prependTo(this.$menu),this.$menu.css("-webkit-transform-origin-x",d+"px")},c.defaults={popupOpts:{position:{my:"center top",at:"center bottom",offset:"0 10px",within:"#main",collision:"fit"}},buttonOpts:{icons:{primary:"ui-icon-home",secondary:"ui-icon-droparrow"}}},c}(),b.fn.kyleMenu=function(a){return this.each(function(){if(!b(this).data().kyleMenu)return new f(this,a)})},b(document).delegate(".al-trigger","click",function(a){var c,d,e;c=b(this),d={buttonOpts:{icons:{primary:null,secondary:null}}};if(!c.data("kyleMenu"))return a.preventDefault(),e=b.extend(d,c.data("kyleMenuOptions")),(new f(c,e)).open()}),f})}).call(this)