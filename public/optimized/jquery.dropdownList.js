define(["jquery"],function(a){a.fn.dropdownList=function(b){if(this.length){var c=a("#instructure_dropdown_list");if(b=="hide"||b=="remove"||c.data("current_dropdown_initiator")==this[0]){c.remove().data("current_dropdown_initiator",null);return}var b=a.extend({},a.fn.dropdownList.defaults,b),d=c.children("div.list");d.length||(c=a("<div id='instructure_dropdown_list'><div class='list ui-widget-content'></div></div>").appendTo("body"),a(document).mousedown(function(b){c.data("current_dropdown_initiator")&&!a(b.target).closest("#instructure_dropdown_list").length&&c.hide().data("current_dropdown_initiator",null)}).mouseup(function(b){c.data("current_dropdown_initiator")&&!a(b.target).closest("#instructure_dropdown_list").length&&(c.hide(),setTimeout(function(){c.data("current_dropdown_initiator",null)},100))}).add(this).add(c).keydown(function(a){if(c.data("current_dropdown_initiator")){var b=c.find(".ui-state-hover,.ui-state-active");if(a.keyCode==38)return b.length&&b.prev().length?b.removeClass("ui-state-hover ui-state-active").addClass("minimal").prev().addClass("ui-state-hover").removeClass("minimal").find("span").focus():$item.focus(),!1;if(a.keyCode==40)return b.length?b.next().length&&b.removeClass("ui-state-hover ui-state-active").addClass("minimal").next().addClass("ui-state-hover").removeClass("minimal").find("span").focus():c.find(".option:first").addClass("ui-state-hover").removeClass("minimal").find("span").focus(),!1;if(a.keyCode==13&&b.length)return b.click(),!1;c.hide().data("current_dropdown_initiator",null)}}),c.find(".option").removeClass("ui-state-hover ui-state-active").addClass("minimal"),c.click(function(a){c.hide().data("current_dropdown_initiator",null)}),d=c.children("div.list")),c.data("current_dropdown_initiator",this[0]),b.width&&c.width(b.width),b.height&&c.find(".list").css("maxHeight",b.height),d.empty(),a.each(b.options,function(b,c){var e=a("<div class='option minimal' style='cursor: pointer; padding: 2px 5px; overflow: hidden; white-space: nowrap;'>  <span tabindex='-1'>"+b+"</span>"+"</div>").appendTo(d);if(a.isFunction(c)){function f(){e.parent().find("div.option").removeClass("ui-state-hover ui-state-active").addClass("minimal")}e.addClass("ui-state-default").bind({mouseenter:function(){f(),e.addClass("ui-state-hover").removeClass("minimal")},mouseleave:f,mousedown:function(a){a.preventDefault(),f(),e.addClass("ui-state-active").removeClass("minimal")},mouseup:f,click:c})}else e.addClass("ui-state-disabled").bind({mousedown:function(a){a.preventDefault()}})});var e=this.offset(),f=this.outerHeight(),g=this.outerWidth();c.css({whiteSpace:"nowrap",position:"absolute",top:e.top+f,left:e.left+5,right:""}).hide().show(),c.offset().left+c.width()>a(window).width()&&c.css({left:"",right:0})}return this},a.fn.dropdownList.defaults={height:250,width:"auto"}})